(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function sS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fm={exports:{}},Zl={},dm={exports:{}},V={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qo=Symbol.for("react.element"),lS=Symbol.for("react.portal"),aS=Symbol.for("react.fragment"),uS=Symbol.for("react.strict_mode"),cS=Symbol.for("react.profiler"),fS=Symbol.for("react.provider"),dS=Symbol.for("react.context"),hS=Symbol.for("react.forward_ref"),pS=Symbol.for("react.suspense"),mS=Symbol.for("react.memo"),gS=Symbol.for("react.lazy"),Nd=Symbol.iterator;function yS(n){return n===null||typeof n!="object"?null:(n=Nd&&n[Nd]||n["@@iterator"],typeof n=="function"?n:null)}var hm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pm=Object.assign,mm={};function mi(n,e,t){this.props=n,this.context=e,this.refs=mm,this.updater=t||hm}mi.prototype.isReactComponent={};mi.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};mi.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function gm(){}gm.prototype=mi.prototype;function Gc(n,e,t){this.props=n,this.context=e,this.refs=mm,this.updater=t||hm}var Xc=Gc.prototype=new gm;Xc.constructor=Gc;pm(Xc,mi.prototype);Xc.isPureReactComponent=!0;var Md=Array.isArray,ym=Object.prototype.hasOwnProperty,Zc={current:null},Sm={key:!0,ref:!0,__self:!0,__source:!0};function wm(n,e,t){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)ym.call(e,r)&&!Sm.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:qo,type:n,key:o,ref:s,props:i,_owner:Zc.current}}function SS(n,e){return{$$typeof:qo,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ef(n){return typeof n=="object"&&n!==null&&n.$$typeof===qo}function wS(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Ed=/\/+/g;function ka(n,e){return typeof n=="object"&&n!==null&&n.key!=null?wS(""+n.key):e.toString(36)}function $s(n,e,t,r,i){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case qo:case lS:s=!0}}if(s)return s=n,i=i(s),n=r===""?"."+ka(s,0):r,Md(i)?(t="",n!=null&&(t=n.replace(Ed,"$&/")+"/"),$s(i,e,t,"",function(u){return u})):i!=null&&(ef(i)&&(i=SS(i,t+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Ed,"$&/")+"/")+n)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Md(n))for(var l=0;l<n.length;l++){o=n[l];var a=r+ka(o,l);s+=$s(o,e,t,a,i)}else if(a=yS(n),typeof a=="function")for(n=a.call(n),l=0;!(o=n.next()).done;)o=o.value,a=r+ka(o,l++),s+=$s(o,e,t,a,i);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function fs(n,e,t){if(n==null)return n;var r=[],i=0;return $s(n,r,"","",function(o){return e.call(t,o,i++)}),r}function kS(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Pe={current:null},Vs={transition:null},vS={ReactCurrentDispatcher:Pe,ReactCurrentBatchConfig:Vs,ReactCurrentOwner:Zc};V.Children={map:fs,forEach:function(n,e,t){fs(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return fs(n,function(){e++}),e},toArray:function(n){return fs(n,function(e){return e})||[]},only:function(n){if(!ef(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};V.Component=mi;V.Fragment=aS;V.Profiler=cS;V.PureComponent=Gc;V.StrictMode=uS;V.Suspense=pS;V.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vS;V.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=pm({},n.props),i=n.key,o=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Zc.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(a in e)ym.call(e,a)&&!Sm.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:qo,type:n.type,key:i,ref:o,props:r,_owner:s}};V.createContext=function(n){return n={$$typeof:dS,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:fS,_context:n},n.Consumer=n};V.createElement=wm;V.createFactory=function(n){var e=wm.bind(null,n);return e.type=n,e};V.createRef=function(){return{current:null}};V.forwardRef=function(n){return{$$typeof:hS,render:n}};V.isValidElement=ef;V.lazy=function(n){return{$$typeof:gS,_payload:{_status:-1,_result:n},_init:kS}};V.memo=function(n,e){return{$$typeof:mS,type:n,compare:e===void 0?null:e}};V.startTransition=function(n){var e=Vs.transition;Vs.transition={};try{n()}finally{Vs.transition=e}};V.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};V.useCallback=function(n,e){return Pe.current.useCallback(n,e)};V.useContext=function(n){return Pe.current.useContext(n)};V.useDebugValue=function(){};V.useDeferredValue=function(n){return Pe.current.useDeferredValue(n)};V.useEffect=function(n,e){return Pe.current.useEffect(n,e)};V.useId=function(){return Pe.current.useId()};V.useImperativeHandle=function(n,e,t){return Pe.current.useImperativeHandle(n,e,t)};V.useInsertionEffect=function(n,e){return Pe.current.useInsertionEffect(n,e)};V.useLayoutEffect=function(n,e){return Pe.current.useLayoutEffect(n,e)};V.useMemo=function(n,e){return Pe.current.useMemo(n,e)};V.useReducer=function(n,e,t){return Pe.current.useReducer(n,e,t)};V.useRef=function(n){return Pe.current.useRef(n)};V.useState=function(n){return Pe.current.useState(n)};V.useSyncExternalStore=function(n,e,t){return Pe.current.useSyncExternalStore(n,e,t)};V.useTransition=function(){return Pe.current.useTransition()};V.version="18.2.0";dm.exports=V;var k=dm.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xS=k,CS=Symbol.for("react.element"),NS=Symbol.for("react.fragment"),MS=Object.prototype.hasOwnProperty,ES=xS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OS={key:!0,ref:!0,__self:!0,__source:!0};function km(n,e,t){var r,i={},o=null,s=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)MS.call(e,r)&&!OS.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:CS,type:n,key:o,ref:s,props:i,_owner:ES.current}}Zl.Fragment=NS;Zl.jsx=km;Zl.jsxs=km;fm.exports=Zl;var D=fm.exports;function pe(n){this.content=n}pe.prototype={constructor:pe,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new pe(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new pe(t)},addToStart:function(n,e){return new pe([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new pe(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new pe(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=pe.from(n),n.size?new pe(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=pe.from(n),n.size?new pe(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=pe.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};pe.from=function(n){if(n instanceof pe)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new pe(e)};function vm(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=vm(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function xm(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),l=e.child(--o),a=s.nodeSize;if(s==l){t-=a,r-=a;continue}if(!s.sameMarkup(l))return{a:t,b:r};if(s.isText&&s.text!=l.text){let u=0,c=Math.min(s.text.length,l.text.length);for(;u<c&&s.text[s.text.length-u-1]==l.text[l.text.length-u-1];)u++,t--,r--;return{a:t,b:r}}if(s.content.size||l.content.size){let u=xm(s.content,l.content,t-1,r-1);if(u)return u}t-=a,r-=a}}class C{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,l=0;l<t;s++){let a=this.content[s],u=l+a.nodeSize;if(u>e&&r(a,i+l,o||null,s)!==!1&&a.content.size){let c=l+1;a.nodesBetween(Math.max(0,e-c),Math.min(a.content.size,t-c),r,i+c)}l=u}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(l,a)=>{let u=l.isText?l.text.slice(Math.max(e,a)-a,t-a):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&u||l.isTextblock)&&r&&(s?s=!1:o+=r),o+=u},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new C(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let l=this.content[o],a=s+l.nodeSize;a>e&&((s<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-s),Math.min(l.text.length,t-s)):l=l.cut(Math.max(0,e-s-1),Math.min(l.content.size,t-s-1))),r.push(l),i+=l.nodeSize),s=a}return new C(r,i)}cutByIndex(e,t){return e==t?C.empty:e==0&&t==this.content.length?this:new C(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new C(i,o)}addToStart(e){return new C([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new C(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return vm(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return xm(this,e,t,r)}findIndex(e,t=-1){if(e==0)return ds(0,e);if(e==this.size)return ds(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?ds(r+1,s):ds(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return C.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new C(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return C.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new C(t||e,r)}static from(e){if(!e)return C.empty;if(e instanceof C)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new C([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}C.empty=new C([],0);const va={index:0,offset:0};function ds(n,e){return va.index=n,va.offset=e,va}function pl(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!pl(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!pl(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}class W{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&pl(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return W.none;if(e instanceof W)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}}W.none=[];class Tn extends Error{}class v{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Nm(this.content,e+this.openStart,t);return r&&new v(r,this.openStart,this.openEnd)}removeBetween(e,t){return new v(Cm(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return v.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new v(C.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new v(e,r,i)}}v.empty=new v(C.empty,0,0);function Cm(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:l}=n.findIndex(t);if(i==e||o.isText){if(l!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(Cm(o.content,e-i-1,t-i-1)))}function Nm(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let l=Nm(s.content,e-o-1,t);return l&&n.replaceChild(i,s.copy(l))}function TS(n,e,t){if(t.openStart>n.depth)throw new Tn("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Tn("Inconsistent open depths");return Mm(n,e,t,0)}function Mm(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=Mm(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,l=s.content;return er(s,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:s,end:l}=DS(t,n);return er(o,Om(n,s,l,e,r))}else return er(o,ml(n,e,r))}function Em(n,e){if(!e.type.compatibleContent(n.type))throw new Tn("Cannot join "+e.type.name+" onto "+n.type.name)}function Eu(n,e,t){let r=n.node(t);return Em(r,e.node(t)),r}function Zn(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function to(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&(Zn(n.nodeAfter,r),o++));for(let l=o;l<s;l++)Zn(i.child(l),r);e&&e.depth==t&&e.textOffset&&Zn(e.nodeBefore,r)}function er(n,e){return n.type.checkContent(e),n.copy(e)}function Om(n,e,t,r,i){let o=n.depth>i&&Eu(n,e,i+1),s=r.depth>i&&Eu(t,r,i+1),l=[];return to(null,n,i,l),o&&s&&e.index(i)==t.index(i)?(Em(o,s),Zn(er(o,Om(n,e,t,r,i+1)),l)):(o&&Zn(er(o,ml(n,e,i+1)),l),to(e,t,i,l),s&&Zn(er(s,ml(t,r,i+1)),l)),to(r,null,i,l),new C(l)}function ml(n,e,t){let r=[];if(to(null,n,t,r),n.depth>t){let i=Eu(n,e,t+1);Zn(er(i,ml(n,e,t+1)),r)}return to(e,null,t,r),new C(r)}function DS(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(C.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class go{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return W.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let l=r;r=i,i=l}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new bS(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:l,offset:a}=s.content.findIndex(o),u=o-a;if(r.push(s,l,i+a),!u||(s=s.child(l),s.isText))break;o=u-1,i+=a+1}return new go(t,r,o)}static resolveCached(e,t){let r=Od.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else Od.set(e,r=new RS);let i=r.elts[r.i]=go.resolve(e,t);return r.i=(r.i+1)%AS,i}}class RS{constructor(){this.elts=[],this.i=0}}const AS=12,Od=new WeakMap;class bS{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const IS=Object.create(null);class Rt{constructor(e,t,r,i=W.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||C.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&pl(this.attrs,t||e.defaultAttrs||IS)&&W.sameSet(this.marks,r||W.none)}copy(e=null){return e==this.content?this:new Rt(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Rt(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return v.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),l=i.start(s),u=i.node(s).content.cut(i.pos-l,o.pos-l);return new v(u,i.depth-s,o.depth-s)}replace(e,t,r){return TS(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return go.resolveCached(this,e)}resolveNoCache(e){return go.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Tm(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=C.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),l=s&&s.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=i;a<o;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=W.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!W.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=C.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}}Rt.prototype.text=void 0;class gl extends Rt{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Tm(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new gl(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new gl(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Tm(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class or{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new zS(e,t);if(r.next==null)return or.empty;let i=Dm(r);r.next&&r.err("Unexpected trailing text");let o=JS(BS(i));return _S(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,l){let a=s.matchFragment(e,r);if(a&&(!t||a.validEnd))return C.from(l.map(u=>u.createAndFill()));for(let u=0;u<s.next.length;u++){let{type:c,next:f}=s.next[u];if(!(c.isText||c.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let d=o(f,l.concat(c));if(d)return d}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let l=i;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:l,next:a}=o.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}or.empty=new or(!0);class zS{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Dm(n){let e=[];do e.push(PS(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function PS(n){let e=[];do e.push(FS(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function FS(n){let e=VS(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=LS(n,e);else break;return e}function Td(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function LS(n,e){let t=Td(n),r=t;return n.eat(",")&&(n.next!="}"?r=Td(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function $S(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.groups.indexOf(e)>-1&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function VS(n){if(n.eat("(")){let e=Dm(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=$S(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function BS(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,l,a){let u={term:a,to:l};return e[s].push(u),u}function i(s,l){s.forEach(a=>a.to=l)}function o(s,l){if(s.type=="choice")return s.exprs.reduce((a,u)=>a.concat(o(u,l)),[]);if(s.type=="seq")for(let a=0;;a++){let u=o(s.exprs[a],l);if(a==s.exprs.length-1)return u;i(u,l=t())}else if(s.type=="star"){let a=t();return r(l,a),i(o(s.expr,a),a),[r(a)]}else if(s.type=="plus"){let a=t();return i(o(s.expr,l),a),i(o(s.expr,a),a),[r(a)]}else{if(s.type=="opt")return[r(l)].concat(o(s.expr,l));if(s.type=="range"){let a=l;for(let u=0;u<s.min;u++){let c=t();i(o(s.expr,a),c),a=c}if(s.max==-1)i(o(s.expr,a),a);else for(let u=s.min;u<s.max;u++){let c=t();r(a,c),i(o(s.expr,a),c),a=c}return[r(a)]}else{if(s.type=="name")return[r(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Rm(n,e){return e-n}function Dd(n,e){let t=[];return r(e),t.sort(Rm);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:l,to:a}=o[s];!l&&t.indexOf(a)==-1&&r(a)}}}function JS(n){let e=Object.create(null);return t(Dd(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:l,to:a})=>{if(!l)return;let u;for(let c=0;c<i.length;c++)i[c][0]==l&&(u=i[c][1]);Dd(n,a).forEach(c=>{u||i.push([l,u=[]]),u.indexOf(c)==-1&&u.push(c)})})});let o=e[r.join(",")]=new or(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let l=i[s][1].sort(Rm);o.next.push({type:i[s][0],next:e[l.join(",")]||t(l)})}return o}}function _S(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let l=0;l<i.next.length;l++){let{type:a,next:u}=i.next[l];s.push(a.name),o&&!(a.isText||a.hasRequiredAttrs())&&(o=!1),r.indexOf(u)==-1&&r.push(u)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Am(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function bm(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Im(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function zm(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new US(n,r,e[r]);return t}let Rd=class Pm{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=zm(e,r.attrs),this.defaultAttrs=Am(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==or.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:bm(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Rt(this,this.computeAttrs(e),C.from(t),W.setFrom(r))}createChecked(e=null,t,r){return t=C.from(t),this.checkContent(t),new Rt(this,this.computeAttrs(e),t,W.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=C.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(C.empty,!0);return o?new Rt(this,e,t.append(o),W.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Im(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:W.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new Pm(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function WS(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class US{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?WS(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Qo{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=zm(e,i.attrs),this.excluded=null;let o=Am(this.attrs);this.instance=o?new W(this,o):null}create(e=null){return!e&&this.instance?this.instance:new W(this,bm(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new Qo(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Im(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Fm{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=pe.from(e.nodes),t.marks=pe.from(e.marks||{}),this.nodes=Rd.compile(this.spec.nodes,this),this.marks=Qo.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",l=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=or.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=l=="_"?null:l?Ad(this,l.split(" ")):l==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Ad(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Rd){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new gl(r,r.defaultAttrs,e,W.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Rt.fromJSON(this,e)}markFromJSON(e){return W.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Ad(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let l in n.marks){let a=n.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function HS(n){return n.tag!=null}function jS(n){return n.style!=null}class yo{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(HS(i))this.tags.push(i);else if(jS(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new Id(this,t,!1);return r.addAll(e,W.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Id(this,t,!0);return r.addAll(e,W.none,t.from,t.to),v.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(QS(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],l=s.style;if(!(l.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(s.getAttrs){let a=s.getAttrs(t);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let l=t[s];if((l.priority==null?50:l.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=zd(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=zd(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new yo(e,yo.schemaRules(e)))}}const Lm={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},KS={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},$m={ol:!0,ul:!0},yl=1,Sl=2,no=4;function bd(n,e,t){return e!=null?(e?yl:0)|(e==="full"?Sl:0):n&&n.whitespace=="pre"?yl|Sl:t&~no}class hs{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=W.none,this.match=o||(s&no?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(C.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&yl)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=C.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(C.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Lm.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Id{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,o,s=bd(null,t.preserveWhitespace,0)|(r?no:0);i?o=new hs(i.type,i.attrs,W.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new hs(null,null,W.none,!0,null,s):o=new hs(e.schema.topNodeType,null,W.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top;if(i.options&Sl||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i.options&yl)i.options&Sl?r=r.replace(/\r\n?/g,`
`):r=r.replace(/\r?\n|\r/g," ");else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],s=e.previousSibling;(!o||s&&s.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=e.nodeName.toLowerCase(),o;$m.hasOwnProperty(i)&&this.parser.normalizeLists&&qS(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(o=this.parser.matchTag(e,this,r));if(s?s.ignore:KS.hasOwnProperty(i))this.findInside(e),this.ignoreFallback(e,t);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let l,a=this.top,u=this.needsBlock;if(Lm.hasOwnProperty(i))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),l=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);return}let c=s&&s.skip?t:this.readStyles(e,t);c&&this.addAll(e,c),l&&this.sync(a),this.needsBlock=u}else{let l=this.readStyles(e,t);l&&this.addElementByRule(e,s,l,s.consuming===!1?o:void 0)}}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let l=void 0;;){let a=this.parser.matchStyle(o,s,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?t=t.filter(u=>!a.clearMark(u)):t=t.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r)||this.leafFallback(e,r);else{let a=this.enter(s,t.attrs||null,r,t.preserveWhitespace);a&&(o=!0,r=a)}else{let a=this.parser.schema.marks[t.mark];r=r.concat(a.create(t.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a,r));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a,r)}o&&this.sync(l)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];s!=l;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],l=s.findWrapping(e);if(l&&(!r||r.length>l.length)&&(r=l,i=s,!l.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)t=this.enterInner(r[o],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let r=this.findPlace(e,t);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=W.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):Pd(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let l=bd(e,o,s.options);s.options&no&&s.content.length==0&&(l|=no);let a=W.none;return r=r.filter(u=>(s.type?s.type.allowsMarkType(u.type):Pd(u.type,e))?(a=u.addToSet(a),!1):!0),this.nodes.push(new hs(e,t,a,i,null,l)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(l,a)=>{for(;l>=0;l--){let u=t[l];if(u==""){if(l==t.length-1||l==0)continue;for(;a>=o;a--)if(s(l-1,a))return!0;return!1}else{let c=a>0||a==0&&i?this.nodes[a].type:r&&a>=o?r.node(a-o).type:null;if(!c||c.name!=u&&c.groups.indexOf(u)==-1)return!1;a--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function qS(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&$m.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function QS(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function zd(n){let e={};for(let t in n)e[t]=n[t];return e}function Pd(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=l=>{o.push(l);for(let a=0;a<l.edgeCount;a++){let{type:u,next:c}=l.edge(a);if(u==e||o.indexOf(c)<0&&s(c))return!0}};if(s(i.contentMatch))return!0}}class gi{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=xa(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let l=0,a=0;for(;l<o.length&&a<s.marks.length;){let u=s.marks[a];if(!this.marks[u.type.name]){a++;continue}if(!u.eq(o[l][0])||u.type.spec.spanning===!1)break;l++,a++}for(;l<o.length;)i=o.pop()[1];for(;a<s.marks.length;){let u=s.marks[a++],c=this.serializeMark(u,s.isInline,t);c&&(o.push([u,i]),i.appendChild(c.dom),i=c.contentDOM||c.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Bs(xa(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Bs(xa(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return Bs(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new gi(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Fd(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Fd(e.marks)}}function Fd(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function xa(n){return n.document||window.document}const Ld=new WeakMap;function YS(n){let e=Ld.get(n);return e===void 0&&Ld.set(n,e=GS(n)),e}function GS(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function Bs(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=YS(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));let l,a=t?n.createElementNS(t,i):n.createElement(i),u=e[1],c=1;if(u&&typeof u=="object"&&u.nodeType==null&&!Array.isArray(u)){c=2;for(let f in u)if(u[f]!=null){let d=f.indexOf(" ");d>0?a.setAttributeNS(f.slice(0,d),f.slice(d+1),u[f]):a.setAttribute(f,u[f])}}for(let f=c;f<e.length;f++){let d=e[f];if(d===0){if(f<e.length-1||f>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:p,contentDOM:h}=Bs(n,d,t,r);if(a.appendChild(p),h){if(l)throw new RangeError("Multiple content holes");l=h}}}return{dom:a,contentDOM:l}}const Vm=65535,Bm=Math.pow(2,16);function XS(n,e){return n+e*Bm}function $d(n){return n&Vm}function ZS(n){return(n-(n&Vm))/Bm}const Jm=1,_m=2,Js=4,Wm=8;let Vd=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Wm)>0}get deletedBefore(){return(this.delInfo&(Jm|Js))>0}get deletedAfter(){return(this.delInfo&(_m|Js))>0}get deletedAcross(){return(this.delInfo&Js)>0}},Yr=class vr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&vr.empty)return vr.empty}recover(e){let t=0,r=$d(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+ZS(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:XS(l/3,e-a),m=e==a?_m:e==f?Jm:Js;return(t<0?e!=a:e!=f)&&(m|=Wm),new Vd(p,m,h)}i+=c-u}return r?e+i:new Vd(e+i,0,null)}touches(e,t){let r=0,i=$d(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new vr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?vr.empty:new vr(e<0?[0,-e,0]:[0,0,e])}};Yr.empty=new Yr([]);const Ca=Object.create(null);let Ke=class{getMap(){return Yr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ca[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ca)throw new RangeError("Duplicate use of step JSON ID "+e);return Ca[e]=t,t.prototype.jsonID=e,t}},$e=class Ti{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ti(e,null)}static fail(e){return new Ti(null,e)}static fromReplace(e,t,r,i){try{return Ti.ok(e.replace(t,r,i))}catch(o){if(o instanceof Tn)return Ti.fail(o.message);throw o}}};function tf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(tf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return C.fromArray(r)}let Um=class Di extends Ke{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new v(tf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return $e.fromReplace(e,this.from,this.to,o)}invert(){return new Hm(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Di(t.pos,r.pos,this.mark)}merge(e){return e instanceof Di&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Di(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Di(t.from,t.to,e.markFromJSON(t.mark))}};Ke.jsonID("addMark",Um);let Hm=class Ri extends Ke{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new v(tf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return $e.fromReplace(e,this.from,this.to,r)}invert(){return new Um(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ri(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ri&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ri(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ri(t.from,t.to,e.markFromJSON(t.mark))}};Ke.jsonID("removeMark",Hm);let jm=class Ai extends Ke{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return $e.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return $e.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Ai(this.pos,t.marks[i]);return new Ai(this.pos,this.mark)}}return new Km(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ai(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ai(t.pos,e.markFromJSON(t.mark))}};Ke.jsonID("addNodeMark",jm);let Km=class Ou extends Ke{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return $e.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return $e.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new jm(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ou(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ou(t.pos,e.markFromJSON(t.mark))}};Ke.jsonID("removeNodeMark",Km);let nf=class Jn extends Ke{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Tu(e,this.from,this.to)?$e.fail("Structure replace would overwrite content"):$e.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Yr([this.from,this.to-this.from,this.slice.size])}invert(e){return new Jn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Jn(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Jn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?v.empty:new v(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Jn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?v.empty:new v(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Jn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Jn(t.from,t.to,v.fromJSON(e,t.slice),!!t.structure)}};Ke.jsonID("replace",nf);let wl=class _s extends Ke{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Tu(e,this.from,this.gapFrom)||Tu(e,this.gapTo,this.to)))return $e.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return $e.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?$e.fromReplace(e,this.from,this.to,r):$e.fail("Content does not fit in gap")}getMap(){return new Yr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new _s(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new _s(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new _s(t.from,t.to,t.gapFrom,t.gapTo,v.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ke.jsonID("replaceAround",wl);function Tu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function ew(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function rf(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!ew(i,o,s))break}return null}function Ws(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let u=i.depth-1,c=t-2;u>o;u--,c--){let f=i.node(u),d=i.index(u);if(f.type.spec.isolating)return!1;let p=f.content.cutByIndex(d,f.childCount),h=r&&r[c]||f;if(h!=f&&(p=p.replaceChild(0,h.type.create(h.attrs))),!f.canReplace(d+1,f.childCount)||!h.type.validContent(p))return!1}let l=i.indexAfter(o),a=r&&r[0];return i.node(o).canReplaceWith(l,l,a?a.type:i.node(o+1).type)}function qm(n,e){let t=n.resolve(e),r=t.index();return tw(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function tw(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Qm(n,e,t=e,r=v.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return nw(i,o,r)?new nf(e,t,r):new rw(i,o,r).fit()}function nw(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let rw=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=C.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=C.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new v(o,s,l);return e>-1?new wl(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new nf(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Na(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(C.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Na(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new v(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Na(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new v(bi(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new v(bi(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),w=f.matchType(m.type);if(!w)break;u++,(u>1||a==0||m.content.size)&&(f=w,c.push(Ym(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=Ii(this.placed,t,C.from(c)),this.frontier[t].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,w=l;m<p;m++){let g=w.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),w=g.content}this.unplaced=h?e==0?v.empty:new v(bi(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new v(bi(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Ma(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Ma(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Ma(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Ii(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Ii(this.placed,this.depth,C.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(C.empty,!0);t.childCount&&(this.placed=Ii(this.placed,this.frontier.length,t))}};function bi(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(bi(n.firstChild.content,e-1,t)))}function Ii(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Ii(n.lastChild.content,e-1,t)))}function Na(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Ym(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Ym(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(C.empty,!0)))),n.copy(r)}function Ma(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!iw(t,o.content,s)?l:null}function iw(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}let ow=class Us extends Ke{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return $e.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return $e.fromReplace(e,this.pos,this.pos+1,new v(C.from(i),0,t.isLeaf?0:1))}getMap(){return Yr.empty}invert(e){return new Us(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Us(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Us(t.pos,t.attr,t.value)}};Ke.jsonID("attr",ow);let So=class extends Error{};So=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};So.prototype=Object.create(Error.prototype);So.prototype.constructor=So;So.prototype.name="TransformError";const Gm=65535,Xm=Math.pow(2,16);function sw(n,e){return n+e*Xm}function Bd(n){return n&Gm}function lw(n){return(n-(n&Gm))/Xm}const Zm=1,eg=2,Hs=4,tg=8;let Du=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&tg)>0}get deletedBefore(){return(this.delInfo&(Zm|Hs))>0}get deletedAfter(){return(this.delInfo&(eg|Hs))>0}get deletedAcross(){return(this.delInfo&Hs)>0}},Gr=class xr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&xr.empty)return xr.empty}recover(e){let t=0,r=Bd(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+lw(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:sw(l/3,e-a),m=e==a?eg:e==f?Zm:Hs;return(t<0?e!=a:e!=f)&&(m|=tg),new Du(p,m,h)}i+=c-u}return r?e+i:new Du(e+i,0,null)}touches(e,t){let r=0,i=Bd(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new xr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?xr.empty:new xr(e<0?[0,-e,0]:[0,0,e])}};Gr.empty=new Gr([]);let aw=class js{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new js(this.maps,this.mirror,e,t)}copy(){return new js(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new js;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],l=s.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Du(e,i,null)}};const Ea=Object.create(null);let qe=class{getMap(){return Gr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ea[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ea)throw new RangeError("Duplicate use of step JSON ID "+e);return Ea[e]=t,t.prototype.jsonID=e,t}},Ve=class zi{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new zi(e,null)}static fail(e){return new zi(null,e)}static fromReplace(e,t,r,i){try{return zi.ok(e.replace(t,r,i))}catch(o){if(o instanceof Tn)return zi.fail(o.message);throw o}}};function of(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(of(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return C.fromArray(r)}let sf=class Pi extends qe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new v(of(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Ve.fromReplace(e,this.from,this.to,o)}invert(){return new Yo(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Pi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Pi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Pi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Pi(t.from,t.to,e.markFromJSON(t.mark))}};qe.jsonID("addMark",sf);let Yo=class Fi extends qe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new v(of(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Ve.fromReplace(e,this.from,this.to,r)}invert(){return new sf(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Fi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Fi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Fi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Fi(t.from,t.to,e.markFromJSON(t.mark))}};qe.jsonID("removeMark",Yo);let lf=class Li extends qe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ve.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ve.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Li(this.pos,t.marks[i]);return new Li(this.pos,this.mark)}}return new af(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Li(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Li(t.pos,e.markFromJSON(t.mark))}};qe.jsonID("addNodeMark",lf);let af=class Ru extends qe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ve.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ve.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new lf(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ru(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ru(t.pos,e.markFromJSON(t.mark))}};qe.jsonID("removeNodeMark",af);let An=class _n extends qe{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Au(e,this.from,this.to)?Ve.fail("Structure replace would overwrite content"):Ve.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Gr([this.from,this.to-this.from,this.slice.size])}invert(e){return new _n(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new _n(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof _n)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?v.empty:new v(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new _n(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?v.empty:new v(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new _n(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new _n(t.from,t.to,v.fromJSON(e,t.slice),!!t.structure)}};qe.jsonID("replace",An);let dr=class Ks extends qe{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Au(e,this.from,this.gapFrom)||Au(e,this.gapTo,this.to)))return Ve.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ve.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Ve.fromReplace(e,this.from,this.to,r):Ve.fail("Content does not fit in gap")}getMap(){return new Gr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ks(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Ks(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ks(t.from,t.to,t.gapFrom,t.gapTo,v.fromJSON(e,t.slice),t.insert,!!t.structure)}};qe.jsonID("replaceAround",dr);function Au(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function uw(n,e,t,r){let i=[],o=[],s,l;n.doc.nodesBetween(e,t,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),p=Math.min(u+a.nodeSize,t),h=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(h)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=p:i.push(s=new Yo(d,p,f[m])));l&&l.to==d?l.to=p:o.push(l=new sf(d,p,r))}}),i.forEach(a=>n.step(a)),o.forEach(a=>n.step(a))}function cw(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof Qo){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],d;for(let p=0;p<i.length;p++){let h=i[p];h.step==o-1&&f.eq(i[p].style)&&(d=h)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>n.step(new Yo(s.from,s.to,s.style)))}function fw(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=s+a.nodeSize,c=r.matchType(a.type);if(!c)o.push(new An(s,u,v.empty));else{r=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||n.step(new Yo(s,u,a.marks[f]))}s=u}if(!r.validEnd){let l=r.fillBefore(C.empty,!0);n.replace(s,s,new v(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function dw(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=C.empty,f=0;for(let h=o,m=!1;h>t;h--)m||r.index(h)>0?(m=!0,c=C.from(r.node(h).copy(c)),f++):a--;let d=C.empty,p=0;for(let h=o,m=!1;h>t;h--)m||i.after(h+1)<i.end(h)?(m=!0,d=C.from(i.node(h).copy(d)),p++):u++;n.step(new dr(a,u,s,l,new v(c.append(d),f,p),c.size-f,!0))}function hw(n,e,t){let r=C.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let l=t[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=C.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new dr(i,o,i,o,new v(r,0,0),t.length,!0))}function pw(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,l)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&mw(n.doc,n.mapping.slice(o).map(l),r)){n.clearIncompatible(n.mapping.slice(o).map(l,1),r);let a=n.mapping.slice(o),u=a.map(l,1),c=a.map(l+s.nodeSize,1);return n.step(new dr(u,c,u+1,c-1,new v(C.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function mw(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function gw(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new dr(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new v(C.from(s),0,0),1,!0))}function yw(n,e,t=1,r){let i=n.doc.resolve(e),o=C.empty,s=C.empty;for(let l=i.depth,a=i.depth-t,u=t-1;l>a;l--,u--){o=C.from(i.node(l).copy(o));let c=r&&r[u];s=C.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}n.step(new An(e,e,new v(o.append(s),t,t),!0))}function Sw(n,e,t){let r=new An(e-t,e+t,v.empty,!0);n.step(r)}function ww(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function kw(n,e,t=e,r=v.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return ng(i,o,r)?new An(e,t,r):new vw(i,o,r).fit()}function ng(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}let vw=class{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=C.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=C.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new v(o,s,l);return e>-1?new dr(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new An(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Oa(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(C.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Oa(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new v(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Oa(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new v($i(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new v($i(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),w=f.matchType(m.type);if(!w)break;u++,(u>1||a==0||m.content.size)&&(f=w,c.push(rg(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=Vi(this.placed,t,C.from(c)),this.frontier[t].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,w=l;m<p;m++){let g=w.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),w=g.content}this.unplaced=h?e==0?v.empty:new v($i(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new v($i(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Ta(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Ta(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Ta(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Vi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Vi(this.placed,this.depth,C.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(C.empty,!0);t.childCount&&(this.placed=Vi(this.placed,this.frontier.length,t))}};function $i(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy($i(n.firstChild.content,e-1,t)))}function Vi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Vi(n.lastChild.content,e-1,t)))}function Oa(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function rg(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,rg(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(C.empty,!0)))),n.copy(r)}function Ta(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!xw(t,o.content,s)?l:null}function xw(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Cw(n){return n.spec.defining||n.spec.definingForContent}function Nw(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(ng(i,o,r))return n.step(new An(e,t,r));let s=og(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,p=i.pos-1;d>0;d--,p--){let h=i.node(d).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==p&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,p=0;;p++){let h=d.firstChild;if(u.push(h),p==r.openStart)break;d=h.content}for(let d=c-1;d>=0;d--){let p=u[d].type,h=Cw(p);if(h&&i.node(a).type!=p)c=d;else if(h||!p.isTextblock)break}for(let d=r.openStart;d>=0;d--){let p=(d+c+1)%(r.openStart+1),h=u[p];if(h)for(let m=0;m<s.length;m++){let w=s[(m+a)%s.length],g=!0;w<0&&(g=!1,w=-w);let y=i.node(w-1),S=i.index(w-1);if(y.canReplaceWith(S,S,h.type,h.marks))return n.replace(i.before(w),g?o.after(w):t,new v(ig(r.content,0,r.openStart,p),p,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let p=s[d];p<0||(e=i.before(p),t=o.after(p))}}function ig(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(ig(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(C.empty,!0))}return n}function Mw(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=ww(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new v(C.from(r),0,0))}function Ew(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=og(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function og(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}let sg=class qs extends qe{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ve.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Ve.fromReplace(e,this.pos,this.pos+1,new v(C.from(i),0,t.isLeaf?0:1))}getMap(){return Gr.empty}invert(e){return new qs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new qs(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new qs(t.pos,t.attr,t.value)}};qe.jsonID("attr",sg);let Xr=class extends Error{};Xr=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Xr.prototype=Object.create(Error.prototype);Xr.prototype.constructor=Xr;Xr.prototype.name="TransformError";let Ow=class{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new aw}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Xr(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=v.empty){let i=kw(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new v(C.from(r),0,0))}delete(e,t){return this.replace(e,t,v.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Nw(this,e,t,r),this}replaceRangeWith(e,t,r){return Mw(this,e,t,r),this}deleteRange(e,t){return Ew(this,e,t),this}lift(e,t){return dw(this,e,t),this}join(e,t=1){return Sw(this,e,t),this}wrap(e,t){return hw(this,e,t),this}setBlockType(e,t=e,r,i=null){return pw(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return gw(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new sg(e,t,r)),this}addNodeMark(e,t){return this.step(new lf(e,t)),this}removeNodeMark(e,t){if(!(t instanceof W)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new af(e,t)),this}split(e,t=1,r){return yw(this,e,t,r),this}addMark(e,t,r){return uw(this,e,t,r),this}removeMark(e,t,r){return cw(this,e,t,r),this}clearIncompatible(e,t,r){return fw(this,e,t,r),this}};const Da=Object.create(null);class P{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new lg(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=v.empty){let r=t.content.lastChild,i=null;for(let l=0;l<t.openEnd;l++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:u}=s[l],c=e.mapping.slice(o);e.replaceRange(c.map(a.pos),c.map(u.pos),l?v.empty:t),l==0&&Wd(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:l}=i[o],a=e.mapping.slice(r),u=a.map(s.pos),c=a.map(l.pos);o?e.deleteRange(u,c):(e.replaceRangeWith(u,c,t),Wd(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new $(e):Cr(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?Cr(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Cr(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new et(e.node(0))}static atStart(e){return Cr(e,e,0,0,1)||new et(e)}static atEnd(e){return Cr(e,e,e.content.size,e.childCount,-1)||new et(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Da[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Da)throw new RangeError("Duplicate use of selection JSON ID "+e);return Da[e]=t,t.prototype.jsonID=e,t}getBookmark(){return $.between(this.$anchor,this.$head).getBookmark()}}P.prototype.visible=!0;class lg{constructor(e,t){this.$from=e,this.$to=t}}let Jd=!1;function _d(n){!Jd&&!n.parent.inlineContent&&(Jd=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class $ extends P{constructor(e,t=e){_d(e),_d(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return P.near(r);let i=e.resolve(t.map(this.anchor));return new $(i.parent.inlineContent?i:r,r)}replace(e,t=v.empty){if(super.replace(e,t),t==v.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof $&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new ea(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new $(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=P.findFrom(t,r,!0)||P.findFrom(t,-r,!0);if(o)t=o.$head;else return P.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(P.findFrom(e,-r,!0)||P.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new $(e,t)}}P.jsonID("text",$);class ea{constructor(e,t){this.anchor=e,this.head=t}map(e){return new ea(e.map(this.anchor),e.map(this.head))}resolve(e){return $.between(e.resolve(this.anchor),e.resolve(this.head))}}class I extends P{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?P.near(o):new I(o)}content(){return new v(C.from(this.node),0,0)}eq(e){return e instanceof I&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new uf(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new I(e.resolve(t.anchor))}static create(e,t){return new I(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}I.prototype.visible=!1;P.jsonID("node",I);class uf{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new ea(r,r):new uf(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&I.isSelectable(r)?new I(t):P.near(t)}}class et extends P{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=v.empty){if(t==v.empty){e.delete(0,e.doc.content.size);let r=P.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new et(e)}map(e){return new et(e)}eq(e){return e instanceof et}getBookmark(){return Tw}}P.jsonID("all",et);const Tw={map(){return this},resolve(n){return new et(n)}};function Cr(n,e,t,r,i,o=!1){if(e.inlineContent)return $.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let l=e.child(s);if(l.isAtom){if(!o&&I.isSelectable(l))return I.create(n,t-(i<0?l.nodeSize:0))}else{let a=Cr(n,l,t+i,i<0?l.childCount:0,i,o);if(a)return a}t+=l.nodeSize*i}return null}function Wd(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof An||i instanceof dr))return;let o=n.mapping.maps[r],s;o.forEach((l,a,u,c)=>{s==null&&(s=c)}),n.setSelection(P.near(n.doc.resolve(s),t))}const Ud=1,ps=2,Hd=4;class Dw extends Ow{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ud)&~ps,this.storedMarks=null,this}get selectionSet(){return(this.updated&Ud)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=ps,this}ensureMarks(e){return W.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&ps)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~ps,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||W.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(P.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Hd,this}get scrolledIntoView(){return(this.updated&Hd)>0}}function jd(n,e){return!e||!n?n:n.bind(e)}class Bi{constructor(e,t,r){this.name=e,this.init=jd(t.init,r),this.apply=jd(t.apply,r)}}const Rw=[new Bi("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Bi("selection",{init(n,e){return n.selection||P.atStart(e.doc)},apply(n){return n.selection}}),new Bi("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Bi("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Ra{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=Rw.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Bi(r.key,r.spec.state,r))})}}class dn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=i?i[s].n:0,u=i?i[s].state:this,c=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,u,r);if(c&&r.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<s?{state:r,n:t.length}:{state:this,n:0})}t.push(c),r=r.applyInner(c),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new dn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new Dw(this)}static create(e){let t=new Ra(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new dn(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new Ra(this.schema,e.plugins),r=t.fields,i=new dn(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new Ra(e.schema,e.plugins),o=new dn(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=Rt.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=P.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],u=a.spec.state;if(a.key==s.name&&u&&u.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){o[s.name]=u.fromJSON.call(a,e,t[l],o);return}}o[s.name]=s.init(e,o)}}),o}}function ag(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=ag(i,e,{})),t[r]=i}return t}class Vt{constructor(e){this.spec=e,this.props={},e.props&&ag(e.props,this,this.props),this.key=e.key?e.key.key:ug("plugin")}getState(e){return e[this.key]}}const Aa=Object.create(null);function ug(n){return n in Aa?n+"$"+ ++Aa[n]:(Aa[n]=0,n+"$")}class Go{constructor(e="key"){this.key=ug(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const cg=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Aw(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const bw=(n,e,t)=>{let r=Aw(n,t);if(!r)return!1;let i=fg(r);if(!i){let s=r.blockRange(),l=s&&rf(s);return l==null?!1:(e&&e(n.tr.lift(s,l).scrollIntoView()),!0)}let o=i.nodeBefore;if(!o.type.spec.isolating&&hg(n,i,e))return!0;if(r.parent.content.size==0&&(Zr(o,"end")||I.isSelectable(o))){let s=Qm(n.doc,r.before(),r.after(),v.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=n.tr.step(s);l.setSelection(Zr(o,"end")?P.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):I.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1};function Zr(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const Iw=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=fg(r)}let s=o&&o.nodeBefore;return!s||!I.isSelectable(s)?!1:(e&&e(n.tr.setSelection(I.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function fg(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function zw(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const Pw=(n,e,t)=>{let r=zw(n,t);if(!r)return!1;let i=dg(r);if(!i)return!1;let o=i.nodeAfter;if(hg(n,i,e))return!0;if(r.parent.content.size==0&&(Zr(o,"start")||I.isSelectable(o))){let s=Qm(n.doc,r.before(),r.after(),v.empty);if(s&&s.slice.size<s.to-s.from){if(e){let l=n.tr.step(s);l.setSelection(Zr(o,"start")?P.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):I.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},Fw=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=dg(r)}let s=o&&o.nodeAfter;return!s||!I.isSelectable(s)?!1:(e&&e(n.tr.setSelection(I.create(n.doc,o.pos)).scrollIntoView()),!0)};function dg(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Lw=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function cf(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const $w=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=cf(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let l=t.after(),a=n.tr.replaceWith(l,l,s.createAndFill());a.setSelection(P.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},Vw=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof et||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=cf(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(s,o.createAndFill());l.setSelection($.create(l.doc,s+1)),e(l.scrollIntoView())}return!0},Bw=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(Ws(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&rf(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)};function Jw(n){return(e,t)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof I&&e.selection.node.isBlock)return!r.parentOffset||!Ws(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){let o=i.parentOffset==i.parent.content.size,s=e.tr;(e.selection instanceof $||e.selection instanceof et)&&s.deleteSelection();let l=r.depth==0?null:cf(r.node(-1).contentMatchAt(r.indexAfter(-1))),a=o&&l?[{type:l}]:void 0,u=Ws(s.doc,s.mapping.map(r.pos),1,a);if(!a&&!u&&Ws(s.doc,s.mapping.map(r.pos),1,l?[{type:l}]:void 0)&&(l&&(a=[{type:l}]),u=!0),u&&(s.split(s.mapping.map(r.pos),1,a),!o&&!r.parentOffset&&r.parent.type!=l)){let c=s.mapping.map(r.before()),f=s.doc.resolve(c);l&&r.node(-1).canReplaceWith(f.index(),f.index()+1,l)&&s.setNodeMarkup(s.mapping.map(r.before()),l)}t(s.scrollIntoView())}return!0}}const _w=Jw(),Ww=(n,e)=>(e&&e(n.tr.setSelection(new et(n.doc))),!0);function Uw(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||qm(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function hg(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o,s;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(Uw(n,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(o=(s=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&s.matchType(o[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,d=C.empty;for(let m=o.length-1;m>=0;m--)d=C.from(o[m].create(null,d));d=C.from(r.copy(d));let p=n.tr.step(new wl(e.pos-1,f,e.pos,f,new v(d,1,0),o.length,!0)),h=f+2*o.length;qm(p.doc,h)&&p.join(h),t(p.scrollIntoView())}return!0}let a=P.findFrom(e,1),u=a&&a.$from.blockRange(a.$to),c=u&&rf(u);if(c!=null&&c>=e.depth)return t&&t(n.tr.lift(u,c).scrollIntoView()),!0;if(l&&Zr(i,"start",!0)&&Zr(r,"end")){let f=r,d=[];for(;d.push(f),!f.isTextblock;)f=f.lastChild;let p=i,h=1;for(;!p.isTextblock;p=p.firstChild)h++;if(f.canReplace(f.childCount,f.childCount,p.content)){if(t){let m=C.empty;for(let g=d.length-1;g>=0;g--)m=C.from(d[g].copy(m));let w=n.tr.step(new wl(e.pos-d.length,e.pos+i.nodeSize,e.pos+h,e.pos+i.nodeSize-h,new v(m,d.length,0),0,!0));t(w.scrollIntoView())}return!0}}return!1}function pg(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection($.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const Hw=pg(-1),jw=pg(1);function Kw(n,e,t){for(let r=0;r<e.length;r++){let{$from:i,$to:o}=e[r],s=i.depth==0?n.inlineContent&&n.type.allowsMarkType(t):!1;if(n.nodesBetween(i.pos,o.pos,l=>{if(s)return!1;s=l.inlineContent&&l.type.allowsMarkType(t)}),s)return!0}return!1}function Kd(n,e=null){return function(t,r){let{empty:i,$cursor:o,ranges:s}=t.selection;if(i&&!o||!Kw(t.doc,s,n))return!1;if(r)if(o)n.isInSet(t.storedMarks||o.marks())?r(t.tr.removeStoredMark(n)):r(t.tr.addStoredMark(n.create(e)));else{let l=!1,a=t.tr;for(let u=0;!l&&u<s.length;u++){let{$from:c,$to:f}=s[u];l=t.doc.rangeHasMark(c.pos,f.pos,n)}for(let u=0;u<s.length;u++){let{$from:c,$to:f}=s[u];if(l)a.removeMark(c.pos,f.pos,n);else{let d=c.pos,p=f.pos,h=c.nodeAfter,m=f.nodeBefore,w=h&&h.isText?/^\s*/.exec(h.text)[0].length:0,g=m&&m.isText?/\s*$/.exec(m.text)[0].length:0;d+w<p&&(d+=w,p-=g),a.addMark(d,p,n.create(e))}}r(a.scrollIntoView())}return!0}}function ff(...n){return function(e,t,r){for(let i=0;i<n.length;i++)if(n[i](e,t,r))return!0;return!1}}let ba=ff(cg,bw,Iw),qd=ff(cg,Pw,Fw);const Ut={Enter:ff(Lw,Vw,Bw,_w),"Mod-Enter":$w,Backspace:ba,"Mod-Backspace":ba,"Shift-Backspace":ba,Delete:qd,"Mod-Delete":qd,"Mod-a":Ww},mg={"Ctrl-h":Ut.Backspace,"Alt-Backspace":Ut["Mod-Backspace"],"Ctrl-d":Ut.Delete,"Ctrl-Alt-Backspace":Ut["Mod-Delete"],"Alt-Delete":Ut["Mod-Delete"],"Alt-d":Ut["Mod-Delete"],"Ctrl-a":Hw,"Ctrl-e":jw};for(let n in Ut)mg[n]=Ut[n];const qw=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,Qw=qw?mg:Ut;var zt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},kl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Qd=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent),Yw=typeof navigator<"u"&&/Mac/.test(navigator.platform),Gw=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Xw=Yw||Qd&&+Qd[1]<57;for(var ge=0;ge<10;ge++)zt[48+ge]=zt[96+ge]=String(ge);for(var ge=1;ge<=24;ge++)zt[ge+111]="F"+ge;for(var ge=65;ge<=90;ge++)zt[ge]=String.fromCharCode(ge+32),kl[ge]=String.fromCharCode(ge);for(var Ia in zt)kl.hasOwnProperty(Ia)||(kl[Ia]=zt[Ia]);function df(n){var e=Xw&&(n.ctrlKey||n.altKey||n.metaKey)||Gw&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?kl:zt)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Zw=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function ek(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))Zw?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function tk(n){let e=Object.create(null);for(let t in n)e[ek(t)]=n[t];return e}function za(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function nk(n){let e=tk(n);return function(t,r){let i=df(r),o,s=e[za(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[za(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=zt[r.keyCode])&&o!=i){let l=e[za(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const gg=65535,yg=Math.pow(2,16);function rk(n,e){return n+e*yg}function Yd(n){return n&gg}function ik(n){return(n-(n&gg))/yg}const Sg=1,wg=2,Qs=4,kg=8;let Gd=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&kg)>0}get deletedBefore(){return(this.delInfo&(Sg|Qs))>0}get deletedAfter(){return(this.delInfo&(wg|Qs))>0}get deletedAcross(){return(this.delInfo&Qs)>0}},ei=class Nr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Nr.empty)return Nr.empty}recover(e){let t=0,r=Yd(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+ik(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:rk(l/3,e-a),m=e==a?wg:e==f?Sg:Qs;return(t<0?e!=a:e!=f)&&(m|=kg),new Gd(p,m,h)}i+=c-u}return r?e+i:new Gd(e+i,0,null)}touches(e,t){let r=0,i=Yd(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Nr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Nr.empty:new Nr(e<0?[0,-e,0]:[0,0,e])}};ei.empty=new ei([]);const Pa=Object.create(null);let Qe=class{getMap(){return ei.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Pa[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Pa)throw new RangeError("Duplicate use of step JSON ID "+e);return Pa[e]=t,t.prototype.jsonID=e,t}},Be=class Ji{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ji(e,null)}static fail(e){return new Ji(null,e)}static fromReplace(e,t,r,i){try{return Ji.ok(e.replace(t,r,i))}catch(o){if(o instanceof Tn)return Ji.fail(o.message);throw o}}};function hf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(hf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return C.fromArray(r)}let vg=class _i extends Qe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new v(hf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Be.fromReplace(e,this.from,this.to,o)}invert(){return new xg(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new _i(t.pos,r.pos,this.mark)}merge(e){return e instanceof _i&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new _i(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new _i(t.from,t.to,e.markFromJSON(t.mark))}};Qe.jsonID("addMark",vg);let xg=class Wi extends Qe{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new v(hf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Be.fromReplace(e,this.from,this.to,r)}invert(){return new vg(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Wi(t.pos,r.pos,this.mark)}merge(e){return e instanceof Wi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Wi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Wi(t.from,t.to,e.markFromJSON(t.mark))}};Qe.jsonID("removeMark",xg);let Cg=class Ui extends Qe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Be.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new Ui(this.pos,t.marks[i]);return new Ui(this.pos,this.mark)}}return new Ng(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ui(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new Ui(t.pos,e.markFromJSON(t.mark))}};Qe.jsonID("addNodeMark",Cg);let Ng=class bu extends Qe{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Be.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new Cg(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new bu(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new bu(t.pos,e.markFromJSON(t.mark))}};Qe.jsonID("removeNodeMark",Ng);let ok=class Wn extends Qe{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Iu(e,this.from,this.to)?Be.fail("Structure replace would overwrite content"):Be.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ei([this.from,this.to-this.from,this.slice.size])}invert(e){return new Wn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Wn(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Wn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?v.empty:new v(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Wn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?v.empty:new v(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Wn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Wn(t.from,t.to,v.fromJSON(e,t.slice),!!t.structure)}};Qe.jsonID("replace",ok);let sk=class Ys extends Qe{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Iu(e,this.from,this.gapFrom)||Iu(e,this.gapTo,this.to)))return Be.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Be.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Be.fromReplace(e,this.from,this.to,r):Be.fail("Content does not fit in gap")}getMap(){return new ei([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Ys(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Ys(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ys(t.from,t.to,t.gapFrom,t.gapTo,v.fromJSON(e,t.slice),t.insert,!!t.structure)}};Qe.jsonID("replaceAround",sk);function Iu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function lk(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let l=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,a=r.index(s)+(l>0?1:0),u=r.node(s),c=!1;if(o==1)c=u.canReplace(a,a,i);else{let f=u.contentMatchAt(a).findWrapping(i.firstChild.type);c=f&&u.canReplaceWith(a,a,f[0])}if(c)return l==0?r.pos:l<0?r.before(s+1):r.after(s+1)}return null}let ak=class Gs extends Qe{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Be.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Be.fromReplace(e,this.pos,this.pos+1,new v(C.from(i),0,t.isLeaf?0:1))}getMap(){return ei.empty}invert(e){return new Gs(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Gs(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Gs(t.pos,t.attr,t.value)}};Qe.jsonID("attr",ak);let wo=class extends Error{};wo=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};wo.prototype=Object.create(Error.prototype);wo.prototype.constructor=wo;wo.prototype.name="TransformError";const ye=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ko=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let zu=null;const _t=function(n,e,t){let r=zu||(zu=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},uk=function(){zu=null},sr=function(n,e,t,r){return t&&(Xd(n,e,t,r,-1)||Xd(n,e,t,r,1))},ck=/^(img|br|input|textarea|hr)$/i;function Xd(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:at(n))){let o=n.parentNode;if(!o||o.nodeType!=1||Xo(n)||ck.test(n.nodeName)||n.contentEditable=="false")return!1;e=ye(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?at(n):0}else return!1}}function at(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function fk(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=at(n)}else if(n.parentNode&&!Xo(n))e=ye(n),n=n.parentNode;else return null}}function dk(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Xo(n))e=ye(n)+1,n=n.parentNode;else return null}}function hk(n,e,t){for(let r=e==0,i=e==at(n);r||i;){if(n==t)return!0;let o=ye(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==at(n)}}function Xo(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const ta=function(n){return n.focusNode&&sr(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Kn(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function pk(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function mk(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(at(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(at(r.startContainer),r.startOffset)}}}const Pt=typeof navigator<"u"?navigator:null,Zd=typeof document<"u"?document:null,bn=Pt&&Pt.userAgent||"",Pu=/Edge\/(\d+)/.exec(bn),Mg=/MSIE \d/.exec(bn),Fu=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(bn),We=!!(Mg||Fu||Pu),Sn=Mg?document.documentMode:Fu?+Fu[1]:Pu?+Pu[1]:0,Ct=!We&&/gecko\/(\d+)/i.test(bn);Ct&&+(/Firefox\/(\d+)/.exec(bn)||[0,0])[1];const Lu=!We&&/Chrome\/(\d+)/.exec(bn),Me=!!Lu,Eg=Lu?+Lu[1]:0,be=!We&&!!Pt&&/Apple Computer/.test(Pt.vendor),ti=be&&(/Mobile\/\w+/.test(bn)||!!Pt&&Pt.maxTouchPoints>2),ot=ti||(Pt?/Mac/.test(Pt.platform):!1),gk=Pt?/Win/.test(Pt.platform):!1,wt=/Android \d/.test(bn),Zo=!!Zd&&"webkitFontSmoothing"in Zd.documentElement.style,yk=Zo?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Sk(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function Bt(n,e){return typeof n=="number"?n:n[e]}function wk(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function eh(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;s=ko(s)){if(s.nodeType!=1)continue;let l=s,a=l==o.body,u=a?Sk(o):wk(l),c=0,f=0;if(e.top<u.top+Bt(r,"top")?f=-(u.top-e.top+Bt(i,"top")):e.bottom>u.bottom-Bt(r,"bottom")&&(f=e.bottom-e.top>u.bottom-u.top?e.top+Bt(i,"top")-u.top:e.bottom-u.bottom+Bt(i,"bottom")),e.left<u.left+Bt(r,"left")?c=-(u.left-e.left+Bt(i,"left")):e.right>u.right-Bt(r,"right")&&(c=e.right-u.right+Bt(i,"right")),c||f)if(a)o.defaultView.scrollBy(c,f);else{let d=l.scrollLeft,p=l.scrollTop;f&&(l.scrollTop+=f),c&&(l.scrollLeft+=c);let h=l.scrollLeft-d,m=l.scrollTop-p;e={left:e.left-h,top:e.top-m,right:e.right-h,bottom:e.bottom-m}}if(a||/^(fixed|sticky)$/.test(getComputedStyle(s).position))break}}function kk(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let l=n.root.elementFromPoint(o,s);if(!l||l==n.dom||!n.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Og(n.dom)}}function Og(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=ko(r));return e}function vk({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Tg(t,r==0?0:r-e)}function Tg(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let Sr=null;function xk(n){if(n.setActive)return n.setActive();if(Sr)return n.focus(Sr);let e=Og(n);n.focus(Sr==null?{get preventScroll(){return Sr={preventScroll:!0},!0}}:void 0),Sr||(Sr=!1,Tg(e,0))}function Dg(n,e){let t,r=2e8,i,o=0,s=e.top,l=e.top,a,u;for(let c=n.firstChild,f=0;c;c=c.nextSibling,f++){let d;if(c.nodeType==1)d=c.getClientRects();else if(c.nodeType==3)d=_t(c).getClientRects();else continue;for(let p=0;p<d.length;p++){let h=d[p];if(h.top<=s&&h.bottom>=l){s=Math.max(h.bottom,s),l=Math.min(h.top,l);let m=h.left>e.left?h.left-e.left:h.right<e.left?e.left-h.right:0;if(m<r){t=c,r=m,i=m&&t.nodeType==3?{left:h.right<e.left?h.right:h.left,top:e.top}:e,c.nodeType==1&&m&&(o=f+(e.left>=(h.left+h.right)/2?1:0));continue}}else h.top>e.top&&!a&&h.left<=e.left&&h.right>=e.left&&(a=c,u={left:Math.max(h.left,Math.min(h.right,e.left)),top:h.top});!t&&(e.left>=h.right&&e.top>=h.top||e.left>=h.left&&e.top>=h.bottom)&&(o=f+1)}}return!t&&a&&(t=a,i=u,r=0),t&&t.nodeType==3?Ck(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:Dg(t,i)}function Ck(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=nn(r,1);if(o.top!=o.bottom&&pf(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function pf(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function Nk(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function Mk(n,e,t){let{node:r,offset:i}=Dg(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function Ek(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let l=n.docView.nearestDesc(o,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)){let a=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&(!s&&a.left>r.left||a.top>r.top?i=l.posBefore:(!s&&a.right<r.left||a.bottom<r.top)&&(i=l.posAfter),s=!0),!l.contentDOM&&i<0&&!l.node.isText)return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter}o=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function Rg(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let u=l[a];if(pf(e,u))return Rg(s,e,u)}}if((o=(o+1)%r)==i)break}return n}function Ok(n,e){let t=n.dom.ownerDocument,r,i=0,o=mk(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),l;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let u=n.dom.getBoundingClientRect();if(!pf(e,u)||(s=Rg(n.dom,e,u),!s))return null}if(be)for(let u=s;r&&u;u=ko(u))u.draggable&&(r=void 0);if(s=Nk(s,e),r){if(Ct&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],f;c.nodeName=="IMG"&&(f=c.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let u;Zo&&i&&r.nodeType==1&&(u=r.childNodes[i-1]).nodeType==1&&u.contentEditable=="false"&&u.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=Ek(n,r,i,e))}l==null&&(l=Mk(n,s,e));let a=n.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function th(n){return n.top<n.bottom||n.left<n.right}function nn(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(th(r))return r}return Array.prototype.find.call(t,th)||n.getBoundingClientRect()}const Tk=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Ag(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=Zo||Ct;if(r.nodeType==3)if(s&&(Tk.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let a=nn(_t(r,i,i),t);if(Ct&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let u=nn(_t(r,i-1,i-1),-1);if(u.top==a.top){let c=nn(_t(r,i,i+1),-1);if(c.top!=a.top)return wi(c,c.left<u.left)}}return a}else{let a=i,u=i,c=t<0?1:-1;return t<0&&!i?(u++,c=-1):t>=0&&i==r.nodeValue.length?(a--,c=1):t<0?a--:u++,wi(nn(_t(r,a,u),c),c<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==at(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return Fa(a.getBoundingClientRect(),!1)}if(o==null&&i<at(r)){let a=r.childNodes[i];if(a.nodeType==1)return Fa(a.getBoundingClientRect(),!0)}return Fa(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==at(r))){let a=r.childNodes[i-1],u=a.nodeType==3?_t(a,at(a)-(s?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(u)return wi(nn(u,1),!1)}if(o==null&&i<at(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let u=a?a.nodeType==3?_t(a,0,s?0:1):a.nodeType==1?a:null:null;if(u)return wi(nn(u,-1),!0)}return wi(nn(r.nodeType==3?_t(r):r,-t),t>=0)}function wi(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Fa(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function bg(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function Dk(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return bg(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(o,!0);if(!l)break;if(l.node.isBlock){o=l.contentDOM||l.dom;break}o=l.dom.parentNode}let s=Ag(n,i.pos,1);for(let l=o.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=_t(l,0,l.nodeValue.length).getClientRects();else continue;for(let u=0;u<a.length;u++){let c=a[u];if(c.bottom>c.top+1&&(t=="up"?s.top-c.top>(c.bottom-s.top)*2:c.bottom-s.bottom>(s.bottom-c.top)*2))return!1}}return!0})}const Rk=/[\u0590-\u08ac]/;function Ak(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,l=n.domSelection();return l?!Rk.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?o:s:bg(n,e,()=>{let{focusNode:a,focusOffset:u,anchorNode:c,anchorOffset:f}=n.domSelectionRange(),d=l.caretBidiLevel;l.modify("move",t,"character");let p=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:h,focusOffset:m}=n.domSelectionRange(),w=h&&!p.contains(h.nodeType==1?h:h.parentNode)||a==h&&u==m;try{l.collapse(c,f),a&&(a!=c||u!=f)&&l.extend&&l.extend(a,u)}catch{}return d!=null&&(l.caretBidiLevel=d),w}):r.pos==r.start()||r.pos==r.end()}let nh=null,rh=null,ih=!1;function bk(n,e,t){return nh==e&&rh==t?ih:(nh=e,rh=t,ih=t=="up"||t=="down"?Dk(n,e,t):Ak(n,e,t))}const ft=0,oh=1,qn=2,Ft=3;let es=class{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=ft,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>ye(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],l=o+s.size;if(l>e||s instanceof Lg){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof Ig&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?ye(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?ye(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){let a=this.children[l],u=s+a.size;if(i==-1&&e<=u){let c=s+a.border;if(e>=c&&t<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=s;for(let f=l;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=ye(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>t||l==this.children.length-1)){t=u;for(let c=l+1;c<this.children.length;c++){let f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=ye(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let d=0,p=0;d<this.children.length;d++){let h=this.children[d],m=p+h.size;if(o>p&&s<m)return h.setSelection(e-p-h.border,t-p-h.border,r,i);p=m}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),u=r.getSelection(),c=!1;if((Ct||be)&&e==t){let{node:d,offset:p}=l;if(d.nodeType==3){if(c=!!(p&&d.nodeValue[p-1]==`
`),c&&p==d.nodeValue.length)for(let h=d,m;h;h=h.parentNode){if(m=h.nextSibling){m.nodeName=="BR"&&(l=a={node:m.parentNode,offset:ye(m)+1});break}let w=h.pmViewDesc;if(w&&w.node&&w.node.isBlock)break}}else{let h=d.childNodes[p-1];c=h&&(h.nodeName=="BR"||h.contentEditable=="false")}}if(Ct&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){let d=u.focusNode.childNodes[u.focusOffset];d&&d.contentEditable=="false"&&(i=!0)}if(!(i||c&&be)&&sr(l.node,l.offset,u.anchorNode,u.anchorOffset)&&sr(a.node,a.offset,u.focusNode,u.focusOffset))return;let f=!1;if((u.extend||e==t)&&!c){u.collapse(l.node,l.offset);try{e!=t&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>t){let p=l;l=a,a=p}let d=document.createRange();d.setEnd(a.node,a.offset),d.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(d)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let l=r+o.border,a=s-o.border;if(e>=l&&t<=a){this.dirty=e==r||t==s?qn:oh,e==l&&t==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Ft:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?qn:Ft}r=s}this.dirty=qn}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?qn:oh;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}},Ig=class extends es{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==ft&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}},Ik=class extends es{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}},vl=class $u extends es{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=gi.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new $u(e,t,s.dom,s.contentDOM||s.dom)}parseRule(){return this.dirty&Ft||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Ft&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=ft){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=ft}}slice(e,t,r){let i=$u.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=Ju(o,t,s,r)),e>0&&(o=Ju(o,0,e,r));for(let l=0;l<o.length;l++)o[l].parent=i;return i.children=o,i}},Br=class zg extends es{constructor(e,t,r,i,o,s,l,a,u){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,t,r,i,o,s){let l=o.nodeViews[t.type.name],a,u=l&&l(t,o,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},r,i),c=u&&u.dom,f=u&&u.contentDOM;if(t.isText){if(!c)c=document.createTextNode(t.text);else if(c.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else c||({dom:c,contentDOM:f}=gi.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!f&&!t.isText&&c.nodeName!="BR"&&(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let d=c;return c=Bg(c,r,t),u?a=new zk(e,t,r,i,c,f||null,d,u,o,s+1):t.isText?new Pg(e,t,r,i,c,d,o):new zg(e,t,r,i,c,f||null,d,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>C.empty)}return e}matchesNode(e,t,r){return this.dirty==ft&&e.eq(this.node)&&Bu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,l=o&&o.pos<0,a=new Fk(this,s&&s.node,e);Vk(this.node,this.innerDeco,(u,c,f)=>{u.spec.marks?a.syncToMarks(u.spec.marks,r,e):u.type.side>=0&&!f&&a.syncToMarks(c==this.node.childCount?W.none:this.node.child(c).marks,r,e),a.placeWidget(u,e,i)},(u,c,f,d)=>{a.syncToMarks(u.marks,r,e);let p;a.findNodeMatch(u,c,f,d)||l&&e.state.selection.from>i&&e.state.selection.to<i+u.nodeSize&&(p=a.findIndexWithChild(o.node))>-1&&a.updateNodeAt(u,c,f,p,e)||a.updateNextNode(u,c,f,e,d,i)||a.addNode(u,c,f,e,i),i+=u.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==qn)&&(s&&this.protectLocalComposition(e,s),$g(this.contentDOM,this.children,e),ti&&Bk(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof $)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,l=Jk(this.node.content,s,r-t,i-t);return l<0?null:{node:o,pos:l,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new Ik(this,o,t,i);e.input.compositionNodes.push(s),this.children=Ju(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==Ft||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=ft}updateOuterDeco(e){if(Bu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=Vg(this.dom,this.nodeDOM,Vu(this.outerDeco,this.node,t),Vu(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}};function sh(n,e,t,r,i){Bg(r,e,n);let o=new Br(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}let Pg=class Fg extends Br{constructor(e,t,r,i,o,s,l){super(e,t,r,i,o,null,s,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==Ft||this.dirty!=ft&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=ft||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=ft,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new Fg(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Ft)}get domAtom(){return!1}isText(e){return this.node.text==e}},Lg=class extends es{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==ft&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}};class zk extends Br{constructor(e,t,r,i,o,s,l,a,u,c){super(e,t,r,i,o,s,l,u,c),this.spec=a}update(e,t,r,i){if(this.dirty==Ft)return!1;if(this.spec.update){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function $g(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],l=s.dom;if(l.parentNode==n){for(;l!=r;)r=lh(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(s instanceof vl){let a=r?r.previousSibling:n.lastChild;$g(s.contentDOM,s.children,t),r=a?a.nextSibling:n.firstChild}}for(;r;)r=lh(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const ro=function(n){n&&(this.nodeName=n)};ro.prototype=Object.create(null);const Qn=[new ro];function Vu(n,e,t){if(n.length==0)return Qn;let r=t?Qn[0]:new ro,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new ro(s.nodeName));for(let l in s){let a=s[l];a!=null&&(t&&i.length==1&&i.push(r=new ro(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function Vg(n,e,t,r){if(t==Qn&&r==Qn)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],l=t[o];if(o){let a;l&&l.nodeName==s.nodeName&&i!=n&&(a=i.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=Qn[0]),i=a}Pk(i,l||Qn[0],s)}return i}function Pk(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function Bg(n,e,t){return Vg(n,n,Qn,Vu(e,t,n.nodeType!=1))}function Bu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function lh(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class Fk{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Lk(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=ft,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let u=this.top.children[a];if(u.matchesMark(e[o])&&!this.isLocked(u.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=vl.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let u=this.top.children[l];if(u.matchesNode(e,t,r)&&!this.preMatch.matched.has(u)){o=l;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==Ft&&s.dom==s.contentDOM&&(s.dirty=qn),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Br){let u=this.preMatch.matched.get(a);if(u!=null&&u!=o)return!1;let c=a.dom,f,d=this.isLocked(c)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=Ft&&Bu(t,a.outerDeco));if(!d&&a.update(e,t,r,i))return this.destroyBetween(this.index,l),a.dom!=c&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(a,e,t,r,i,s)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=qn,f.updateChildren(i,s+1),f.dirty=ft),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let l=Br.create(this.top,t,r,i,o,s);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,r,i,o){let s=Br.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new Ig(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof vl;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Pg)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((be||Me)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Lg(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Lk(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let l;for(;;)if(r){let u=t.children[r-1];if(u instanceof vl)t=u,r=u.children.length;else{l=u,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=n.child(i-1))break;--i,o.set(l,i),s.push(l)}}return{index:i,matched:o,matches:s.reverse()}}function $k(n,e){return n.type.side-e.type.side}function Vk(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let u=0;u<n.childCount;u++){let c=n.child(u);r(c,i,e.forChild(o,c),u),o+=c.nodeSize}return}let s=0,l=[],a=null;for(let u=0;;){let c,f;for(;s<i.length&&i[s].to==o;){let w=i[s++];w.widget&&(c?(f||(f=[c])).push(w):c=w)}if(c)if(f){f.sort($k);for(let w=0;w<f.length;w++)t(f[w],u,!!a)}else t(c,u,!!a);let d,p;if(a)p=-1,d=a,a=null;else if(u<n.childCount)p=u,d=n.child(u++);else break;for(let w=0;w<l.length;w++)l[w].to<=o&&l.splice(w--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let h=o+d.nodeSize;if(d.isText){let w=h;s<i.length&&i[s].from<w&&(w=i[s].from);for(let g=0;g<l.length;g++)l[g].to<w&&(w=l[g].to);w<h&&(a=d.cut(w-o),d=d.cut(0,w-o),h=w,p=-1)}else for(;s<i.length&&i[s].to<h;)s++;let m=d.isInline&&!d.isLeaf?l.filter(w=>!w.inline):l.slice();r(d,m,e.forChild(o,d),p),o=h}}function Bk(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function Jk(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),l=o;if(o+=s.nodeSize,!s.isText)continue;let a=s.text;for(;i<n.childCount;){let u=n.child(i++);if(o+=u.nodeSize,!u.isText)break;a+=u.text}if(o>=t){if(o>=r&&a.slice(r-e.length-l,r-l)==e)return r-e.length;let u=l<r?a.lastIndexOf(e,r-l-1):-1;if(u>=0&&u+e.length+l>=t)return l+u;if(t==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Ju(n,e,t,r,i){let o=[];for(let s=0,l=0;s<n.length;s++){let a=n[s],u=l,c=l+=a.size;u>=t||c<=e?o.push(a):(u<e&&o.push(a.slice(0,e-u,r)),i&&(o.push(i),i=void 0),c>t&&o.push(a.slice(t-u,a.size,r)))}return o}function mf(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(ta(t)){for(a=l;i&&!i.node;)i=i.parent;let c=i.node;if(i&&c.isAtom&&I.isSelectable(c)&&i.parent&&!(c.isInline&&hk(t.focusNode,t.focusOffset,i.dom))){let f=i.posBefore;u=new I(s==f?l:r.resolve(f))}}else{let c=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(c<0)return null;a=r.resolve(c)}if(!u){let c=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=gf(n,a,l,c)}return u}function Jg(n){return n.editable?n.hasFocus():Wg(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function qt(n,e=!1){let t=n.state.selection;if(_g(n,t),!!Jg(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Me){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&sr(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Wk(n);else{let{anchor:r,head:i}=t,o,s;ah&&!(t instanceof $)&&(t.$from.parent.inlineContent||(o=uh(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=uh(n,t.to))),n.docView.setSelection(r,i,n.root,e),ah&&(o&&ch(o),s&&ch(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&_k(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const ah=be||Me&&Eg<63;function uh(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(be&&i&&i.contentEditable=="false")return La(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return La(i);if(o)return La(o)}}function La(n){return n.contentEditable="true",be&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function ch(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function _k(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!Jg(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Wk(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setStart(r.parentNode,ye(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&We&&Sn<=11&&(r.disabled=!0,r.disabled=!1)}function _g(n,e){if(e instanceof I){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(fh(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else fh(n)}function fh(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function gf(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function dh(n){return n.editable&&!n.hasFocus()?!1:Wg(n)}function Wg(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function Uk(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return sr(e.node,e.offset,t.anchorNode,t.anchorOffset)}function _u(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&P.findFrom(o,e)}function rn(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function hh(n,e,t){let r=n.state.selection;if(r instanceof $)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return rn(n,new $(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=_u(n.state,e);return i&&i instanceof I?rn(n,i):!1}else if(!(ot&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let l=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(l))&&!s.contentDOM?I.isSelectable(o)?rn(n,new I(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):Zo?rn(n,new $(n.state.doc.resolve(e<0?l:l+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof I&&r.node.isInline)return rn(n,new $(e>0?r.$to:r.$from));{let i=_u(n.state,e);return i?rn(n,i):!1}}}function xl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function io(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function wr(n,e){return e<0?Hk(n):jk(n)}function Hk(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(Ct&&t.nodeType==1&&r<xl(t)&&io(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(io(l,-1))i=t,o=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(Ug(t))break;{let l=t.previousSibling;for(;l&&io(l,-1);)i=t.parentNode,o=ye(l),l=l.previousSibling;if(l)t=l,r=xl(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Wu(n,t,r):i&&Wu(n,i,o)}function jk(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=xl(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(io(l,1))o=t,s=++r;else break}else{if(Ug(t))break;{let l=t.nextSibling;for(;l&&io(l,1);)o=l.parentNode,s=ye(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=xl(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Wu(n,o,s)}function Ug(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function Kk(n,e){for(;n&&e==n.childNodes.length&&!Xo(n);)e=ye(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function qk(n,e){for(;n&&!e&&!Xo(n);)e=ye(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Wu(n,e,t){if(e.nodeType!=3){let o,s;(s=Kk(e,t))?(e=s,t=0):(o=qk(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(ta(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&qt(n)},50)}function ph(n,e){let t=n.state.doc.resolve(e);if(!(Me||gk)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function mh(n,e,t){let r=n.state.selection;if(r instanceof $&&!r.empty||t.indexOf("s")>-1||ot&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=_u(n.state,e);if(s&&s instanceof I)return rn(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,l=r instanceof et?P.near(s,e):P.findFrom(s,e);return l?rn(n,l):!1}return!1}function gh(n,e){if(!(n.state.selection instanceof $))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function yh(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Qk(n){if(!be||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;yh(n,r,"true"),setTimeout(()=>yh(n,r,"false"),20)}return!1}function Yk(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function Gk(n,e){let t=e.keyCode,r=Yk(e);if(t==8||ot&&t==72&&r=="c")return gh(n,-1)||wr(n,-1);if(t==46&&!e.shiftKey||ot&&t==68&&r=="c")return gh(n,1)||wr(n,1);if(t==13||t==27)return!0;if(t==37||ot&&t==66&&r=="c"){let i=t==37?ph(n,n.state.selection.from)=="ltr"?-1:1:-1;return hh(n,i,r)||wr(n,i)}else if(t==39||ot&&t==70&&r=="c"){let i=t==39?ph(n,n.state.selection.from)=="ltr"?1:-1:1;return hh(n,i,r)||wr(n,i)}else{if(t==38||ot&&t==80&&r=="c")return mh(n,-1,r)||wr(n,-1);if(t==40||ot&&t==78&&r=="c")return Qk(n)||mh(n,1,r)||wr(n,1);if(r==(ot?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Hg(n,e){n.someProp("transformCopied",p=>{e=p(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let p=r.firstChild;t.push(p.type.name,p.attrs!=p.type.defaultAttrs?p.attrs:null),r=p.content}let s=n.someProp("clipboardSerializer")||gi.fromSchema(n.state.schema),l=Gg(),a=l.createElement("div");a.appendChild(s.serializeFragment(r,{document:l}));let u=a.firstChild,c,f=0;for(;u&&u.nodeType==1&&(c=Yg[u.nodeName.toLowerCase()]);){for(let p=c.length-1;p>=0;p--){let h=l.createElement(c[p]);for(;a.firstChild;)h.appendChild(a.firstChild);a.appendChild(h),f++}u=a.firstChild}u&&u.nodeType==1&&u.setAttribute("data-pm-slice",`${i} ${o}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",p=>p(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:d,slice:e}}function jg(n,e,t,r,i){let o=i.parent.type.spec.code,s,l;if(!t&&!e)return null;let a=e&&(r||o||!t);if(a){if(n.someProp("transformPastedText",d=>{e=d(e,o||r,n)}),o)return e?new v(C.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):v.empty;let f=n.someProp("clipboardTextParser",d=>d(e,i,r,n));if(f)l=f;else{let d=i.marks(),{schema:p}=n.state,h=gi.fromSchema(p);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let w=s.appendChild(document.createElement("p"));m&&w.appendChild(h.serializeNode(p.text(m,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),s=tv(t),Zo&&nv(s);let u=s&&s.querySelector("[data-pm-slice]"),c=u&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(u.getAttribute("data-pm-slice")||"");if(c&&c[3])for(let f=+c[3];f>0;f--){let d=s.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;s=d}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||yo.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||c),context:i,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!Xk.test(d.parentNode.nodeName)?{ignore:!0}:null}})),c)l=rv(Sh(l,+c[1],+c[2]),c[4]);else if(l=v.maxOpen(Zk(l.content,i),!0),l.openStart||l.openEnd){let f=0,d=0;for(let p=l.content.firstChild;f<l.openStart&&!p.type.spec.isolating;f++,p=p.firstChild);for(let p=l.content.lastChild;d<l.openEnd&&!p.type.spec.isolating;d++,p=p.lastChild);l=Sh(l,f,d)}return n.someProp("transformPasted",f=>{l=f(l,n)}),l}const Xk=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Zk(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(l=>{if(!s)return;let a=i.findWrapping(l.type),u;if(!a)return s=null;if(u=s.length&&o.length&&qg(a,o,l,s[s.length-1],0))s[s.length-1]=u;else{s.length&&(s[s.length-1]=Qg(s[s.length-1],o.length));let c=Kg(l,a);s.push(c),i=i.matchType(c.type),o=a}}),s)return C.from(s)}return n}function Kg(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,C.from(n));return n}function qg(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=qg(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(C.from(Kg(t,n,i+1))))}}function Qg(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,Qg(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(C.empty,!0);return n.copy(t.append(r))}function Uu(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,l=s.content;return n.childCount>1&&(o=0),i<r-1&&(l=Uu(l,e,t,r,i+1,o)),i>=t&&(l=e<0?s.contentMatchAt(0).fillBefore(l,o<=i).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(C.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(l))}function Sh(n,e,t){return e<n.openStart&&(n=new v(Uu(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new v(Uu(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Yg={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let wh=null;function Gg(){return wh||(wh=document.implementation.createHTMLDocument("title"))}function ev(n){let e=window.trustedTypes;return e?e.createPolicy("detachedDocument",{createHTML:t=>t}).createHTML(n):n}function tv(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=Gg().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&Yg[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=ev(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function nv(n){let e=n.querySelectorAll(Me?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function rv(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=C.from(a.create(r[l+1],i)),o++,s++}return new v(i,o,s)}const Ie={},ze={},iv={touchstart:!0,touchmove:!0};class ov{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function sv(n){for(let e in Ie){let t=Ie[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{av(n,r)&&!yf(n,r)&&(n.editable||!(r.type in ze))&&t(n,r)},iv[e]?{passive:!0}:void 0)}be&&n.dom.addEventListener("input",()=>null),Hu(n)}function hn(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function lv(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Hu(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>yf(n,r))})}function yf(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function av(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function uv(n,e){!yf(n,e)&&Ie[e.type]&&(n.editable||!(e.type in ze))&&Ie[e.type](n,e)}ze.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Zg(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(wt&&Me&&t.keyCode==13)))if(n.domObserver.selectionChanged(n.domSelectionRange())?n.domObserver.flush():t.keyCode!=229&&n.domObserver.forceFlush(),ti&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,Kn(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||Gk(n,t)?t.preventDefault():hn(n,"key")};ze.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};ze.keypress=(n,e)=>{let t=e;if(Zg(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||ot&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof $)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function na(n){return{left:n.clientX,top:n.clientY}}function cv(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Sf(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,l=>s>o.depth?l(n,t,o.nodeAfter,o.before(s),i,!0):l(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function Jr(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function fv(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&I.isSelectable(r)?(Jr(n,new I(t)),!0):!1}function dv(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof I&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let l=s>o.depth?o.nodeAfter:o.node(s);if(I.isSelectable(l)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(Jr(n,I.create(n.state.doc,i)),!0):!1}function hv(n,e,t,r,i){return Sf(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?dv(n,t):fv(n,t))}function pv(n,e,t,r){return Sf(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function mv(n,e,t,r){return Sf(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||gv(n,t,r)}function gv(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Jr(n,$.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),l=i.before(o);if(s.inlineContent)Jr(n,$.create(r,l+1,l+1+s.content.size));else if(I.isSelectable(s))Jr(n,I.create(r,l));else continue;return!0}}function wf(n){return Cl(n)}const Xg=ot?"metaKey":"ctrlKey";Ie.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=wf(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&cv(t,n.input.lastClick)&&!t[Xg]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(na(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new yv(n,s,t,!!r)):(o=="doubleClick"?pv:mv)(n,s.pos,s.inside,t)?t.preventDefault():hn(n,"pointer"))};class yv{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Xg],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let c=e.state.doc.resolve(t.pos);o=c.parent,s=c.depth?c.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:u}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||u instanceof I&&u.from<=s&&u.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Ct&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),hn(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>qt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(na(e))),this.updateAllowDefault(e),this.allowDefault||!t?hn(this.view,"pointer"):hv(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||be&&this.mightDrag&&!this.mightDrag.node.isAtom||Me&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Jr(this.view,P.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):hn(this.view,"pointer")}move(e){this.updateAllowDefault(e),hn(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ie.touchstart=n=>{n.input.lastTouch=Date.now(),wf(n),hn(n,"pointer")};Ie.touchmove=n=>{n.input.lastTouch=Date.now(),hn(n,"pointer")};Ie.contextmenu=n=>wf(n);function Zg(n,e){return n.composing?!0:be&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const Sv=wt?5e3:-1;ze.compositionstart=ze.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof $&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Cl(n,!0),n.markCursor=null;else if(Cl(n,!e.selection.empty),Ct&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let l=n.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}ey(n,Sv)};ze.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,ey(n,20))};function ey(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Cl(n),e))}function ty(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=kv());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function wv(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=fk(e.focusNode,e.focusOffset),r=dk(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function kv(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Cl(n,e=!1){if(!(wt&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),ty(n),e||n.docView&&n.docView.dirty){let t=mf(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function vv(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const vo=We&&Sn<15||ti&&yk<604;Ie.copy=ze.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=vo?null:t.clipboardData,s=r.content(),{dom:l,text:a}=Hg(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",l.innerHTML),o.setData("text/plain",a)):vv(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function xv(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function Cv(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?xo(n,r.value,null,i,e):xo(n,r.textContent,r.innerHTML,i,e)},50)}function xo(n,e,t,r,i){let o=jg(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,o||v.empty)))return!0;if(!o)return!1;let s=xv(o),l=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ny(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}ze.paste=(n,e)=>{let t=e;if(n.composing&&!wt)return;let r=vo?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&xo(n,ny(r),r.getData("text/html"),i,t)?t.preventDefault():Cv(n,t)};class ry{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const iy=ot?"altKey":"ctrlKey";Ie.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(na(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof I?i.to-1:i.to))){if(r&&r.mightDrag)s=I.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(s=I.create(n.state.doc,f.posBefore))}}let l=(s||n.state.selection).content(),{dom:a,text:u,slice:c}=Hg(n,l);(!t.dataTransfer.files.length||!Me||Eg>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(vo?"Text":"text/html",a.innerHTML),t.dataTransfer.effectAllowed="copyMove",vo||t.dataTransfer.setData("text/plain",u),n.dragging=new ry(c,!t[iy],s)};Ie.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};ze.dragover=ze.dragenter=(n,e)=>e.preventDefault();ze.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(na(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",h=>{s=h(s,n)}):s=jg(n,ny(t.dataTransfer),vo?null:t.dataTransfer.getData("text/html"),!1,o);let l=!!(r&&!t[iy]);if(n.someProp("handleDrop",h=>h(n,t,s||v.empty,l))){t.preventDefault();return}if(!s)return;t.preventDefault();let a=s?lk(n.state.doc,o.pos,s):o.pos;a==null&&(a=o.pos);let u=n.state.tr;if(l){let{node:h}=r;h?h.replace(u):u.deleteSelection()}let c=u.mapping.map(a),f=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,d=u.doc;if(f?u.replaceRangeWith(c,c,s.content.firstChild):u.replaceRange(c,c,s),u.doc.eq(d))return;let p=u.doc.resolve(c);if(f&&I.isSelectable(s.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(s.content.firstChild))u.setSelection(new I(p));else{let h=u.mapping.map(a);u.mapping.maps[u.mapping.maps.length-1].forEach((m,w,g,y)=>h=y),u.setSelection(gf(n,p,u.doc.resolve(h)))}n.focus(),n.dispatch(u.setMeta("uiEvent","drop"))};Ie.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&qt(n)},20))};Ie.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ie.beforeinput=(n,e)=>{if(Me&&wt&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,Kn(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in ze)Ie[n]=ze[n];function Co(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Nl{constructor(e,t){this.toDOM=e,this.spec=t||tr,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new Se(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Nl&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Co(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class wn{constructor(e,t){this.attrs=e,this.spec=t||tr}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new Se(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof wn&&Co(this.attrs,e.attrs)&&Co(this.spec,e.spec)}static is(e){return e.type instanceof wn}destroy(){}}class kf{constructor(e,t){this.attrs=e,this.spec=t||tr}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new Se(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof kf&&Co(this.attrs,e.attrs)&&Co(this.spec,e.spec)}destroy(){}}class Se{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Se(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Se(e,e,new Nl(t,r))}static inline(e,t,r,i){return new Se(e,t,new wn(r,i))}static node(e,t,r,i){return new Se(e,t,new kf(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof wn}get widget(){return this.type instanceof Nl}}const Mr=[],tr={};class _{constructor(e,t){this.local=e.length?e:Mr,this.children=t.length?t:Mr}static create(e,t){return t.length?Ml(t,e,0,tr):Ce}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=t&&l.to>=e&&(!o||o(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let l=this.children[s]+1;this.children[s+2].findInner(e-l,t-l,r,i+l,o)}}map(e,t,r){return this==Ce||e.maps.length==0?this:this.mapInner(e,t,0,0,r||tr)}mapInner(e,t,r,i,o){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(s||(s=[])).push(a):o.onRemove&&o.onRemove(this.local[l].spec)}return this.children.length?Nv(this.children,s||[],e,t,r,i,o):s?new _(s.sort(nr),Mr):Ce}add(e,t){return t.length?this==Ce?_.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((l,a)=>{let u=a+r,c;if(c=ly(t,l,u)){for(i||(i=this.children.slice());o<i.length&&i[o]<a;)o+=3;i[o]==a?i[o+2]=i[o+2].addInner(l,c,u+1):i.splice(o,0,a,a+l.nodeSize,Ml(c,l,u+1,tr)),o+=3}});let s=sy(o?ay(t):t,-r);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||s.splice(l--,1);return new _(s.length?this.local.concat(s).sort(nr):this.local,i||this.children)}remove(e){return e.length==0||this==Ce?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,l=r[o]+t,a=r[o+1]+t;for(let c=0,f;c<e.length;c++)(f=e[c])&&f.from>l&&f.to<a&&(e[c]=null,(s||(s=[])).push(f));if(!s)continue;r==this.children&&(r=this.children.slice());let u=r[o+2].removeInner(s,l+1);u!=Ce?r[o+2]=u:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let l=0;l<i.length;l++)i[l].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new _(i,r):Ce}forChild(e,t){if(this==Ce)return this;if(t.isLeaf)return _.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let o=e+1,s=o+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>o&&a.type instanceof wn){let u=Math.max(o,a.from)-o,c=Math.min(s,a.to)-o;u<c&&(i||(i=[])).push(a.copy(u,c))}}if(i){let l=new _(i.sort(nr),Mr);return r?new oy([l,r]):l}return r||Ce}eq(e){if(this==e)return!0;if(!(e instanceof _)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return vf(this.localsInner(e))}localsInner(e){if(this==Ce)return Mr;if(e.inlineContent||!this.local.some(wn.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof wn||t.push(this.local[r]);return t}forEachSet(e){e(this)}}_.empty=new _([],[]);_.removeOverlap=vf;const Ce=_.empty;let oy=class Er{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,tr));return Er.from(r)}forChild(e,t){if(t.isLeaf)return _.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Ce&&(o instanceof Er?r=r.concat(o.members):r.push(o))}return Er.from(r)}eq(e){if(!(e instanceof Er)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?vf(r?t:t.sort(nr)):Mr}static from(e){switch(e.length){case 0:return Ce;case 1:return e[0];default:return new Er(e.every(t=>t instanceof _)?e:e.reduce((t,r)=>t.concat(r instanceof _?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}};function Nv(n,e,t,r,i,o,s){let l=n.slice();for(let u=0,c=o;u<t.maps.length;u++){let f=0;t.maps[u].forEach((d,p,h,m)=>{let w=m-h-(p-d);for(let g=0;g<l.length;g+=3){let y=l[g+1];if(y<0||d>y+c-f)continue;let S=l[g]+c-f;p>=S?l[g+1]=d<=S?-2:-1:d>=c&&w&&(l[g]+=w,l[g+1]+=w)}f+=w}),c=t.maps[u].map(c,-1)}let a=!1;for(let u=0;u<l.length;u+=3)if(l[u+1]<0){if(l[u+1]==-2){a=!0,l[u+1]=-1;continue}let c=t.map(n[u]+o),f=c-i;if(f<0||f>=r.content.size){a=!0;continue}let d=t.map(n[u+1]+o,-1),p=d-i,{index:h,offset:m}=r.content.findIndex(f),w=r.maybeChild(h);if(w&&m==f&&m+w.nodeSize==p){let g=l[u+2].mapInner(t,w,c+1,n[u]+o+1,s);g!=Ce?(l[u]=f,l[u+1]=p,l[u+2]=g):(l[u+1]=-2,a=!0)}else a=!0}if(a){let u=Mv(l,n,e,t,i,o,s),c=Ml(u,r,0,s);e=c.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,d=0;f<c.children.length;f+=3){let p=c.children[f];for(;d<l.length&&l[d]<p;)d+=3;l.splice(d,0,c.children[f],c.children[f+1],c.children[f+2])}}return new _(e.sort(nr),l)}function sy(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new Se(i.from+e,i.to+e,i.type))}return t}function Mv(n,e,t,r,i,o,s){function l(a,u){for(let c=0;c<a.local.length;c++){let f=a.local[c].map(r,i,u);f?t.push(f):s.onRemove&&s.onRemove(a.local[c].spec)}for(let c=0;c<a.children.length;c+=3)l(a.children[c+2],a.children[c]+u+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+o+1);return t}function ly(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function ay(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Ml(n,e,t,r){let i=[],o=!1;e.forEach((l,a)=>{let u=ly(n,l,a+t);if(u){o=!0;let c=Ml(u,l,t+a+1,r);c!=Ce&&i.push(a,a+l.nodeSize,c)}});let s=sy(o?ay(n):n,-t).sort(nr);for(let l=0;l<s.length;l++)s[l].type.valid(e,s[l])||(r.onRemove&&r.onRemove(s[l].spec),s.splice(l--,1));return s.length||i.length?new _(s,i):Ce}function nr(n,e){return n.from-e.from||n.to-e.to}function vf(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),kh(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),kh(e,i,r.copy(o.from,r.to)));break}}}return e}function kh(n,e,t){for(;e<n.length&&nr(t,n[e])>0;)e++;n.splice(e,0,t)}function $a(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Ce&&e.push(r)}),n.cursorWrapper&&e.push(_.create(n.state.doc,[n.cursorWrapper.deco])),oy.from(e)}const Ev={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Ov=We&&Sn<=11;let Tv=class{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}};class Dv{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Tv,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);We&&Sn<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Ov&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Ev)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(dh(this.view)){if(this.suppressingSelectionUpdates)return qt(this.view);if(We&&Sn<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&sr(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=ko(o))t.add(o);for(let o=e.anchorNode;o;o=ko(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}selectionChanged(e){return!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&dh(this.view)&&!this.ignoreSelectionChange(e)}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=this.selectionChanged(r),o=-1,s=-1,l=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let f=this.registerMutation(t[c],a);f&&(o=o<0?f.from:Math.min(f.from,o),s=s<0?f.to:Math.max(f.to,s),f.typeOver&&(l=!0))}if(Ct&&a.length){let c=a.filter(f=>f.nodeName=="BR");if(c.length==2){let[f,d]=c;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of c){let p=d.parentNode;p&&p.nodeName=="LI"&&(!f||bv(e,f)!=p)&&d.remove()}}}let u=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&ta(r)&&(u=mf(e))&&u.eq(P.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,qt(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),Rv(e)),this.handleDOMChange(o,s,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||qt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let c=0;c<e.addedNodes.length;c++){let f=e.addedNodes[c];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(We&&Sn<=11&&e.addedNodes.length)for(let c=0;c<e.addedNodes.length;c++){let{previousSibling:f,nextSibling:d}=e.addedNodes[c];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d)}let s=i&&i.parentNode==e.target?ye(i)+1:0,l=r.localPosFromDOM(e.target,s,-1),a=o&&o.parentNode==e.target?ye(o):e.target.childNodes.length,u=r.localPosFromDOM(e.target,a,1);return{from:l,to:u}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let vh=new WeakMap,xh=!1;function Rv(n){if(!vh.has(n)&&(vh.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Ct,xh)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),xh=!0}}function Ch(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return sr(s.node,s.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function Av(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return Ch(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?Ch(n,t):null}function bv(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function Iv(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:l}=n.docView.parseRange(e,t),a=n.domSelectionRange(),u,c=a.anchorNode;if(c&&n.dom.contains(c.nodeType==1?c:c.parentNode)&&(u=[{node:c,offset:a.anchorOffset}],ta(a)||u.push({node:a.focusNode,offset:a.focusOffset})),Me&&n.input.lastKeyCode===8)for(let w=o;w>i;w--){let g=r.childNodes[w-1],y=g.pmViewDesc;if(g.nodeName=="BR"&&!y){o=w;break}if(!y||y.size)break}let f=n.state.doc,d=n.someProp("domParser")||yo.fromSchema(n.state.schema),p=f.resolve(s),h=null,m=d.parse(r,{topNode:p.parent,topMatch:p.parent.contentMatchAt(p.index()),topOpen:!0,from:i,to:o,preserveWhitespace:p.parent.type.whitespace=="pre"?"full":!0,findPositions:u,ruleFromNode:zv,context:p});if(u&&u[0].pos!=null){let w=u[0].pos,g=u[1]&&u[1].pos;g==null&&(g=w),h={anchor:w+s,head:g+s}}return{doc:m,sel:h,from:s,to:l}}function zv(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(be&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||be&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Pv=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Fv(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let b=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,z=mf(n,b);if(z&&!n.state.selection.eq(z)){if(Me&&wt&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Mt=>Mt(n,Kn(13,"Enter"))))return;let ae=n.state.tr.setSelection(z);b=="pointer"?ae.setMeta("pointer",!0):b=="key"&&ae.scrollIntoView(),o&&ae.setMeta("composition",o),n.dispatch(ae)}return}let s=n.state.doc.resolve(e),l=s.sharedDepth(t);e=s.before(l+1),t=n.state.doc.resolve(t).after(l+1);let a=n.state.selection,u=Iv(n,e,t),c=n.state.doc,f=c.slice(u.from,u.to),d,p;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,p="end"):(d=n.state.selection.from,p="start"),n.input.lastKeyCode=null;let h=Vv(f.content,u.doc.content,u.from,d,p);if(h&&n.input.domChangeCount++,(ti&&n.input.lastIOSEnter>Date.now()-225||wt)&&i.some(b=>b.nodeType==1&&!Pv.test(b.nodeName))&&(!h||h.endA>=h.endB)&&n.someProp("handleKeyDown",b=>b(n,Kn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!h)if(r&&a instanceof $&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(u.sel&&u.sel.anchor!=u.sel.head))h={start:a.from,endA:a.to,endB:a.to};else{if(u.sel){let b=Nh(n,n.state.doc,u.sel);if(b&&!b.eq(n.state.selection)){let z=n.state.tr.setSelection(b);o&&z.setMeta("composition",o),n.dispatch(z)}}return}n.state.selection.from<n.state.selection.to&&h.start==h.endB&&n.state.selection instanceof $&&(h.start>n.state.selection.from&&h.start<=n.state.selection.from+2&&n.state.selection.from>=u.from?h.start=n.state.selection.from:h.endA<n.state.selection.to&&h.endA>=n.state.selection.to-2&&n.state.selection.to<=u.to&&(h.endB+=n.state.selection.to-h.endA,h.endA=n.state.selection.to)),We&&Sn<=11&&h.endB==h.start+1&&h.endA==h.start&&h.start>u.from&&u.doc.textBetween(h.start-u.from-1,h.start-u.from+1)==" "&&(h.start--,h.endA--,h.endB--);let m=u.doc.resolveNoCache(h.start-u.from),w=u.doc.resolveNoCache(h.endB-u.from),g=c.resolve(h.start),y=m.sameParent(w)&&m.parent.inlineContent&&g.end()>=h.endA,S;if((ti&&n.input.lastIOSEnter>Date.now()-225&&(!y||i.some(b=>b.nodeName=="DIV"||b.nodeName=="P"))||!y&&m.pos<u.doc.content.size&&!m.sameParent(w)&&(S=P.findFrom(u.doc.resolve(m.pos+1),1,!0))&&S.head==w.pos)&&n.someProp("handleKeyDown",b=>b(n,Kn(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>h.start&&$v(c,h.start,h.endA,m,w)&&n.someProp("handleKeyDown",b=>b(n,Kn(8,"Backspace")))){wt&&Me&&n.domObserver.suppressSelectionUpdates();return}Me&&wt&&h.endB==h.start&&(n.input.lastAndroidDelete=Date.now()),wt&&!y&&m.start()!=w.start()&&w.parentOffset==0&&m.depth==w.depth&&u.sel&&u.sel.anchor==u.sel.head&&u.sel.head==h.endA&&(h.endB-=2,w=u.doc.resolveNoCache(h.endB-u.from),setTimeout(()=>{n.someProp("handleKeyDown",function(b){return b(n,Kn(13,"Enter"))})},20));let x=h.start,M=h.endA,N,O,T;if(y){if(m.pos==w.pos)We&&Sn<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>qt(n),20)),N=n.state.tr.delete(x,M),O=c.resolve(h.start).marksAcross(c.resolve(h.endA));else if(h.endA==h.endB&&(T=Lv(m.parent.content.cut(m.parentOffset,w.parentOffset),g.parent.content.cut(g.parentOffset,h.endA-g.start()))))N=n.state.tr,T.type=="add"?N.addMark(x,M,T.mark):N.removeMark(x,M,T.mark);else if(m.parent.child(m.index()).isText&&m.index()==w.index()-(w.textOffset?0:1)){let b=m.parent.textBetween(m.parentOffset,w.parentOffset);if(n.someProp("handleTextInput",z=>z(n,x,M,b)))return;N=n.state.tr.insertText(b,x,M)}}if(N||(N=n.state.tr.replace(x,M,u.doc.slice(h.start-u.from,h.endB-u.from))),u.sel){let b=Nh(n,N.doc,u.sel);b&&!(Me&&wt&&n.composing&&b.empty&&(h.start!=h.endB||n.input.lastAndroidDelete<Date.now()-100)&&(b.head==x||b.head==N.mapping.map(M)-1)||We&&b.empty&&b.head==x)&&N.setSelection(b)}O&&N.ensureMarks(O),o&&N.setMeta("composition",o),n.dispatch(N.scrollIntoView())}function Nh(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:gf(n,e.resolve(t.anchor),e.resolve(t.head))}function Lv(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,l,a;for(let c=0;c<r.length;c++)i=r[c].removeFromSet(i);for(let c=0;c<t.length;c++)o=t[c].removeFromSet(o);if(i.length==1&&o.length==0)l=i[0],s="add",a=c=>c.mark(l.addToSet(c.marks));else if(i.length==0&&o.length==1)l=o[0],s="remove",a=c=>c.mark(l.removeFromSet(c.marks));else return null;let u=[];for(let c=0;c<e.childCount;c++)u.push(a(e.child(c)));if(C.from(u).eq(n))return{mark:l,type:s}}function $v(n,e,t,r,i){if(t-e<=i.pos-r.pos||Va(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let l=o.nodeAfter;return l!=null&&t==e+l.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(Va(o,!0,!0));return!s.parent.isTextblock||s.pos>t||Va(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Va(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function Vv(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let a=Math.max(0,o-Math.min(s,l));r-=s+a-o}if(s<o&&n.size<e.size){let a=r<=o&&r>=s?o-r:0;o-=a,o&&o<e.size&&Mh(e.textBetween(o-1,o+1))&&(o+=a?1:-1),l=o+(l-s),s=o}else if(l<o){let a=r<=o&&r>=l?o-r:0;o-=a,o&&o<n.size&&Mh(n.textBetween(o-1,o+1))&&(o+=a?1:-1),s=o+(s-l),l=o}return{start:o,endA:s,endB:l}}function Mh(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class Bv{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new ov,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Rh),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Th(this),Oh(this),this.nodeViews=Dh(this),this.docView=sh(this.state.doc,Eh(this),$a(this),this.dom,this),this.domObserver=new Dv(this,(r,i,o,s)=>Fv(this,r,i,o,s)),this.domObserver.start(),sv(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Hu(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Rh),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(ty(this),s=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(l||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let p=Dh(this);_v(p,this.nodeViews)&&(this.nodeViews=p,o=!0)}(l||t.handleDOMEvents!=this._props.handleDOMEvents)&&Hu(this),this.editable=Th(this),Oh(this);let a=$a(this),u=Eh(this),c=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=o||!this.docView.matchesNode(e.doc,u,a);(f||!e.selection.eq(i.selection))&&(s=!0);let d=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&kk(this);if(s){this.domObserver.stop();let p=f&&(We||Me)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&Jv(i.selection,e.selection);if(f){let h=Me?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=wv(this)),(o||!this.docView.update(e.doc,u,a,this))&&(this.docView.updateOuterDeco(u),this.docView.destroy(),this.docView=sh(e.doc,u,a,this.dom,this)),h&&!this.trackWrites&&(p=!0)}p||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&Uk(this))?qt(this,p):(_g(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&vk(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof I){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&eh(this,t.getBoundingClientRect(),e)}else eh(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new ry(e.slice,e.move,i<0?void 0:I.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[e];if(l!=null&&(i=t?t(l):l))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let l=o[s].props[e];if(l!=null&&(i=t?t(l):l))return i}}hasFocus(){if(We){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&xk(this.dom),qt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return Ok(this,e)}coordsAtPos(e,t=1){return Ag(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return bk(this,t||this.state,e)}pasteHTML(e,t){return xo(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return xo(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(lv(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],$a(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,uk())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return uv(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?be&&this.root.nodeType===11&&pk(this.dom.ownerDocument)==this.dom&&Av(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Eh(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Se.node(0,n.state.doc.content.size,e)]}function Oh(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Se.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Th(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Jv(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Dh(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function _v(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function Rh(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}class Z extends P{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Z.valid(r)?new Z(r):P.near(r)}content(){return v.empty}eq(e){return e instanceof Z&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Z(e.resolve(t.pos))}getBookmark(){return new xf(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!Wv(e)||!Uv(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Z.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let l=e.node(s);if(t>0?e.indexAfter(s)<l.childCount:e.index(s)>0){o=l.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let a=e.doc.resolve(i);if(Z.valid(a))return a}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!I.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let l=e.doc.resolve(i);if(Z.valid(l))return l}return null}}}Z.prototype.visible=!1;Z.findFrom=Z.findGapCursorFrom;P.jsonID("gapcursor",Z);class xf{constructor(e){this.pos=e}map(e){return new xf(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Z.valid(t)?new Z(t):P.near(t)}}function Wv(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Uv(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Hv(){return new Vt({props:{decorations:Qv,createSelectionBetween(n,e,t){return e.pos==t.pos&&Z.valid(t)?new Z(t):null},handleClick:Kv,handleKeyDown:jv,handleDOMEvents:{beforeinput:qv}}})}const jv=nk({ArrowLeft:ms("horiz",-1),ArrowRight:ms("horiz",1),ArrowUp:ms("vert",-1),ArrowDown:ms("vert",1)});function ms(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,l=e>0?s.$to:s.$from,a=s.empty;if(s instanceof $){if(!o.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let u=Z.findGapCursorFrom(l,e,a);return u?(i&&i(r.tr.setSelection(new Z(u))),!0):!1}}function Kv(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Z.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&I.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Z(r))),!0)}function qv(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Z))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=C.empty;for(let s=r.length-1;s>=0;s--)i=C.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new v(i,0,0));return o.setSelection($.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function Qv(n){if(!(n.selection instanceof Z))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",_.create(n.doc,[Se.widget(n.selection.head,e,{key:"gapcursor"})])}const uy=65535,cy=Math.pow(2,16);function Yv(n,e){return n+e*cy}function Ah(n){return n&uy}function Gv(n){return(n-(n&uy))/cy}const fy=1,dy=2,Xs=4,hy=8;let bh=class{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&hy)>0}get deletedBefore(){return(this.delInfo&(fy|Xs))>0}get deletedAfter(){return(this.delInfo&(dy|Xs))>0}get deletedAcross(){return(this.delInfo&Xs)>0}},ni=class Or{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Or.empty)return Or.empty}recover(e){let t=0,r=Ah(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Gv(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:Yv(l/3,e-a),m=e==a?dy:e==f?fy:Xs;return(t<0?e!=a:e!=f)&&(m|=hy),new bh(p,m,h)}i+=c-u}return r?e+i:new bh(e+i,0,null)}touches(e,t){let r=0,i=Ah(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Or(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Or.empty:new Or(e<0?[0,-e,0]:[0,0,e])}};ni.empty=new ni([]);const Ba=Object.create(null);let Ye=class{getMap(){return ni.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Ba[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Ba)throw new RangeError("Duplicate use of step JSON ID "+e);return Ba[e]=t,t.prototype.jsonID=e,t}},Je=class Hi{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Hi(e,null)}static fail(e){return new Hi(null,e)}static fromReplace(e,t,r,i){try{return Hi.ok(e.replace(t,r,i))}catch(o){if(o instanceof Tn)return Hi.fail(o.message);throw o}}};function Cf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Cf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return C.fromArray(r)}let py=class ji extends Ye{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new v(Cf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Je.fromReplace(e,this.from,this.to,o)}invert(){return new my(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ji(t.pos,r.pos,this.mark)}merge(e){return e instanceof ji&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ji(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ji(t.from,t.to,e.markFromJSON(t.mark))}};Ye.jsonID("addMark",py);let my=class Ki extends Ye{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new v(Cf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Je.fromReplace(e,this.from,this.to,r)}invert(){return new py(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Ki(t.pos,r.pos,this.mark)}merge(e){return e instanceof Ki&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Ki(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Ki(t.from,t.to,e.markFromJSON(t.mark))}};Ye.jsonID("removeMark",my);let gy=class qi extends Ye{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Je.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Je.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new qi(this.pos,t.marks[i]);return new qi(this.pos,this.mark)}}return new yy(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new qi(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new qi(t.pos,e.markFromJSON(t.mark))}};Ye.jsonID("addNodeMark",gy);let yy=class ju extends Ye{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Je.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Je.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new gy(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ju(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ju(t.pos,e.markFromJSON(t.mark))}};Ye.jsonID("removeNodeMark",yy);let Xv=class Un extends Ye{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Ku(e,this.from,this.to)?Je.fail("Structure replace would overwrite content"):Je.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new ni([this.from,this.to-this.from,this.slice.size])}invert(e){return new Un(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Un(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Un)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?v.empty:new v(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Un(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?v.empty:new v(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Un(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Un(t.from,t.to,v.fromJSON(e,t.slice),!!t.structure)}};Ye.jsonID("replace",Xv);let Zv=class Zs extends Ye{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Ku(e,this.from,this.gapFrom)||Ku(e,this.gapTo,this.to)))return Je.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Je.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Je.fromReplace(e,this.from,this.to,r):Je.fail("Content does not fit in gap")}getMap(){return new ni([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new Zs(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new Zs(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Zs(t.from,t.to,t.gapFrom,t.gapTo,v.fromJSON(e,t.slice),t.insert,!!t.structure)}};Ye.jsonID("replaceAround",Zv);function Ku(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function ex(n,e,t=null,r=n){let i=tx(n,e),o=i&&nx(r,e);return o?i.map(Ih).concat({type:e,attrs:t}).concat(o.map(Ih)):null}function Ih(n){return{type:n,attrs:null}}function tx(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function nx(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let a=(s.length?s[s.length-1]:e).contentMatch;for(let u=r;a&&u<i;u++)a=a.matchType(t.child(u).type);return!a||!a.validEnd?null:s}function rx(n,e){let t=n.resolve(e),r=t.index();return ix(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function ix(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}let ox=class el extends Ye{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Je.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Je.fromReplace(e,this.pos,this.pos+1,new v(C.from(i),0,t.isLeaf?0:1))}getMap(){return ni.empty}invert(e){return new el(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new el(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new el(t.pos,t.attr,t.value)}};Ye.jsonID("attr",ox);let No=class extends Error{};No=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};No.prototype=Object.create(Error.prototype);No.prototype.constructor=No;No.prototype.name="TransformError";class hr{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?sx(t):t,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1}}function sx(n){return function(e,t,r,i){let o=n;if(t[1]){let s=t[0].lastIndexOf(t[1]);o+=t[0].slice(s+t[1].length),r+=s;let l=r-i;l>0&&(o=t[0].slice(s-l,s)+o,r=i)}return e.tr.insertText(o,r,i)}}const lx=500;function ax({rules:n}){let e=new Vt({state:{init(){return null},apply(t,r){let i=t.getMeta(this);return i||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,i,o){return zh(t,r,i,o,n,e)},handleDOMEvents:{compositionend:t=>{setTimeout(()=>{let{$cursor:r}=t.state.selection;r&&zh(t,r.pos,r.pos,"",n,e)})}}},isInputRules:!0});return e}function zh(n,e,t,r,i,o){if(n.composing)return!1;let s=n.state,l=s.doc.resolve(e),a=l.parent.textBetween(Math.max(0,l.parentOffset-lx),l.parentOffset,null,"")+r;for(let u=0;u<i.length;u++){let c=i[u];if(l.parent.type.spec.code){if(!c.inCode)continue}else if(c.inCode==="only")continue;let f=c.match.exec(a),d=f&&c.handler(s,f,e-(f[0].length-r.length),t);if(d)return c.undoable&&d.setMeta(o,{transform:d,from:e,to:t,text:r}),n.dispatch(d),!0}return!1}new hr(/--$/,"");new hr(/\.\.\.$/,"");new hr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"");new hr(/"$/,"");new hr(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"");new hr(/'$/,"");function ux(n,e,t=null,r){return new hr(n,(i,o,s,l)=>{let a=t instanceof Function?t(o):t,u=i.tr.delete(s,l),c=u.doc.resolve(s),f=c.blockRange(),d=f&&ex(f,e,a);if(!d)return null;u.wrap(f,d);let p=u.doc.resolve(s-1).nodeBefore;return p&&p.type==e&&rx(u.doc,s-1)&&!r&&u.join(s-1),u})}const cx=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function fx(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))cx?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function dx(n){let e=Object.create(null);for(let t in n)e[fx(t)]=n[t];return e}function Ja(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function hx(n){return new Vt({props:{handleKeyDown:px(n)}})}function px(n){let e=dx(n);return function(t,r){let i=df(r),o,s=e[Ja(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Ja(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=zt[r.keyCode])&&o!=i){let l=e[Ja(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const mx=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function gx(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))o=!0;else if(/^mod$/i.test(a))mx?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function yx(n){let e=Object.create(null);for(let t in n)e[gx(t)]=n[t];return e}function _a(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function Sx(n){let e=yx(n);return function(t,r){let i=df(r),o,s=e[_a(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[_a(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=zt[r.keyCode])&&o!=i){let l=e[_a(o,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const Sy=65535,wy=Math.pow(2,16);function wx(n,e){return n+e*wy}function Ph(n){return n&Sy}function kx(n){return(n-(n&Sy))/wy}const ky=1,vy=2,tl=4,xy=8;class qu{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&xy)>0}get deletedBefore(){return(this.delInfo&(ky|tl))>0}get deletedAfter(){return(this.delInfo&(vy|tl))>0}get deletedAcross(){return(this.delInfo&tl)>0}}class Xe{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Xe.empty)return Xe.empty}recover(e){let t=0,r=Ph(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+kx(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let u=this.ranges[l+o],c=this.ranges[l+s],f=a+u;if(e<=f){let d=u?e==a?-1:e==f?1:t:t,p=a+i+(d<0?0:c);if(r)return p;let h=e==(t<0?a:f)?null:wx(l/3,e-a),m=e==a?vy:e==f?ky:tl;return(t<0?e!=a:e!=f)&&(m|=xy),new qu(p,m,h)}i+=c-u}return r?e+i:new qu(e+i,0,null)}touches(e,t){let r=0,i=Ph(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let u=this.ranges[l+o],c=a+u;if(e<=c&&l==i*3)return!0;r+=this.ranges[l+s]-u}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],l=s-(this.inverted?o:0),a=s+(this.inverted?0:o),u=this.ranges[i+t],c=this.ranges[i+r];e(l,l+u,a,a+c),o+=c-u}}invert(){return new Xe(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Xe.empty:new Xe(e<0?[0,-e,0]:[0,0,e])}}Xe.empty=new Xe([]);class oo{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new oo(this.maps,this.mirror,e,t)}copy(){return new oo(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new oo;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this.maps[o],l=s.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(o);if(a!=null&&a>o&&a<this.to){o=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new qu(e,i,null)}}const Wa=Object.create(null);class Te{getMap(){return Xe.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Wa[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Wa)throw new RangeError("Duplicate use of step JSON ID "+e);return Wa[e]=t,t.prototype.jsonID=e,t}}class oe{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new oe(e,null)}static fail(e){return new oe(null,e)}static fromReplace(e,t,r,i){try{return oe.ok(e.replace(t,r,i))}catch(o){if(o instanceof Tn)return oe.fail(o.message);throw o}}}function Nf(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Nf(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return C.fromArray(r)}class pn extends Te{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new v(Nf(t.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return oe.fromReplace(e,this.from,this.to,o)}invert(){return new Dt(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new pn(t.pos,r.pos,this.mark)}merge(e){return e instanceof pn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new pn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new pn(t.from,t.to,e.markFromJSON(t.mark))}}Te.jsonID("addMark",pn);class Dt extends Te{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new v(Nf(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return oe.fromReplace(e,this.from,this.to,r)}invert(){return new pn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Dt(t.pos,r.pos,this.mark)}merge(e){return e instanceof Dt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Dt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Dt(t.from,t.to,e.markFromJSON(t.mark))}}Te.jsonID("removeMark",Dt);class mn extends Te{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return oe.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new mn(this.pos,t.marks[i]);return new mn(this.pos,this.mark)}}return new ri(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new mn(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new mn(t.pos,e.markFromJSON(t.mark))}}Te.jsonID("addNodeMark",mn);class ri extends Te{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return oe.fromReplace(e,this.pos,this.pos+1,new v(C.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new mn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ri(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ri(t.pos,e.markFromJSON(t.mark))}}Te.jsonID("removeNodeMark",ri);class Re extends Te{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Qu(e,this.from,this.to)?oe.fail("Structure replace would overwrite content"):oe.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Xe([this.from,this.to-this.from,this.slice.size])}invert(e){return new Re(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new Re(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof Re)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?v.empty:new v(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Re(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?v.empty:new v(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Re(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Re(t.from,t.to,v.fromJSON(e,t.slice),!!t.structure)}}Te.jsonID("replace",Re);class At extends Te{constructor(e,t,r,i,o,s,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=l}apply(e){if(this.structure&&(Qu(e,this.from,this.gapFrom)||Qu(e,this.gapTo,this.to)))return oe.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return oe.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?oe.fromReplace(e,this.from,this.to,r):oe.fail("Content does not fit in gap")}getMap(){return new Xe([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new At(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),o=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new At(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new At(t.from,t.to,t.gapFrom,t.gapTo,v.fromJSON(e,t.slice),t.insert,!!t.structure)}}Te.jsonID("replaceAround",At);function Qu(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function vx(n,e,t,r){let i=[],o=[],s,l;n.doc.nodesBetween(e,t,(a,u,c)=>{if(!a.isInline)return;let f=a.marks;if(!r.isInSet(f)&&c.type.allowsMarkType(r.type)){let d=Math.max(u,e),p=Math.min(u+a.nodeSize,t),h=r.addToSet(f);for(let m=0;m<f.length;m++)f[m].isInSet(h)||(s&&s.to==d&&s.mark.eq(f[m])?s.to=p:i.push(s=new Dt(d,p,f[m])));l&&l.to==d?l.to=p:o.push(l=new pn(d,p,r))}}),i.forEach(a=>n.step(a)),o.forEach(a=>n.step(a))}function xx(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,l)=>{if(!s.isInline)return;o++;let a=null;if(r instanceof Qo){let u=s.marks,c;for(;c=r.isInSet(u);)(a||(a=[])).push(c),u=c.removeFromSet(u)}else r?r.isInSet(s.marks)&&(a=[r]):a=s.marks;if(a&&a.length){let u=Math.min(l+s.nodeSize,t);for(let c=0;c<a.length;c++){let f=a[c],d;for(let p=0;p<i.length;p++){let h=i[p];h.step==o-1&&f.eq(i[p].style)&&(d=h)}d?(d.to=u,d.step=o):i.push({style:f,from:Math.max(l,e),to:u,step:o})}}}),i.forEach(s=>n.step(new Dt(s.from,s.to,s.style)))}function Cx(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),o=[],s=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),u=s+a.nodeSize,c=r.matchType(a.type);if(!c)o.push(new Re(s,u,v.empty));else{r=c;for(let f=0;f<a.marks.length;f++)t.allowsMarkType(a.marks[f].type)||n.step(new Dt(s,u,a.marks[f]));if(a.isText&&!t.spec.code){let f,d=/\r?\n|\r/g,p;for(;f=d.exec(a.text);)p||(p=new v(C.from(t.schema.text(" ",t.allowedMarks(a.marks))),0,0)),o.push(new Re(s+f.index,s+f.index+f[0].length,p))}}s=u}if(!r.validEnd){let l=r.fillBefore(C.empty,!0);n.replace(s,s,new v(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function Nx(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),l=i.after(o+1),a=s,u=l,c=C.empty,f=0;for(let h=o,m=!1;h>t;h--)m||r.index(h)>0?(m=!0,c=C.from(r.node(h).copy(c)),f++):a--;let d=C.empty,p=0;for(let h=o,m=!1;h>t;h--)m||i.after(h+1)<i.end(h)?(m=!0,d=C.from(i.node(h).copy(d)),p++):u++;n.step(new At(a,u,s,l,new v(c.append(d),f,p),c.size-f,!0))}function Mx(n,e,t){let r=C.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let l=t[s].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=C.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new At(i,o,i,o,new v(r,0,0),t.length,!0))}function Ex(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,l)=>{if(s.isTextblock&&!s.hasMarkup(r,i)&&Ox(n.doc,n.mapping.slice(o).map(l),r)){n.clearIncompatible(n.mapping.slice(o).map(l,1),r);let a=n.mapping.slice(o),u=a.map(l,1),c=a.map(l+s.nodeSize,1);return n.step(new At(u,c,u+1,c-1,new v(C.from(r.create(i,null,s.marks)),0,0),1,!0)),!1}})}function Ox(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function Tx(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new At(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new v(C.from(s),0,0),1,!0))}function Dx(n,e,t=1,r){let i=n.doc.resolve(e),o=C.empty,s=C.empty;for(let l=i.depth,a=i.depth-t,u=t-1;l>a;l--,u--){o=C.from(i.node(l).copy(o));let c=r&&r[u];s=C.from(c?c.type.create(c.attrs,s):i.node(l).copy(s))}n.step(new Re(e,e,new v(o.append(s),t,t),!0))}function Rx(n,e,t){let r=new Re(e-t,e+t,v.empty,!0);n.step(r)}function Ax(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function bx(n,e,t=e,r=v.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return Cy(i,o,r)?new Re(e,t,r):new Ix(i,o,r).fit()}function Cy(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Ix{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=C.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=C.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let u=this.findFittable();u?this.placeNodes(u):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,l=i.depth;for(;s&&l&&o.childCount==1;)o=o.firstChild.content,s--,l--;let a=new v(o,s,l);return e>-1?new At(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new Re(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=Ua(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:u}=this.frontier[l],c,f=null;if(t==1&&(s?u.matchType(s.type)||(f=u.fillBefore(C.from(s),!1)):o&&a.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:l,parent:o,inject:f};if(t==2&&s&&(c=u.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:l,parent:o,wrap:c};if(o&&u.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Ua(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new v(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=Ua(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new v(Qi(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new v(Qi(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,l=r?r.content:s.content,a=s.openStart-e,u=0,c=[],{match:f,type:d}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)c.push(i.child(m));f=f.matchFragment(i)}let p=l.size+e-(s.content.size-s.openEnd);for(;u<l.childCount;){let m=l.child(u),w=f.matchType(m.type);if(!w)break;u++,(u>1||a==0||m.content.size)&&(f=w,c.push(Ny(m.mark(d.allowedMarks(m.marks)),u==1?a:0,u==l.childCount?p:-1)))}let h=u==l.childCount;h||(p=-1),this.placed=Yi(this.placed,t,C.from(c)),this.frontier[t].match=f,h&&p<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,w=l;m<p;m++){let g=w.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),w=g.content}this.unplaced=h?e==0?v.empty:new v(Qi(s.content,e-1,1),e-1,p<0?s.openEnd:e-1):new v(Qi(s.content,e,u),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Ha(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Ha(e,t,i,r,o);if(s){for(let l=t-1;l>=0;l--){let{match:a,type:u}=this.frontier[l],c=Ha(e,l,u,a,!0);if(!c||c.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Yi(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Yi(this.placed,this.depth,C.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(C.empty,!0);t.childCount&&(this.placed=Yi(this.placed,this.frontier.length,t))}}function Qi(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Qi(n.firstChild.content,e-1,t)))}function Yi(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Yi(n.lastChild.content,e-1,t)))}function Ua(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Ny(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Ny(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(C.empty,!0)))),n.copy(r)}function Ha(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!zx(t,o.content,s)?l:null}function zx(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Px(n){return n.spec.defining||n.spec.definingForContent}function Fx(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(Cy(i,o,r))return n.step(new Re(e,t,r));let s=Ey(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let l=-(i.depth+1);s.unshift(l);for(let d=i.depth,p=i.pos-1;d>0;d--,p--){let h=i.node(d).type.spec;if(h.defining||h.definingAsContext||h.isolating)break;s.indexOf(d)>-1?l=d:i.before(d)==p&&s.splice(1,0,-d)}let a=s.indexOf(l),u=[],c=r.openStart;for(let d=r.content,p=0;;p++){let h=d.firstChild;if(u.push(h),p==r.openStart)break;d=h.content}for(let d=c-1;d>=0;d--){let p=u[d],h=Px(p.type);if(h&&!p.sameMarkup(i.node(Math.abs(l)-1)))c=d;else if(h||!p.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let p=(d+c+1)%(r.openStart+1),h=u[p];if(h)for(let m=0;m<s.length;m++){let w=s[(m+a)%s.length],g=!0;w<0&&(g=!1,w=-w);let y=i.node(w-1),S=i.index(w-1);if(y.canReplaceWith(S,S,h.type,h.marks))return n.replace(i.before(w),g?o.after(w):t,new v(My(r.content,0,r.openStart,p),p,r.openEnd))}}let f=n.steps.length;for(let d=s.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let p=s[d];p<0||(e=i.before(p),t=o.after(p))}}function My(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(My(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(C.empty,!0))}return n}function Lx(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=Ax(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new v(C.from(r),0,0))}function $x(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=Ey(r,i);for(let s=0;s<o.length;s++){let l=o[s],a=s==o.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s)return n.delete(r.before(s),t);n.delete(e,t)}function Ey(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class _r extends Te{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return oe.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return oe.fromReplace(e,this.pos,this.pos+1,new v(C.from(i),0,t.isLeaf?0:1))}getMap(){return Xe.empty}invert(e){return new _r(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _r(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new _r(t.pos,t.attr,t.value)}}Te.jsonID("attr",_r);class Mo extends Te{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return oe.ok(r)}getMap(){return Xe.empty}invert(e){return new Mo(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Mo(t.attr,t.value)}}Te.jsonID("docAttr",Mo);let ii=class extends Error{};ii=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};ii.prototype=Object.create(Error.prototype);ii.prototype.constructor=ii;ii.prototype.name="TransformError";class Vx{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new oo}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new ii(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=v.empty){let i=bx(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new v(C.from(r),0,0))}delete(e,t){return this.replace(e,t,v.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Fx(this,e,t,r),this}replaceRangeWith(e,t,r){return Lx(this,e,t,r),this}deleteRange(e,t){return $x(this,e,t),this}lift(e,t){return Nx(this,e,t),this}join(e,t=1){return Rx(this,e,t),this}wrap(e,t){return Mx(this,e,t),this}setBlockType(e,t=e,r,i=null){return Ex(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return Tx(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new _r(e,t,r)),this}setDocAttribute(e,t){return this.step(new Mo(e,t)),this}addNodeMark(e,t){return this.step(new mn(e,t)),this}removeNodeMark(e,t){if(!(t instanceof W)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new ri(e,t)),this}split(e,t=1,r){return Dx(this,e,t,r),this}addMark(e,t,r){return vx(this,e,t,r),this}removeMark(e,t,r){return xx(this,e,t,r),this}clearIncompatible(e,t,r){return Cx(this,e,t,r),this}}var Yu,Gu;if(typeof WeakMap<"u"){let n=new WeakMap;Yu=e=>n.get(e),Gu=(e,t)=>(n.set(e,t),t)}else{const n=[];let t=0;Yu=r=>{for(let i=0;i<n.length;i+=2)if(n[i]==r)return n[i+1]},Gu=(r,i)=>(t==10&&(t=0),n[t++]=r,n[t++]=i)}var re=class{constructor(n,e,t,r){this.width=n,this.height=e,this.map=t,this.problems=r}findCell(n){for(let e=0;e<this.map.length;e++){const t=this.map[e];if(t!=n)continue;const r=e%this.width,i=e/this.width|0;let o=r+1,s=i+1;for(let l=1;o<this.width&&this.map[e+l]==t;l++)o++;for(let l=1;s<this.height&&this.map[e+this.width*l]==t;l++)s++;return{left:r,top:i,right:o,bottom:s}}throw new RangeError(`No cell with offset ${n} found`)}colCount(n){for(let e=0;e<this.map.length;e++)if(this.map[e]==n)return e%this.width;throw new RangeError(`No cell with offset ${n} found`)}nextCell(n,e,t){const{left:r,right:i,top:o,bottom:s}=this.findCell(n);return e=="horiz"?(t<0?r==0:i==this.width)?null:this.map[o*this.width+(t<0?r-1:i)]:(t<0?o==0:s==this.height)?null:this.map[r+this.width*(t<0?o-1:s)]}rectBetween(n,e){const{left:t,right:r,top:i,bottom:o}=this.findCell(n),{left:s,right:l,top:a,bottom:u}=this.findCell(e);return{left:Math.min(t,s),top:Math.min(i,a),right:Math.max(r,l),bottom:Math.max(o,u)}}cellsInRect(n){const e=[],t={};for(let r=n.top;r<n.bottom;r++)for(let i=n.left;i<n.right;i++){const o=r*this.width+i,s=this.map[o];t[s]||(t[s]=!0,!(i==n.left&&i&&this.map[o-1]==s||r==n.top&&r&&this.map[o-this.width]==s)&&e.push(s))}return e}positionAt(n,e,t){for(let r=0,i=0;;r++){const o=i+t.child(r).nodeSize;if(r==n){let s=e+n*this.width;const l=(n+1)*this.width;for(;s<l&&this.map[s]<i;)s++;return s==l?o-1:this.map[s]}i=o}}static get(n){return Yu(n)||Gu(n,Bx(n))}};function Bx(n){if(n.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+n.type.name);const e=Jx(n),t=n.childCount,r=[];let i=0,o=null;const s=[];for(let u=0,c=e*t;u<c;u++)r[u]=0;for(let u=0,c=0;u<t;u++){const f=n.child(u);c++;for(let h=0;;h++){for(;i<r.length&&r[i]!=0;)i++;if(h==f.childCount)break;const m=f.child(h),{colspan:w,rowspan:g,colwidth:y}=m.attrs;for(let S=0;S<g;S++){if(S+u>=t){(o||(o=[])).push({type:"overlong_rowspan",pos:c,n:g-S});break}const x=i+S*e;for(let M=0;M<w;M++){r[x+M]==0?r[x+M]=c:(o||(o=[])).push({type:"collision",row:u,pos:c,n:w-M});const N=y&&y[M];if(N){const O=(x+M)%e*2,T=s[O];T==null||T!=N&&s[O+1]==1?(s[O]=N,s[O+1]=1):T==N&&s[O+1]++}}}i+=w,c+=m.nodeSize}const d=(u+1)*e;let p=0;for(;i<d;)r[i++]==0&&p++;p&&(o||(o=[])).push({type:"missing",row:u,n:p}),c++}const l=new re(e,t,r,o);let a=!1;for(let u=0;!a&&u<s.length;u+=2)s[u]!=null&&s[u+1]<t&&(a=!0);return a&&_x(l,s,n),l}function Jx(n){let e=-1,t=!1;for(let r=0;r<n.childCount;r++){const i=n.child(r);let o=0;if(t)for(let s=0;s<r;s++){const l=n.child(s);for(let a=0;a<l.childCount;a++){const u=l.child(a);s+u.attrs.rowspan>r&&(o+=u.attrs.colspan)}}for(let s=0;s<i.childCount;s++){const l=i.child(s);o+=l.attrs.colspan,l.attrs.rowspan>1&&(t=!0)}e==-1?e=o:e!=o&&(e=Math.max(e,o))}return e}function _x(n,e,t){n.problems||(n.problems=[]);const r={};for(let i=0;i<n.map.length;i++){const o=n.map[i];if(r[o])continue;r[o]=!0;const s=t.nodeAt(o);if(!s)throw new RangeError(`No cell with offset ${o} found`);let l=null;const a=s.attrs;for(let u=0;u<a.colspan;u++){const c=(i+u)%n.width,f=e[c*2];f!=null&&(!a.colwidth||a.colwidth[u]!=f)&&((l||(l=Wx(a)))[u]=f)}l&&n.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:l})}}function Wx(n){if(n.colwidth)return n.colwidth.slice();const e=[];for(let t=0;t<n.colspan;t++)e.push(0);return e}function Fh(n,e){if(typeof n=="string")return{};const t=n.getAttribute("data-colwidth"),r=t&&/^\d+(,\d+)*$/.test(t)?t.split(",").map(s=>Number(s)):null,i=Number(n.getAttribute("colspan")||1),o={colspan:i,rowspan:Number(n.getAttribute("rowspan")||1),colwidth:r&&r.length==i?r:null};for(const s in e){const l=e[s].getFromDOM,a=l&&l(n);a!=null&&(o[s]=a)}return o}function Lh(n,e){const t={};n.attrs.colspan!=1&&(t.colspan=n.attrs.colspan),n.attrs.rowspan!=1&&(t.rowspan=n.attrs.rowspan),n.attrs.colwidth&&(t["data-colwidth"]=n.attrs.colwidth.join(","));for(const r in e){const i=e[r].setDOMAttr;i&&i(n.attrs[r],t)}return t}function Ux(n){const e=n.cellAttributes||{},t={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(const r in e)t[r]={default:e[r].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:n.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:n.cellContent,attrs:t,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs:r=>Fh(r,e)}],toDOM(r){return["td",Lh(r,e),0]}},table_header:{content:n.cellContent,attrs:t,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs:r=>Fh(r,e)}],toDOM(r){return["th",Lh(r,e),0]}}}}function Lt(n){let e=n.cached.tableNodeTypes;if(!e){e=n.cached.tableNodeTypes={};for(const t in n.nodes){const r=n.nodes[t],i=r.spec.tableRole;i&&(e[i]=r)}}return e}var an=new Go("selectingCells");function ts(n){for(let e=n.depth-1;e>0;e--)if(n.node(e).type.spec.tableRole=="row")return n.node(0).resolve(n.before(e+1));return null}function Mf(n){const e=n.selection.$head;for(let t=e.depth;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return!0;return!1}function Oy(n){const e=n.selection;if("$anchorCell"in e&&e.$anchorCell)return e.$anchorCell.pos>e.$headCell.pos?e.$anchorCell:e.$headCell;if("node"in e&&e.node&&e.node.type.spec.tableRole=="cell")return e.$anchor;const t=ts(e.$head)||Hx(e.$head);if(t)return t;throw new RangeError(`No cell found around position ${e.head}`)}function Hx(n){for(let e=n.nodeAfter,t=n.pos;e;e=e.firstChild,t++){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t)}for(let e=n.nodeBefore,t=n.pos;e;e=e.lastChild,t--){const r=e.type.spec.tableRole;if(r=="cell"||r=="header_cell")return n.doc.resolve(t-e.nodeSize)}}function Xu(n){return n.parent.type.spec.tableRole=="row"&&!!n.nodeAfter}function Ef(n,e){return n.depth==e.depth&&n.pos>=e.start(-1)&&n.pos<=e.end(-1)}function Ty(n,e,t){const r=n.node(-1),i=re.get(r),o=n.start(-1),s=i.nextCell(n.pos-o,e,t);return s==null?null:n.node(0).resolve(o+s)}function oi(n,e,t=1){const r={...n,colspan:n.colspan-t};return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(e,t),r.colwidth.some(i=>i>0)||(r.colwidth=null)),r}var fe=class Jt extends P{constructor(e,t=e){const r=e.node(-1),i=re.get(r),o=e.start(-1),s=i.rectBetween(e.pos-o,t.pos-o),l=e.node(0),a=i.cellsInRect(s).filter(c=>c!=t.pos-o);a.unshift(t.pos-o);const u=a.map(c=>{const f=r.nodeAt(c);if(!f)throw RangeError(`No cell with offset ${c} found`);const d=o+c+1;return new lg(l.resolve(d),l.resolve(d+f.content.size))});super(u[0].$from,u[0].$to,u),this.$anchorCell=e,this.$headCell=t}map(e,t){const r=e.resolve(t.map(this.$anchorCell.pos)),i=e.resolve(t.map(this.$headCell.pos));if(Xu(r)&&Xu(i)&&Ef(r,i)){const o=this.$anchorCell.node(-1)!=r.node(-1);return o&&this.isRowSelection()?Jt.rowSelection(r,i):o&&this.isColSelection()?Jt.colSelection(r,i):new Jt(r,i)}return $.between(r,i)}content(){const e=this.$anchorCell.node(-1),t=re.get(e),r=this.$anchorCell.start(-1),i=t.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r),o={},s=[];for(let a=i.top;a<i.bottom;a++){const u=[];for(let c=a*t.width+i.left,f=i.left;f<i.right;f++,c++){const d=t.map[c];if(o[d])continue;o[d]=!0;const p=t.findCell(d);let h=e.nodeAt(d);if(!h)throw RangeError(`No cell with offset ${d} found`);const m=i.left-p.left,w=p.right-i.right;if(m>0||w>0){let g=h.attrs;if(m>0&&(g=oi(g,0,m)),w>0&&(g=oi(g,g.colspan-w,w)),p.left<i.left){if(h=h.type.createAndFill(g),!h)throw RangeError(`Could not create cell with attrs ${JSON.stringify(g)}`)}else h=h.type.create(g,h.content)}if(p.top<i.top||p.bottom>i.bottom){const g={...h.attrs,rowspan:Math.min(p.bottom,i.bottom)-Math.max(p.top,i.top)};p.top<i.top?h=h.type.createAndFill(g):h=h.type.create(g,h.content)}u.push(h)}s.push(e.child(a).copy(C.from(u)))}const l=this.isColSelection()&&this.isRowSelection()?e:s;return new v(C.from(l),1,1)}replace(e,t=v.empty){const r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){const{$from:l,$to:a}=i[s],u=e.mapping.slice(r);e.replace(u.map(l.pos),u.map(a.pos),s?v.empty:t)}const o=P.findFrom(e.doc.resolve(e.mapping.slice(r).map(this.to)),-1);o&&e.setSelection(o)}replaceWith(e,t){this.replace(e,new v(C.from(t),0,0))}forEachCell(e){const t=this.$anchorCell.node(-1),r=re.get(t),i=this.$anchorCell.start(-1),o=r.cellsInRect(r.rectBetween(this.$anchorCell.pos-i,this.$headCell.pos-i));for(let s=0;s<o.length;s++)e(t.nodeAt(o[s]),i+o[s])}isColSelection(){const e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;const r=e+this.$anchorCell.nodeAfter.attrs.rowspan,i=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(r,i)==this.$headCell.node(-1).childCount}static colSelection(e,t=e){const r=e.node(-1),i=re.get(r),o=e.start(-1),s=i.findCell(e.pos-o),l=i.findCell(t.pos-o),a=e.node(0);return s.top<=l.top?(s.top>0&&(e=a.resolve(o+i.map[s.left])),l.bottom<i.height&&(t=a.resolve(o+i.map[i.width*(i.height-1)+l.right-1]))):(l.top>0&&(t=a.resolve(o+i.map[l.left])),s.bottom<i.height&&(e=a.resolve(o+i.map[i.width*(i.height-1)+s.right-1]))),new Jt(e,t)}isRowSelection(){const e=this.$anchorCell.node(-1),t=re.get(e),r=this.$anchorCell.start(-1),i=t.colCount(this.$anchorCell.pos-r),o=t.colCount(this.$headCell.pos-r);if(Math.min(i,o)>0)return!1;const s=i+this.$anchorCell.nodeAfter.attrs.colspan,l=o+this.$headCell.nodeAfter.attrs.colspan;return Math.max(s,l)==t.width}eq(e){return e instanceof Jt&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos}static rowSelection(e,t=e){const r=e.node(-1),i=re.get(r),o=e.start(-1),s=i.findCell(e.pos-o),l=i.findCell(t.pos-o),a=e.node(0);return s.left<=l.left?(s.left>0&&(e=a.resolve(o+i.map[s.top*i.width])),l.right<i.width&&(t=a.resolve(o+i.map[i.width*(l.top+1)-1]))):(l.left>0&&(t=a.resolve(o+i.map[l.top*i.width])),s.right<i.width&&(e=a.resolve(o+i.map[i.width*(s.top+1)-1]))),new Jt(e,t)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(e,t){return new Jt(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){return new Jt(e.resolve(t),e.resolve(r))}getBookmark(){return new jx(this.$anchorCell.pos,this.$headCell.pos)}};fe.prototype.visible=!1;P.jsonID("cell",fe);var jx=class Dy{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Dy(e.map(this.anchor),e.map(this.head))}resolve(e){const t=e.resolve(this.anchor),r=e.resolve(this.head);return t.parent.type.spec.tableRole=="row"&&r.parent.type.spec.tableRole=="row"&&t.index()<t.parent.childCount&&r.index()<r.parent.childCount&&Ef(t,r)?new fe(t,r):P.near(r,1)}};function Kx(n){if(!(n.selection instanceof fe))return null;const e=[];return n.selection.forEachCell((t,r)=>{e.push(Se.node(r,r+t.nodeSize,{class:"selectedCell"}))}),_.create(n.doc,e)}function qx({$from:n,$to:e}){if(n.pos==e.pos||n.pos<n.pos-6)return!1;let t=n.pos,r=e.pos,i=n.depth;for(;i>=0&&!(n.after(i+1)<n.end(i));i--,t++);for(let o=e.depth;o>=0&&!(e.before(o+1)>e.start(o));o--,r--);return t==r&&/row|table/.test(n.node(i).type.spec.tableRole)}function Qx({$from:n,$to:e}){let t,r;for(let i=n.depth;i>0;i--){const o=n.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){t=o;break}}for(let i=e.depth;i>0;i--){const o=e.node(i);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}return t!==r&&e.parentOffset===0}function Yx(n,e,t){const r=(e||n).selection,i=(e||n).doc;let o,s;if(r instanceof I&&(s=r.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")o=fe.create(i,r.from);else if(s=="row"){const l=i.resolve(r.from+1);o=fe.rowSelection(l,l)}else if(!t){const l=re.get(r.node),a=r.from+1,u=a+l.map[l.width*l.height-1];o=fe.create(i,a+1,u)}}else r instanceof $&&qx(r)?o=$.create(i,r.from):r instanceof $&&Qx(r)&&(o=$.create(i,r.$from.start(),r.$from.end()));return o&&(e||(e=n.tr)).setSelection(o),e}var Gx=new Go("fix-tables");function Ry(n,e,t,r){const i=n.childCount,o=e.childCount;e:for(let s=0,l=0;s<o;s++){const a=e.child(s);for(let u=l,c=Math.min(i,s+3);u<c;u++)if(n.child(u)==a){l=u+1,t+=a.nodeSize;continue e}r(a,t),l<i&&n.child(l).sameMarkup(a)?Ry(n.child(l),a,t+1,r):a.nodesBetween(0,a.content.size,r,t+1),t+=a.nodeSize}}function Xx(n,e){let t;const r=(i,o)=>{i.type.spec.tableRole=="table"&&(t=Zx(n,i,o,t))};return e?e.doc!=n.doc&&Ry(e.doc,n.doc,0,r):n.doc.descendants(r),t}function Zx(n,e,t,r){const i=re.get(e);if(!i.problems)return r;r||(r=n.tr);const o=[];for(let a=0;a<i.height;a++)o.push(0);for(let a=0;a<i.problems.length;a++){const u=i.problems[a];if(u.type=="collision"){const c=e.nodeAt(u.pos);if(!c)continue;const f=c.attrs;for(let d=0;d<f.rowspan;d++)o[u.row+d]+=u.n;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,oi(f,f.colspan-u.n,u.n))}else if(u.type=="missing")o[u.row]+=u.n;else if(u.type=="overlong_rowspan"){const c=e.nodeAt(u.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,{...c.attrs,rowspan:c.attrs.rowspan-u.n})}else if(u.type=="colwidth mismatch"){const c=e.nodeAt(u.pos);if(!c)continue;r.setNodeMarkup(r.mapping.map(t+1+u.pos),null,{...c.attrs,colwidth:u.colwidth})}}let s,l;for(let a=0;a<o.length;a++)o[a]&&(s==null&&(s=a),l=a);for(let a=0,u=t+1;a<i.height;a++){const c=e.child(a),f=u+c.nodeSize,d=o[a];if(d>0){let p="cell";c.firstChild&&(p=c.firstChild.type.spec.tableRole);const h=[];for(let w=0;w<d;w++){const g=Lt(n.schema)[p].createAndFill();g&&h.push(g)}const m=(a==0||s==a-1)&&l==a?u+1:f-1;r.insert(r.mapping.map(m),h)}u=f}return r.setMeta(Gx,{fixTables:!0})}function eC(n){if(!n.size)return null;let{content:e,openStart:t,openEnd:r}=n;for(;e.childCount==1&&(t>0&&r>0||e.child(0).type.spec.tableRole=="table");)t--,r--,e=e.child(0).content;const i=e.child(0),o=i.type.spec.tableRole,s=i.type.schema,l=[];if(o=="row")for(let a=0;a<e.childCount;a++){let u=e.child(a).content;const c=a?0:Math.max(0,t-1),f=a<e.childCount-1?0:Math.max(0,r-1);(c||f)&&(u=Zu(Lt(s).row,new v(u,c,f)).content),l.push(u)}else if(o=="cell"||o=="header_cell")l.push(t||r?Zu(Lt(s).row,new v(e,t,r)).content:e);else return null;return tC(s,l)}function tC(n,e){const t=[];for(let i=0;i<e.length;i++){const o=e[i];for(let s=o.childCount-1;s>=0;s--){const{rowspan:l,colspan:a}=o.child(s).attrs;for(let u=i;u<i+l;u++)t[u]=(t[u]||0)+a}}let r=0;for(let i=0;i<t.length;i++)r=Math.max(r,t[i]);for(let i=0;i<t.length;i++)if(i>=e.length&&e.push(C.empty),t[i]<r){const o=Lt(n).cell.createAndFill(),s=[];for(let l=t[i];l<r;l++)s.push(o);e[i]=e[i].append(C.from(s))}return{height:e.length,width:r,rows:e}}function Zu(n,e){const t=n.createAndFill();return new Vx(t).replace(0,t.content.size,e).doc}function nC({width:n,height:e,rows:t},r,i){if(n!=r){const o=[],s=[];for(let l=0;l<t.length;l++){const a=t[l],u=[];for(let c=o[l]||0,f=0;c<r;f++){let d=a.child(f%a.childCount);c+d.attrs.colspan>r&&(d=d.type.createChecked(oi(d.attrs,d.attrs.colspan,c+d.attrs.colspan-r),d.content)),u.push(d),c+=d.attrs.colspan;for(let p=1;p<d.attrs.rowspan;p++)o[l+p]=(o[l+p]||0)+d.attrs.colspan}s.push(C.from(u))}t=s,n=r}if(e!=i){const o=[];for(let s=0,l=0;s<i;s++,l++){const a=[],u=t[l%e];for(let c=0;c<u.childCount;c++){let f=u.child(c);s+f.attrs.rowspan>i&&(f=f.type.create({...f.attrs,rowspan:Math.max(1,i-f.attrs.rowspan)},f.content)),a.push(f)}o.push(C.from(a))}t=o,e=i}return{width:n,height:e,rows:t}}function rC(n,e,t,r,i,o,s){const l=n.doc.type.schema,a=Lt(l);let u,c;if(i>e.width)for(let f=0,d=0;f<e.height;f++){const p=t.child(f);d+=p.nodeSize;const h=[];let m;p.lastChild==null||p.lastChild.type==a.cell?m=u||(u=a.cell.createAndFill()):m=c||(c=a.header_cell.createAndFill());for(let w=e.width;w<i;w++)h.push(m);n.insert(n.mapping.slice(s).map(d-1+r),h)}if(o>e.height){const f=[];for(let h=0,m=(e.height-1)*e.width;h<Math.max(e.width,i);h++){const w=h>=e.width?!1:t.nodeAt(e.map[m+h]).type==a.header_cell;f.push(w?c||(c=a.header_cell.createAndFill()):u||(u=a.cell.createAndFill()))}const d=a.row.create(null,C.from(f)),p=[];for(let h=e.height;h<o;h++)p.push(d);n.insert(n.mapping.slice(s).map(r+t.nodeSize-2),p)}return!!(u||c)}function $h(n,e,t,r,i,o,s,l){if(s==0||s==e.height)return!1;let a=!1;for(let u=i;u<o;u++){const c=s*e.width+u,f=e.map[c];if(e.map[c-e.width]==f){a=!0;const d=t.nodeAt(f),{top:p,left:h}=e.findCell(f);n.setNodeMarkup(n.mapping.slice(l).map(f+r),null,{...d.attrs,rowspan:s-p}),n.insert(n.mapping.slice(l).map(e.positionAt(s,h,t)),d.type.createAndFill({...d.attrs,rowspan:p+d.attrs.rowspan-s})),u+=d.attrs.colspan-1}}return a}function Vh(n,e,t,r,i,o,s,l){if(s==0||s==e.width)return!1;let a=!1;for(let u=i;u<o;u++){const c=u*e.width+s,f=e.map[c];if(e.map[c-1]==f){a=!0;const d=t.nodeAt(f),p=e.colCount(f),h=n.mapping.slice(l).map(f+r);n.setNodeMarkup(h,null,oi(d.attrs,s-p,d.attrs.colspan-(s-p))),n.insert(h+d.nodeSize,d.type.createAndFill(oi(d.attrs,0,s-p))),u+=d.attrs.rowspan-1}}return a}function Bh(n,e,t,r,i){let o=t?n.doc.nodeAt(t-1):n.doc;if(!o)throw new Error("No table found");let s=re.get(o);const{top:l,left:a}=r,u=a+i.width,c=l+i.height,f=n.tr;let d=0;function p(){if(o=t?f.doc.nodeAt(t-1):f.doc,!o)throw new Error("No table found");s=re.get(o),d=f.mapping.maps.length}rC(f,s,o,t,u,c,d)&&p(),$h(f,s,o,t,a,u,l,d)&&p(),$h(f,s,o,t,a,u,c,d)&&p(),Vh(f,s,o,t,l,c,a,d)&&p(),Vh(f,s,o,t,l,c,u,d)&&p();for(let h=l;h<c;h++){const m=s.positionAt(h,a,o),w=s.positionAt(h,u,o);f.replace(f.mapping.slice(d).map(m+t),f.mapping.slice(d).map(w+t),new v(i.rows[h-l],0,0))}p(),f.setSelection(new fe(f.doc.resolve(t+s.positionAt(l,a,o)),f.doc.resolve(t+s.positionAt(c-1,u-1,o)))),e(f)}var iC=Sx({ArrowLeft:gs("horiz",-1),ArrowRight:gs("horiz",1),ArrowUp:gs("vert",-1),ArrowDown:gs("vert",1),"Shift-ArrowLeft":ys("horiz",-1),"Shift-ArrowRight":ys("horiz",1),"Shift-ArrowUp":ys("vert",-1),"Shift-ArrowDown":ys("vert",1),Backspace:Ss,"Mod-Backspace":Ss,Delete:Ss,"Mod-Delete":Ss});function nl(n,e,t){return t.eq(n.selection)?!1:(e&&e(n.tr.setSelection(t).scrollIntoView()),!0)}function gs(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;if(o instanceof fe)return nl(t,r,P.near(o.$headCell,e));if(n!="horiz"&&!o.empty)return!1;const s=Ay(i,n,e);if(s==null)return!1;if(n=="horiz")return nl(t,r,P.near(t.doc.resolve(o.head+e),e));{const l=t.doc.resolve(s),a=Ty(l,n,e);let u;return a?u=P.near(a,1):e<0?u=P.near(t.doc.resolve(l.before(-1)),-1):u=P.near(t.doc.resolve(l.after(-1)),1),nl(t,r,u)}}}function ys(n,e){return(t,r,i)=>{if(!i)return!1;const o=t.selection;let s;if(o instanceof fe)s=o;else{const a=Ay(i,n,e);if(a==null)return!1;s=new fe(t.doc.resolve(a))}const l=Ty(s.$headCell,n,e);return l?nl(t,r,new fe(s.$anchorCell,l)):!1}}function Ss(n,e){const t=n.selection;if(!(t instanceof fe))return!1;if(e){const r=n.tr,i=Lt(n.schema).cell.createAndFill().content;t.forEachCell((o,s)=>{o.content.eq(i)||r.replace(r.mapping.map(s+1),r.mapping.map(s+o.nodeSize-1),new v(i,0,0))}),r.docChanged&&e(r)}return!0}function oC(n,e){const t=n.state.doc,r=ts(t.resolve(e));return r?(n.dispatch(n.state.tr.setSelection(new fe(r))),!0):!1}function sC(n,e,t){if(!Mf(n.state))return!1;let r=eC(t);const i=n.state.selection;if(i instanceof fe){r||(r={width:1,height:1,rows:[C.from(Zu(Lt(n.state.schema).cell,t))]});const o=i.$anchorCell.node(-1),s=i.$anchorCell.start(-1),l=re.get(o).rectBetween(i.$anchorCell.pos-s,i.$headCell.pos-s);return r=nC(r,l.right-l.left,l.bottom-l.top),Bh(n.state,n.dispatch,s,l,r),!0}else if(r){const o=Oy(n.state),s=o.start(-1);return Bh(n.state,n.dispatch,s,re.get(o.node(-1)).findCell(o.pos-s),r),!0}else return!1}function lC(n,e){var t;if(e.ctrlKey||e.metaKey)return;const r=Jh(n,e.target);let i;if(e.shiftKey&&n.state.selection instanceof fe)o(n.state.selection.$anchorCell,e),e.preventDefault();else if(e.shiftKey&&r&&(i=ts(n.state.selection.$anchor))!=null&&((t=ja(n,e))==null?void 0:t.pos)!=i.pos)o(i,e),e.preventDefault();else if(!r)return;function o(a,u){let c=ja(n,u);const f=an.getState(n.state)==null;if(!c||!Ef(a,c))if(f)c=a;else return;const d=new fe(a,c);if(f||!n.state.selection.eq(d)){const p=n.state.tr.setSelection(d);f&&p.setMeta(an,a.pos),n.dispatch(p)}}function s(){n.root.removeEventListener("mouseup",s),n.root.removeEventListener("dragstart",s),n.root.removeEventListener("mousemove",l),an.getState(n.state)!=null&&n.dispatch(n.state.tr.setMeta(an,-1))}function l(a){const u=a,c=an.getState(n.state);let f;if(c!=null)f=n.state.doc.resolve(c);else if(Jh(n,u.target)!=r&&(f=ja(n,e),!f))return s();f&&o(f,u)}n.root.addEventListener("mouseup",s),n.root.addEventListener("dragstart",s),n.root.addEventListener("mousemove",l)}function Ay(n,e,t){if(!(n.state.selection instanceof $))return null;const{$head:r}=n.state.selection;for(let i=r.depth-1;i>=0;i--){const o=r.node(i);if((t<0?r.index(i):r.indexAfter(i))!=(t<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){const l=r.before(i),a=e=="vert"?t>0?"down":"up":t>0?"right":"left";return n.endOfTextblock(a)?l:null}}return null}function Jh(n,e){for(;e&&e!=n.dom;e=e.parentNode)if(e.nodeName=="TD"||e.nodeName=="TH")return e;return null}function ja(n,e){const t=n.posAtCoords({left:e.clientX,top:e.clientY});return t&&t?ts(n.state.doc.resolve(t.pos)):null}var aC=class{constructor(n,e){this.node=n,this.cellMinWidth=e,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ec(n,this.colgroup,this.table,e),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(n){return n.type!=this.node.type?!1:(this.node=n,ec(n,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(n){return n.type=="attributes"&&(n.target==this.table||this.colgroup.contains(n.target))}};function ec(n,e,t,r,i,o){var s;let l=0,a=!0,u=e.firstChild;const c=n.firstChild;if(c){for(let f=0,d=0;f<c.childCount;f++){const{colspan:p,colwidth:h}=c.child(f).attrs;for(let m=0;m<p;m++,d++){const w=i==d?o:h&&h[m],g=w?w+"px":"";l+=w||r,w||(a=!1),u?(u.style.width!=g&&(u.style.width=g),u=u.nextSibling):e.appendChild(document.createElement("col")).style.width=g}}for(;u;){const f=u.nextSibling;(s=u.parentNode)==null||s.removeChild(u),u=f}a?(t.style.width=l+"px",t.style.minWidth=""):(t.style.width="",t.style.minWidth=l+"px")}}var ut=new Go("tableColumnResizing");function uC({handleWidth:n=5,cellMinWidth:e=25,View:t=aC,lastColumnResizable:r=!0}={}){const i=new Vt({key:ut,state:{init(o,s){return i.spec.props.nodeViews[Lt(s.schema).table.name]=(l,a)=>new t(l,e,a),new cC(-1,!1)},apply(o,s){return s.apply(o)}},props:{attributes:o=>{const s=ut.getState(o);return s&&s.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(o,s)=>{fC(o,s,n,e,r)},mouseleave:o=>{dC(o)},mousedown:(o,s)=>{hC(o,s,e)}},decorations:o=>{const s=ut.getState(o);if(s&&s.activeHandle>-1)return wC(o,s.activeHandle)},nodeViews:{}}});return i}var cC=class rl{constructor(e,t){this.activeHandle=e,this.dragging=t}apply(e){const t=this,r=e.getMeta(ut);if(r&&r.setHandle!=null)return new rl(r.setHandle,!1);if(r&&r.setDragging!==void 0)return new rl(t.activeHandle,r.setDragging);if(t.activeHandle>-1&&e.docChanged){let i=e.mapping.map(t.activeHandle,-1);return Xu(e.doc.resolve(i))||(i=-1),new rl(i,t.dragging)}return t}};function fC(n,e,t,r,i){const o=ut.getState(n.state);if(o&&!o.dragging){const s=mC(e.target);let l=-1;if(s){const{left:a,right:u}=s.getBoundingClientRect();e.clientX-a<=t?l=_h(n,e,"left",t):u-e.clientX<=t&&(l=_h(n,e,"right",t))}if(l!=o.activeHandle){if(!i&&l!==-1){const a=n.state.doc.resolve(l),u=a.node(-1),c=re.get(u),f=a.start(-1);if(c.colCount(a.pos-f)+a.nodeAfter.attrs.colspan-1==c.width-1)return}by(n,l)}}}function dC(n){const e=ut.getState(n.state);e&&e.activeHandle>-1&&!e.dragging&&by(n,-1)}function hC(n,e,t){var r;const i=(r=n.dom.ownerDocument.defaultView)!=null?r:window,o=ut.getState(n.state);if(!o||o.activeHandle==-1||o.dragging)return!1;const s=n.state.doc.nodeAt(o.activeHandle),l=pC(n,o.activeHandle,s.attrs);n.dispatch(n.state.tr.setMeta(ut,{setDragging:{startX:e.clientX,startWidth:l}}));function a(c){i.removeEventListener("mouseup",a),i.removeEventListener("mousemove",u);const f=ut.getState(n.state);f!=null&&f.dragging&&(gC(n,f.activeHandle,Wh(f.dragging,c,t)),n.dispatch(n.state.tr.setMeta(ut,{setDragging:null})))}function u(c){if(!c.which)return a(c);const f=ut.getState(n.state);if(f&&f.dragging){const d=Wh(f.dragging,c,t);yC(n,f.activeHandle,d,t)}}return i.addEventListener("mouseup",a),i.addEventListener("mousemove",u),e.preventDefault(),!0}function pC(n,e,{colspan:t,colwidth:r}){const i=r&&r[r.length-1];if(i)return i;const o=n.domAtPos(e);let l=o.node.childNodes[o.offset].offsetWidth,a=t;if(r)for(let u=0;u<t;u++)r[u]&&(l-=r[u],a--);return l/a}function mC(n){for(;n&&n.nodeName!="TD"&&n.nodeName!="TH";)n=n.classList&&n.classList.contains("ProseMirror")?null:n.parentNode;return n}function _h(n,e,t,r){const i=t=="right"?-r:r,o=n.posAtCoords({left:e.clientX+i,top:e.clientY});if(!o)return-1;const{pos:s}=o,l=ts(n.state.doc.resolve(s));if(!l)return-1;if(t=="right")return l.pos;const a=re.get(l.node(-1)),u=l.start(-1),c=a.map.indexOf(l.pos-u);return c%a.width==0?-1:u+a.map[c-1]}function Wh(n,e,t){const r=e.clientX-n.startX;return Math.max(t,n.startWidth+r)}function by(n,e){n.dispatch(n.state.tr.setMeta(ut,{setHandle:e}))}function gC(n,e,t){const r=n.state.doc.resolve(e),i=r.node(-1),o=re.get(i),s=r.start(-1),l=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan-1,a=n.state.tr;for(let u=0;u<o.height;u++){const c=u*o.width+l;if(u&&o.map[c]==o.map[c-o.width])continue;const f=o.map[c],d=i.nodeAt(f).attrs,p=d.colspan==1?0:l-o.colCount(f);if(d.colwidth&&d.colwidth[p]==t)continue;const h=d.colwidth?d.colwidth.slice():SC(d.colspan);h[p]=t,a.setNodeMarkup(s+f,null,{...d,colwidth:h})}a.docChanged&&n.dispatch(a)}function yC(n,e,t,r){const i=n.state.doc.resolve(e),o=i.node(-1),s=i.start(-1),l=re.get(o).colCount(i.pos-s)+i.nodeAfter.attrs.colspan-1;let a=n.domAtPos(i.start(-1)).node;for(;a&&a.nodeName!="TABLE";)a=a.parentNode;a&&ec(o,a.firstChild,a,r,l,t)}function SC(n){return Array(n).fill(0)}function wC(n,e){const t=[],r=n.doc.resolve(e),i=r.node(-1);if(!i)return _.empty;const o=re.get(i),s=r.start(-1),l=o.colCount(r.pos-s)+r.nodeAfter.attrs.colspan;for(let a=0;a<o.height;a++){const u=l+a*o.width-1;if((l==o.width||o.map[u]!=o.map[u+1])&&(a==0||o.map[u]!=o.map[u-o.width])){const c=o.map[u],f=s+c+i.nodeAt(c).nodeSize-1,d=document.createElement("div");d.className="column-resize-handle",t.push(Se.widget(f,d))}}return _.create(n.doc,t)}function Iy(n){const e=n.selection,t=Oy(n),r=t.node(-1),i=t.start(-1),o=re.get(r);return{...e instanceof fe?o.rectBetween(e.$anchorCell.pos-i,e.$headCell.pos-i):o.findCell(t.pos-i),tableStart:i,map:o,table:r}}function kC(n){return function(e,t){if(!Mf(e))return!1;if(t){const r=Lt(e.schema),i=Iy(e),o=e.tr,s=i.map.cellsInRect(n=="column"?{left:i.left,top:0,right:i.right,bottom:i.map.height}:n=="row"?{left:0,top:i.top,right:i.map.width,bottom:i.bottom}:i),l=s.map(a=>i.table.nodeAt(a));for(let a=0;a<s.length;a++)l[a].type==r.header_cell&&o.setNodeMarkup(i.tableStart+s[a],r.cell,l[a].attrs);if(o.steps.length==0)for(let a=0;a<s.length;a++)o.setNodeMarkup(i.tableStart+s[a],r.header_cell,l[a].attrs);t(o)}return!0}}function Uh(n,e,t){const r=e.map.cellsInRect({left:0,top:0,right:n=="row"?e.map.width:1,bottom:n=="column"?e.map.height:1});for(let i=0;i<r.length;i++){const o=e.table.nodeAt(r[i]);if(o&&o.type!==t.header_cell)return!1}return!0}function Of(n,e){return e=e||{useDeprecatedLogic:!1},e.useDeprecatedLogic?kC(n):function(t,r){if(!Mf(t))return!1;if(r){const i=Lt(t.schema),o=Iy(t),s=t.tr,l=Uh("row",o,i),a=Uh("column",o,i),c=(n==="column"?l:n==="row"?a:!1)?1:0,f=n=="column"?{left:0,top:c,right:1,bottom:o.map.height}:n=="row"?{left:c,top:0,right:o.map.width,bottom:1}:o,d=n=="column"?a?i.cell:i.header_cell:n=="row"?l?i.cell:i.header_cell:i.cell;o.map.cellsInRect(f).forEach(p=>{const h=p+o.tableStart,m=s.doc.nodeAt(h);m&&s.setNodeMarkup(h,d,m.attrs)}),r(s)}return!0}}Of("row",{useDeprecatedLogic:!0});Of("column",{useDeprecatedLogic:!0});Of("cell",{useDeprecatedLogic:!0});function vC({allowTableNodeSelection:n=!1}={}){return new Vt({key:an,state:{init(){return null},apply(e,t){const r=e.getMeta(an);if(r!=null)return r==-1?null:r;if(t==null||!e.docChanged)return t;const{deleted:i,pos:o}=e.mapping.mapResult(t);return i?null:o}},props:{decorations:Kx,handleDOMEvents:{mousedown:lC},createSelectionBetween(e){return an.getState(e.state)!=null?e.state.selection:null},handleTripleClick:oC,handleKeyDown:iC,handlePaste:sC},appendTransaction(e,t,r){return Yx(r,Xx(r,t),n)}})}var zy={exports:{}},rt={},Py={exports:{}},Fy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(R,F){var L=R.length;R.push(F);e:for(;0<L;){var ee=L-1>>>1,ue=R[ee];if(0<i(ue,F))R[ee]=F,R[L]=ue,L=ee;else break e}}function t(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var F=R[0],L=R.pop();if(L!==F){R[0]=L;e:for(var ee=0,ue=R.length,us=ue>>>1;ee<us;){var Vn=2*(ee+1)-1,wa=R[Vn],Bn=Vn+1,cs=R[Bn];if(0>i(wa,L))Bn<ue&&0>i(cs,wa)?(R[ee]=cs,R[Bn]=L,ee=Bn):(R[ee]=wa,R[Vn]=L,ee=Vn);else if(Bn<ue&&0>i(cs,L))R[ee]=cs,R[Bn]=L,ee=Bn;else break e}}return F}function i(R,F){var L=R.sortIndex-F.sortIndex;return L!==0?L:R.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();n.unstable_now=function(){return s.now()-l}}var a=[],u=[],c=1,f=null,d=3,p=!1,h=!1,m=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(R){for(var F=t(u);F!==null;){if(F.callback===null)r(u);else if(F.startTime<=R)r(u),F.sortIndex=F.expirationTime,e(a,F);else break;F=t(u)}}function x(R){if(m=!1,S(R),!h)if(t(a)!==null)h=!0,he(M);else{var F=t(u);F!==null&&$n(x,F.startTime-R)}}function M(R,F){h=!1,m&&(m=!1,g(T),T=-1),p=!0;var L=d;try{for(S(F),f=t(a);f!==null&&(!(f.expirationTime>F)||R&&!ae());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,d=f.priorityLevel;var ue=ee(f.expirationTime<=F);F=n.unstable_now(),typeof ue=="function"?f.callback=ue:f===t(a)&&r(a),S(F)}else r(a);f=t(a)}if(f!==null)var us=!0;else{var Vn=t(u);Vn!==null&&$n(x,Vn.startTime-F),us=!1}return us}finally{f=null,d=L,p=!1}}var N=!1,O=null,T=-1,b=5,z=-1;function ae(){return!(n.unstable_now()-z<b)}function Mt(){if(O!==null){var R=n.unstable_now();z=R;var F=!0;try{F=O(!0,R)}finally{F?Ln():(N=!1,O=null)}}else N=!1}var Ln;if(typeof y=="function")Ln=function(){y(Mt)};else if(typeof MessageChannel<"u"){var as=new MessageChannel,ne=as.port2;as.port1.onmessage=Mt,Ln=function(){ne.postMessage(null)}}else Ln=function(){w(Mt,0)};function he(R){O=R,N||(N=!0,Ln())}function $n(R,F){T=w(function(){R(n.unstable_now())},F)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(R){R.callback=null},n.unstable_continueExecution=function(){h||p||(h=!0,he(M))},n.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<R?Math.floor(1e3/R):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(R){switch(d){case 1:case 2:case 3:var F=3;break;default:F=d}var L=d;d=F;try{return R()}finally{d=L}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(R,F){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var L=d;d=R;try{return F()}finally{d=L}},n.unstable_scheduleCallback=function(R,F,L){var ee=n.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ee+L:ee):L=ee,R){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=L+ue,R={id:c++,callback:F,priorityLevel:R,startTime:L,expirationTime:ue,sortIndex:-1},L>ee?(R.sortIndex=L,e(u,R),t(a)===null&&R===t(u)&&(m?(g(T),T=-1):m=!0,$n(x,L-ee))):(R.sortIndex=ue,e(a,R),h||p||(h=!0,he(M))),R},n.unstable_shouldYield=ae,n.unstable_wrapCallback=function(R){var F=d;return function(){var L=d;d=F;try{return R.apply(this,arguments)}finally{d=L}}}})(Fy);Py.exports=Fy;var xC=Py.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ly=k,nt=xC;function E(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $y=new Set,Eo={};function pr(n,e){si(n,e),si(n+"Capture",e)}function si(n,e){for(Eo[n]=e,n=0;n<e.length;n++)$y.add(e[n])}var Yt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tc=Object.prototype.hasOwnProperty,CC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hh={},jh={};function NC(n){return tc.call(jh,n)?!0:tc.call(Hh,n)?!1:CC.test(n)?jh[n]=!0:(Hh[n]=!0,!1)}function MC(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function EC(n,e,t,r){if(e===null||typeof e>"u"||MC(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fe(n,e,t,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var ke={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){ke[n]=new Fe(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];ke[e]=new Fe(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){ke[n]=new Fe(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){ke[n]=new Fe(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){ke[n]=new Fe(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){ke[n]=new Fe(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){ke[n]=new Fe(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){ke[n]=new Fe(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){ke[n]=new Fe(n,5,!1,n.toLowerCase(),null,!1,!1)});var Tf=/[\-:]([a-z])/g;function Df(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Tf,Df);ke[e]=new Fe(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Tf,Df);ke[e]=new Fe(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Tf,Df);ke[e]=new Fe(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){ke[n]=new Fe(n,1,!1,n.toLowerCase(),null,!1,!1)});ke.xlinkHref=new Fe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){ke[n]=new Fe(n,1,!1,n.toLowerCase(),null,!0,!0)});function Rf(n,e,t,r){var i=ke.hasOwnProperty(e)?ke[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EC(e,t,i,r)&&(t=null),r||i===null?NC(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var en=Ly.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ws=Symbol.for("react.element"),Tr=Symbol.for("react.portal"),Dr=Symbol.for("react.fragment"),Af=Symbol.for("react.strict_mode"),nc=Symbol.for("react.profiler"),Vy=Symbol.for("react.provider"),By=Symbol.for("react.context"),bf=Symbol.for("react.forward_ref"),rc=Symbol.for("react.suspense"),ic=Symbol.for("react.suspense_list"),If=Symbol.for("react.memo"),on=Symbol.for("react.lazy"),Jy=Symbol.for("react.offscreen"),Kh=Symbol.iterator;function ki(n){return n===null||typeof n!="object"?null:(n=Kh&&n[Kh]||n["@@iterator"],typeof n=="function"?n:null)}var G=Object.assign,Ka;function Gi(n){if(Ka===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Ka=e&&e[1]||""}return`
`+Ka+n}var qa=!1;function Qa(n,e){if(!n||qa)return"";qa=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var a=`
`+i[s].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=s&&0<=l);break}}}finally{qa=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Gi(n):""}function OC(n){switch(n.tag){case 5:return Gi(n.type);case 16:return Gi("Lazy");case 13:return Gi("Suspense");case 19:return Gi("SuspenseList");case 0:case 2:case 15:return n=Qa(n.type,!1),n;case 11:return n=Qa(n.type.render,!1),n;case 1:return n=Qa(n.type,!0),n;default:return""}}function oc(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Dr:return"Fragment";case Tr:return"Portal";case nc:return"Profiler";case Af:return"StrictMode";case rc:return"Suspense";case ic:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case By:return(n.displayName||"Context")+".Consumer";case Vy:return(n._context.displayName||"Context")+".Provider";case bf:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case If:return e=n.displayName||null,e!==null?e:oc(n.type)||"Memo";case on:e=n._payload,n=n._init;try{return oc(n(e))}catch{}}return null}function TC(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oc(e);case 8:return e===Af?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Dn(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function _y(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function DC(n){var e=_y(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function ks(n){n._valueTracker||(n._valueTracker=DC(n))}function Wy(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=_y(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function El(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function sc(n,e){var t=e.checked;return G({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function qh(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Dn(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Uy(n,e){e=e.checked,e!=null&&Rf(n,"checked",e,!1)}function lc(n,e){Uy(n,e);var t=Dn(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?ac(n,e.type,t):e.hasOwnProperty("defaultValue")&&ac(n,e.type,Dn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Qh(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function ac(n,e,t){(e!=="number"||El(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Xi=Array.isArray;function Wr(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Dn(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function uc(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(E(91));return G({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Yh(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(E(92));if(Xi(t)){if(1<t.length)throw Error(E(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Dn(t)}}function Hy(n,e){var t=Dn(e.value),r=Dn(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Gh(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function jy(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cc(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?jy(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var vs,Ky=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(vs=vs||document.createElement("div"),vs.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vs.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Oo(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var so={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RC=["Webkit","ms","Moz","O"];Object.keys(so).forEach(function(n){RC.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),so[e]=so[n]})});function qy(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||so.hasOwnProperty(n)&&so[n]?(""+e).trim():e+"px"}function Qy(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=qy(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var AC=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fc(n,e){if(e){if(AC[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(E(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(E(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(E(61))}if(e.style!=null&&typeof e.style!="object")throw Error(E(62))}}function dc(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hc=null;function zf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var pc=null,Ur=null,Hr=null;function Xh(n){if(n=is(n)){if(typeof pc!="function")throw Error(E(280));var e=n.stateNode;e&&(e=la(e),pc(n.stateNode,n.type,e))}}function Yy(n){Ur?Hr?Hr.push(n):Hr=[n]:Ur=n}function Gy(){if(Ur){var n=Ur,e=Hr;if(Hr=Ur=null,Xh(n),e)for(n=0;n<e.length;n++)Xh(e[n])}}function Xy(n,e){return n(e)}function Zy(){}var Ya=!1;function e0(n,e,t){if(Ya)return n(e,t);Ya=!0;try{return Xy(n,e,t)}finally{Ya=!1,(Ur!==null||Hr!==null)&&(Zy(),Gy())}}function To(n,e){var t=n.stateNode;if(t===null)return null;var r=la(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(E(231,e,typeof t));return t}var mc=!1;if(Yt)try{var vi={};Object.defineProperty(vi,"passive",{get:function(){mc=!0}}),window.addEventListener("test",vi,vi),window.removeEventListener("test",vi,vi)}catch{mc=!1}function bC(n,e,t,r,i,o,s,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var lo=!1,Ol=null,Tl=!1,gc=null,IC={onError:function(n){lo=!0,Ol=n}};function zC(n,e,t,r,i,o,s,l,a){lo=!1,Ol=null,bC.apply(IC,arguments)}function PC(n,e,t,r,i,o,s,l,a){if(zC.apply(this,arguments),lo){if(lo){var u=Ol;lo=!1,Ol=null}else throw Error(E(198));Tl||(Tl=!0,gc=u)}}function mr(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function t0(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Zh(n){if(mr(n)!==n)throw Error(E(188))}function FC(n){var e=n.alternate;if(!e){if(e=mr(n),e===null)throw Error(E(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===t)return Zh(i),n;if(o===r)return Zh(i),e;o=o.sibling}throw Error(E(188))}if(t.return!==r.return)t=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===t){s=!0,t=i,r=o;break}if(l===r){s=!0,r=i,t=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===t){s=!0,t=o,r=i;break}if(l===r){s=!0,r=o,t=i;break}l=l.sibling}if(!s)throw Error(E(189))}}if(t.alternate!==r)throw Error(E(190))}if(t.tag!==3)throw Error(E(188));return t.stateNode.current===t?n:e}function n0(n){return n=FC(n),n!==null?r0(n):null}function r0(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=r0(n);if(e!==null)return e;n=n.sibling}return null}var i0=nt.unstable_scheduleCallback,ep=nt.unstable_cancelCallback,LC=nt.unstable_shouldYield,$C=nt.unstable_requestPaint,te=nt.unstable_now,VC=nt.unstable_getCurrentPriorityLevel,Pf=nt.unstable_ImmediatePriority,o0=nt.unstable_UserBlockingPriority,Dl=nt.unstable_NormalPriority,BC=nt.unstable_LowPriority,s0=nt.unstable_IdlePriority,ra=null,bt=null;function JC(n){if(bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(ra,n,void 0,(n.current.flags&128)===128)}catch{}}var vt=Math.clz32?Math.clz32:UC,_C=Math.log,WC=Math.LN2;function UC(n){return n>>>=0,n===0?32:31-(_C(n)/WC|0)|0}var xs=64,Cs=4194304;function Zi(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Rl(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,o=n.pingedLanes,s=t&268435455;if(s!==0){var l=s&~i;l!==0?r=Zi(l):(o&=s,o!==0&&(r=Zi(o)))}else s=t&~i,s!==0?r=Zi(s):o!==0&&(r=Zi(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-vt(e),i=1<<t,r|=n[t],e&=~i;return r}function HC(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jC(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,o=n.pendingLanes;0<o;){var s=31-vt(o),l=1<<s,a=i[s];a===-1?(!(l&t)||l&r)&&(i[s]=HC(l,e)):a<=e&&(n.expiredLanes|=l),o&=~l}}function yc(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function l0(){var n=xs;return xs<<=1,!(xs&4194240)&&(xs=64),n}function Ga(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ns(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-vt(e),n[e]=t}function KC(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-vt(t),o=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~o}}function Ff(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-vt(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var U=0;function a0(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var u0,Lf,c0,f0,d0,Sc=!1,Ns=[],kn=null,vn=null,xn=null,Do=new Map,Ro=new Map,un=[],qC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tp(n,e){switch(n){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":vn=null;break;case"mouseover":case"mouseout":xn=null;break;case"pointerover":case"pointerout":Do.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ro.delete(e.pointerId)}}function xi(n,e,t,r,i,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=is(e),e!==null&&Lf(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function QC(n,e,t,r,i){switch(e){case"focusin":return kn=xi(kn,n,e,t,r,i),!0;case"dragenter":return vn=xi(vn,n,e,t,r,i),!0;case"mouseover":return xn=xi(xn,n,e,t,r,i),!0;case"pointerover":var o=i.pointerId;return Do.set(o,xi(Do.get(o)||null,n,e,t,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Ro.set(o,xi(Ro.get(o)||null,n,e,t,r,i)),!0}return!1}function h0(n){var e=Yn(n.target);if(e!==null){var t=mr(e);if(t!==null){if(e=t.tag,e===13){if(e=t0(t),e!==null){n.blockedOn=e,d0(n.priority,function(){c0(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function il(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=wc(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);hc=r,t.target.dispatchEvent(r),hc=null}else return e=is(t),e!==null&&Lf(e),n.blockedOn=t,!1;e.shift()}return!0}function np(n,e,t){il(n)&&t.delete(e)}function YC(){Sc=!1,kn!==null&&il(kn)&&(kn=null),vn!==null&&il(vn)&&(vn=null),xn!==null&&il(xn)&&(xn=null),Do.forEach(np),Ro.forEach(np)}function Ci(n,e){n.blockedOn===e&&(n.blockedOn=null,Sc||(Sc=!0,nt.unstable_scheduleCallback(nt.unstable_NormalPriority,YC)))}function Ao(n){function e(i){return Ci(i,n)}if(0<Ns.length){Ci(Ns[0],n);for(var t=1;t<Ns.length;t++){var r=Ns[t];r.blockedOn===n&&(r.blockedOn=null)}}for(kn!==null&&Ci(kn,n),vn!==null&&Ci(vn,n),xn!==null&&Ci(xn,n),Do.forEach(e),Ro.forEach(e),t=0;t<un.length;t++)r=un[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<un.length&&(t=un[0],t.blockedOn===null);)h0(t),t.blockedOn===null&&un.shift()}var jr=en.ReactCurrentBatchConfig,Al=!0;function GC(n,e,t,r){var i=U,o=jr.transition;jr.transition=null;try{U=1,$f(n,e,t,r)}finally{U=i,jr.transition=o}}function XC(n,e,t,r){var i=U,o=jr.transition;jr.transition=null;try{U=4,$f(n,e,t,r)}finally{U=i,jr.transition=o}}function $f(n,e,t,r){if(Al){var i=wc(n,e,t,r);if(i===null)lu(n,e,r,bl,t),tp(n,r);else if(QC(i,n,e,t,r))r.stopPropagation();else if(tp(n,r),e&4&&-1<qC.indexOf(n)){for(;i!==null;){var o=is(i);if(o!==null&&u0(o),o=wc(n,e,t,r),o===null&&lu(n,e,r,bl,t),o===i)break;i=o}i!==null&&r.stopPropagation()}else lu(n,e,r,null,t)}}var bl=null;function wc(n,e,t,r){if(bl=null,n=zf(r),n=Yn(n),n!==null)if(e=mr(n),e===null)n=null;else if(t=e.tag,t===13){if(n=t0(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return bl=n,null}function p0(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VC()){case Pf:return 1;case o0:return 4;case Dl:case BC:return 16;case s0:return 536870912;default:return 16}default:return 16}}var gn=null,Vf=null,ol=null;function m0(){if(ol)return ol;var n,e=Vf,t=e.length,r,i="value"in gn?gn.value:gn.textContent,o=i.length;for(n=0;n<t&&e[n]===i[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===i[o-r];r++);return ol=i.slice(n,1<r?1-r:void 0)}function sl(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ms(){return!0}function rp(){return!1}function it(n){function e(t,r,i,o,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ms:rp,this.isPropagationStopped=rp,this}return G(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ms)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ms)},persist:function(){},isPersistent:Ms}),e}var yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bf=it(yi),rs=G({},yi,{view:0,detail:0}),ZC=it(rs),Xa,Za,Ni,ia=G({},rs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jf,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ni&&(Ni&&n.type==="mousemove"?(Xa=n.screenX-Ni.screenX,Za=n.screenY-Ni.screenY):Za=Xa=0,Ni=n),Xa)},movementY:function(n){return"movementY"in n?n.movementY:Za}}),ip=it(ia),eN=G({},ia,{dataTransfer:0}),tN=it(eN),nN=G({},rs,{relatedTarget:0}),eu=it(nN),rN=G({},yi,{animationName:0,elapsedTime:0,pseudoElement:0}),iN=it(rN),oN=G({},yi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),sN=it(oN),lN=G({},yi,{data:0}),op=it(lN),aN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},uN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fN(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=cN[n])?!!e[n]:!1}function Jf(){return fN}var dN=G({},rs,{key:function(n){if(n.key){var e=aN[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=sl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?uN[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jf,charCode:function(n){return n.type==="keypress"?sl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?sl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hN=it(dN),pN=G({},ia,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sp=it(pN),mN=G({},rs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jf}),gN=it(mN),yN=G({},yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),SN=it(yN),wN=G({},ia,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),kN=it(wN),vN=[9,13,27,32],_f=Yt&&"CompositionEvent"in window,ao=null;Yt&&"documentMode"in document&&(ao=document.documentMode);var xN=Yt&&"TextEvent"in window&&!ao,g0=Yt&&(!_f||ao&&8<ao&&11>=ao),lp=" ",ap=!1;function y0(n,e){switch(n){case"keyup":return vN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S0(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Rr=!1;function CN(n,e){switch(n){case"compositionend":return S0(e);case"keypress":return e.which!==32?null:(ap=!0,lp);case"textInput":return n=e.data,n===lp&&ap?null:n;default:return null}}function NN(n,e){if(Rr)return n==="compositionend"||!_f&&y0(n,e)?(n=m0(),ol=Vf=gn=null,Rr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return g0&&e.locale!=="ko"?null:e.data;default:return null}}var MN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function up(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!MN[n.type]:e==="textarea"}function w0(n,e,t,r){Yy(r),e=Il(e,"onChange"),0<e.length&&(t=new Bf("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var uo=null,bo=null;function EN(n){R0(n,0)}function oa(n){var e=Ir(n);if(Wy(e))return n}function ON(n,e){if(n==="change")return e}var k0=!1;if(Yt){var tu;if(Yt){var nu="oninput"in document;if(!nu){var cp=document.createElement("div");cp.setAttribute("oninput","return;"),nu=typeof cp.oninput=="function"}tu=nu}else tu=!1;k0=tu&&(!document.documentMode||9<document.documentMode)}function fp(){uo&&(uo.detachEvent("onpropertychange",v0),bo=uo=null)}function v0(n){if(n.propertyName==="value"&&oa(bo)){var e=[];w0(e,bo,n,zf(n)),e0(EN,e)}}function TN(n,e,t){n==="focusin"?(fp(),uo=e,bo=t,uo.attachEvent("onpropertychange",v0)):n==="focusout"&&fp()}function DN(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return oa(bo)}function RN(n,e){if(n==="click")return oa(e)}function AN(n,e){if(n==="input"||n==="change")return oa(e)}function bN(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Nt=typeof Object.is=="function"?Object.is:bN;function Io(n,e){if(Nt(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!tc.call(e,i)||!Nt(n[i],e[i]))return!1}return!0}function dp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function hp(n,e){var t=dp(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=dp(t)}}function x0(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?x0(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function C0(){for(var n=window,e=El();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=El(n.document)}return e}function Wf(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function IN(n){var e=C0(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&x0(t.ownerDocument.documentElement,t)){if(r!==null&&Wf(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!n.extend&&o>r&&(i=r,r=o,o=i),i=hp(t,o);var s=hp(t,r);i&&s&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var zN=Yt&&"documentMode"in document&&11>=document.documentMode,Ar=null,kc=null,co=null,vc=!1;function pp(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;vc||Ar==null||Ar!==El(r)||(r=Ar,"selectionStart"in r&&Wf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),co&&Io(co,r)||(co=r,r=Il(kc,"onSelect"),0<r.length&&(e=new Bf("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Ar)))}function Es(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var br={animationend:Es("Animation","AnimationEnd"),animationiteration:Es("Animation","AnimationIteration"),animationstart:Es("Animation","AnimationStart"),transitionend:Es("Transition","TransitionEnd")},ru={},N0={};Yt&&(N0=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);function sa(n){if(ru[n])return ru[n];if(!br[n])return n;var e=br[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in N0)return ru[n]=e[t];return n}var M0=sa("animationend"),E0=sa("animationiteration"),O0=sa("animationstart"),T0=sa("transitionend"),D0=new Map,mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(n,e){D0.set(n,e),pr(e,[n])}for(var iu=0;iu<mp.length;iu++){var ou=mp[iu],PN=ou.toLowerCase(),FN=ou[0].toUpperCase()+ou.slice(1);In(PN,"on"+FN)}In(M0,"onAnimationEnd");In(E0,"onAnimationIteration");In(O0,"onAnimationStart");In("dblclick","onDoubleClick");In("focusin","onFocus");In("focusout","onBlur");In(T0,"onTransitionEnd");si("onMouseEnter",["mouseout","mouseover"]);si("onMouseLeave",["mouseout","mouseover"]);si("onPointerEnter",["pointerout","pointerover"]);si("onPointerLeave",["pointerout","pointerover"]);pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pr("onBeforeInput",["compositionend","keypress","textInput","paste"]);pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LN=new Set("cancel close invalid load scroll toggle".split(" ").concat(eo));function gp(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,PC(r,e,void 0,n),n.currentTarget=null}function R0(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var l=r[s],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==o&&i.isPropagationStopped())break e;gp(i,l,u),o=a}else for(s=0;s<r.length;s++){if(l=r[s],a=l.instance,u=l.currentTarget,l=l.listener,a!==o&&i.isPropagationStopped())break e;gp(i,l,u),o=a}}}if(Tl)throw n=gc,Tl=!1,gc=null,n}function j(n,e){var t=e[Ec];t===void 0&&(t=e[Ec]=new Set);var r=n+"__bubble";t.has(r)||(A0(e,n,2,!1),t.add(r))}function su(n,e,t){var r=0;e&&(r|=4),A0(t,n,r,e)}var Os="_reactListening"+Math.random().toString(36).slice(2);function zo(n){if(!n[Os]){n[Os]=!0,$y.forEach(function(t){t!=="selectionchange"&&(LN.has(t)||su(t,!1,n),su(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Os]||(e[Os]=!0,su("selectionchange",!1,e))}}function A0(n,e,t,r){switch(p0(e)){case 1:var i=GC;break;case 4:i=XC;break;default:i=$f}t=i.bind(null,e,t,n),i=void 0,!mc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function lu(n,e,t,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var a=s.tag;if((a===3||a===4)&&(a=s.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Yn(l),s===null)return;if(a=s.tag,a===5||a===6){r=o=s;continue e}l=l.parentNode}}r=r.return}e0(function(){var u=o,c=zf(t),f=[];e:{var d=D0.get(n);if(d!==void 0){var p=Bf,h=n;switch(n){case"keypress":if(sl(t)===0)break e;case"keydown":case"keyup":p=hN;break;case"focusin":h="focus",p=eu;break;case"focusout":h="blur",p=eu;break;case"beforeblur":case"afterblur":p=eu;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=ip;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=tN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=gN;break;case M0:case E0:case O0:p=iN;break;case T0:p=SN;break;case"scroll":p=ZC;break;case"wheel":p=kN;break;case"copy":case"cut":case"paste":p=sN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=sp}var m=(e&4)!==0,w=!m&&n==="scroll",g=m?d!==null?d+"Capture":null:d;m=[];for(var y=u,S;y!==null;){S=y;var x=S.stateNode;if(S.tag===5&&x!==null&&(S=x,g!==null&&(x=To(y,g),x!=null&&m.push(Po(y,x,S)))),w)break;y=y.return}0<m.length&&(d=new p(d,h,null,t,c),f.push({event:d,listeners:m}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",d&&t!==hc&&(h=t.relatedTarget||t.fromElement)&&(Yn(h)||h[Gt]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(h=t.relatedTarget||t.toElement,p=u,h=h?Yn(h):null,h!==null&&(w=mr(h),h!==w||h.tag!==5&&h.tag!==6)&&(h=null)):(p=null,h=u),p!==h)){if(m=ip,x="onMouseLeave",g="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(m=sp,x="onPointerLeave",g="onPointerEnter",y="pointer"),w=p==null?d:Ir(p),S=h==null?d:Ir(h),d=new m(x,y+"leave",p,t,c),d.target=w,d.relatedTarget=S,x=null,Yn(c)===u&&(m=new m(g,y+"enter",h,t,c),m.target=S,m.relatedTarget=w,x=m),w=x,p&&h)t:{for(m=p,g=h,y=0,S=m;S;S=kr(S))y++;for(S=0,x=g;x;x=kr(x))S++;for(;0<y-S;)m=kr(m),y--;for(;0<S-y;)g=kr(g),S--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=kr(m),g=kr(g)}m=null}else m=null;p!==null&&yp(f,d,p,m,!1),h!==null&&w!==null&&yp(f,w,h,m,!0)}}e:{if(d=u?Ir(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var M=ON;else if(up(d))if(k0)M=AN;else{M=DN;var N=TN}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(M=RN);if(M&&(M=M(n,u))){w0(f,M,t,c);break e}N&&N(n,d,u),n==="focusout"&&(N=d._wrapperState)&&N.controlled&&d.type==="number"&&ac(d,"number",d.value)}switch(N=u?Ir(u):window,n){case"focusin":(up(N)||N.contentEditable==="true")&&(Ar=N,kc=u,co=null);break;case"focusout":co=kc=Ar=null;break;case"mousedown":vc=!0;break;case"contextmenu":case"mouseup":case"dragend":vc=!1,pp(f,t,c);break;case"selectionchange":if(zN)break;case"keydown":case"keyup":pp(f,t,c)}var O;if(_f)e:{switch(n){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Rr?y0(n,t)&&(T="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(g0&&t.locale!=="ko"&&(Rr||T!=="onCompositionStart"?T==="onCompositionEnd"&&Rr&&(O=m0()):(gn=c,Vf="value"in gn?gn.value:gn.textContent,Rr=!0)),N=Il(u,T),0<N.length&&(T=new op(T,n,null,t,c),f.push({event:T,listeners:N}),O?T.data=O:(O=S0(t),O!==null&&(T.data=O)))),(O=xN?CN(n,t):NN(n,t))&&(u=Il(u,"onBeforeInput"),0<u.length&&(c=new op("onBeforeInput","beforeinput",null,t,c),f.push({event:c,listeners:u}),c.data=O))}R0(f,e)})}function Po(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Il(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=To(n,t),o!=null&&r.unshift(Po(n,o,i)),o=To(n,e),o!=null&&r.push(Po(n,o,i))),n=n.return}return r}function kr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function yp(n,e,t,r,i){for(var o=e._reactName,s=[];t!==null&&t!==r;){var l=t,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=To(t,o),a!=null&&s.unshift(Po(t,a,l))):i||(a=To(t,o),a!=null&&s.push(Po(t,a,l)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var $N=/\r\n?/g,VN=/\u0000|\uFFFD/g;function Sp(n){return(typeof n=="string"?n:""+n).replace($N,`
`).replace(VN,"")}function Ts(n,e,t){if(e=Sp(e),Sp(n)!==e&&t)throw Error(E(425))}function zl(){}var xc=null,Cc=null;function Nc(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Mc=typeof setTimeout=="function"?setTimeout:void 0,BN=typeof clearTimeout=="function"?clearTimeout:void 0,wp=typeof Promise=="function"?Promise:void 0,JN=typeof queueMicrotask=="function"?queueMicrotask:typeof wp<"u"?function(n){return wp.resolve(null).then(n).catch(_N)}:Mc;function _N(n){setTimeout(function(){throw n})}function au(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Ao(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Ao(e)}function Cn(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function kp(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Si=Math.random().toString(36).slice(2),Tt="__reactFiber$"+Si,Fo="__reactProps$"+Si,Gt="__reactContainer$"+Si,Ec="__reactEvents$"+Si,WN="__reactListeners$"+Si,UN="__reactHandles$"+Si;function Yn(n){var e=n[Tt];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Gt]||t[Tt]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=kp(n);n!==null;){if(t=n[Tt])return t;n=kp(n)}return e}n=t,t=n.parentNode}return null}function is(n){return n=n[Tt]||n[Gt],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ir(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(E(33))}function la(n){return n[Fo]||null}var Oc=[],zr=-1;function zn(n){return{current:n}}function K(n){0>zr||(n.current=Oc[zr],Oc[zr]=null,zr--)}function H(n,e){zr++,Oc[zr]=n.current,n.current=e}var Rn={},Oe=zn(Rn),Ue=zn(!1),lr=Rn;function li(n,e){var t=n.type.contextTypes;if(!t)return Rn;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in t)i[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function He(n){return n=n.childContextTypes,n!=null}function Pl(){K(Ue),K(Oe)}function vp(n,e,t){if(Oe.current!==Rn)throw Error(E(168));H(Oe,e),H(Ue,t)}function b0(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(E(108,TC(n)||"Unknown",i));return G({},t,r)}function Fl(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Rn,lr=Oe.current,H(Oe,n),H(Ue,Ue.current),!0}function xp(n,e,t){var r=n.stateNode;if(!r)throw Error(E(169));t?(n=b0(n,e,lr),r.__reactInternalMemoizedMergedChildContext=n,K(Ue),K(Oe),H(Oe,n)):K(Ue),H(Ue,t)}var Ht=null,aa=!1,uu=!1;function I0(n){Ht===null?Ht=[n]:Ht.push(n)}function HN(n){aa=!0,I0(n)}function Pn(){if(!uu&&Ht!==null){uu=!0;var n=0,e=U;try{var t=Ht;for(U=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Ht=null,aa=!1}catch(i){throw Ht!==null&&(Ht=Ht.slice(n+1)),i0(Pf,Pn),i}finally{U=e,uu=!1}}return null}var Pr=[],Fr=0,Ll=null,$l=0,st=[],lt=0,ar=null,jt=1,Kt="";function Hn(n,e){Pr[Fr++]=$l,Pr[Fr++]=Ll,Ll=n,$l=e}function z0(n,e,t){st[lt++]=jt,st[lt++]=Kt,st[lt++]=ar,ar=n;var r=jt;n=Kt;var i=32-vt(r)-1;r&=~(1<<i),t+=1;var o=32-vt(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,jt=1<<32-vt(e)+i|t<<i|r,Kt=o+n}else jt=1<<o|t<<i|r,Kt=n}function Uf(n){n.return!==null&&(Hn(n,1),z0(n,1,0))}function Hf(n){for(;n===Ll;)Ll=Pr[--Fr],Pr[Fr]=null,$l=Pr[--Fr],Pr[Fr]=null;for(;n===ar;)ar=st[--lt],st[lt]=null,Kt=st[--lt],st[lt]=null,jt=st[--lt],st[lt]=null}var tt=null,Ze=null,q=!1,kt=null;function P0(n,e){var t=ct(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Cp(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,tt=n,Ze=Cn(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,tt=n,Ze=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ar!==null?{id:jt,overflow:Kt}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ct(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,tt=n,Ze=null,!0):!1;default:return!1}}function Tc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Dc(n){if(q){var e=Ze;if(e){var t=e;if(!Cp(n,e)){if(Tc(n))throw Error(E(418));e=Cn(t.nextSibling);var r=tt;e&&Cp(n,e)?P0(r,t):(n.flags=n.flags&-4097|2,q=!1,tt=n)}}else{if(Tc(n))throw Error(E(418));n.flags=n.flags&-4097|2,q=!1,tt=n}}}function Np(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;tt=n}function Ds(n){if(n!==tt)return!1;if(!q)return Np(n),q=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Nc(n.type,n.memoizedProps)),e&&(e=Ze)){if(Tc(n))throw F0(),Error(E(418));for(;e;)P0(n,e),e=Cn(e.nextSibling)}if(Np(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(E(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Ze=Cn(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Ze=null}}else Ze=tt?Cn(n.stateNode.nextSibling):null;return!0}function F0(){for(var n=Ze;n;)n=Cn(n.nextSibling)}function ai(){Ze=tt=null,q=!1}function jf(n){kt===null?kt=[n]:kt.push(n)}var jN=en.ReactCurrentBatchConfig;function yt(n,e){if(n&&n.defaultProps){e=G({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var Vl=zn(null),Bl=null,Lr=null,Kf=null;function qf(){Kf=Lr=Bl=null}function Qf(n){var e=Vl.current;K(Vl),n._currentValue=e}function Rc(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Kr(n,e){Bl=n,Kf=Lr=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(_e=!0),n.firstContext=null)}function ht(n){var e=n._currentValue;if(Kf!==n)if(n={context:n,memoizedValue:e,next:null},Lr===null){if(Bl===null)throw Error(E(308));Lr=n,Bl.dependencies={lanes:0,firstContext:n}}else Lr=Lr.next=n;return e}var Gn=null;function Yf(n){Gn===null?Gn=[n]:Gn.push(n)}function L0(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Yf(e)):(t.next=i.next,i.next=t),e.interleaved=t,Xt(n,r)}function Xt(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var sn=!1;function Gf(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $0(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Qt(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Nn(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,B&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Xt(n,t)}return i=r.interleaved,i===null?(e.next=e,Yf(r)):(e.next=i.next,i.next=e),r.interleaved=e,Xt(n,t)}function ll(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Ff(n,t)}}function Mp(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?i=o=s:o=o.next=s,t=t.next}while(t!==null);o===null?i=o=e:o=o.next=e}else i=o=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Jl(n,e,t,r){var i=n.updateQueue;sn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,s===null?o=u:s.next=u,s=a;var c=n.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==s&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(o!==null){var f=i.baseState;s=0,c=u=a=null,l=o;do{var d=l.lane,p=l.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var h=n,m=l;switch(d=e,p=t,m.tag){case 1:if(h=m.payload,typeof h=="function"){f=h.call(p,f,d);break e}f=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=m.payload,d=typeof h=="function"?h.call(p,f,d):h,d==null)break e;f=G({},f,d);break e;case 2:sn=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=p,a=f):c=c.next=p,s|=d;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;d=l,l=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);cr|=s,n.lanes=s,n.memoizedState=f}}function Ep(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(E(191,i));i.call(r)}}}var V0=new Ly.Component().refs;function Ac(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:G({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var ua={isMounted:function(n){return(n=n._reactInternals)?mr(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Ae(),i=En(n),o=Qt(r,i);o.payload=e,t!=null&&(o.callback=t),e=Nn(n,o,i),e!==null&&(xt(e,n,i,r),ll(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Ae(),i=En(n),o=Qt(r,i);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=Nn(n,o,i),e!==null&&(xt(e,n,i,r),ll(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Ae(),r=En(n),i=Qt(t,r);i.tag=2,e!=null&&(i.callback=e),e=Nn(n,i,r),e!==null&&(xt(e,n,r,t),ll(e,n,r))}};function Op(n,e,t,r,i,o,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Io(t,r)||!Io(i,o):!0}function B0(n,e,t){var r=!1,i=Rn,o=e.contextType;return typeof o=="object"&&o!==null?o=ht(o):(i=He(e)?lr:Oe.current,r=e.contextTypes,o=(r=r!=null)?li(n,i):Rn),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ua,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=o),e}function Tp(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&ua.enqueueReplaceState(e,e.state,null)}function bc(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=V0,Gf(n);var o=e.contextType;typeof o=="object"&&o!==null?i.context=ht(o):(o=He(e)?lr:Oe.current,i.context=li(n,o)),i.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Ac(n,e,o,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ua.enqueueReplaceState(i,i.state,null),Jl(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Mi(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(E(309));var r=t.stateNode}if(!r)throw Error(E(147,n));var i=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var l=i.refs;l===V0&&(l=i.refs={}),s===null?delete l[o]:l[o]=s},e._stringRef=o,e)}if(typeof n!="string")throw Error(E(284));if(!t._owner)throw Error(E(290,n))}return n}function Rs(n,e){throw n=Object.prototype.toString.call(e),Error(E(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function Dp(n){var e=n._init;return e(n._payload)}function J0(n){function e(g,y){if(n){var S=g.deletions;S===null?(g.deletions=[y],g.flags|=16):S.push(y)}}function t(g,y){if(!n)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=On(g,y),g.index=0,g.sibling=null,g}function o(g,y,S){return g.index=S,n?(S=g.alternate,S!==null?(S=S.index,S<y?(g.flags|=2,y):S):(g.flags|=2,y)):(g.flags|=1048576,y)}function s(g){return n&&g.alternate===null&&(g.flags|=2),g}function l(g,y,S,x){return y===null||y.tag!==6?(y=gu(S,g.mode,x),y.return=g,y):(y=i(y,S),y.return=g,y)}function a(g,y,S,x){var M=S.type;return M===Dr?c(g,y,S.props.children,x,S.key):y!==null&&(y.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===on&&Dp(M)===y.type)?(x=i(y,S.props),x.ref=Mi(g,y,S),x.return=g,x):(x=hl(S.type,S.key,S.props,null,g.mode,x),x.ref=Mi(g,y,S),x.return=g,x)}function u(g,y,S,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==S.containerInfo||y.stateNode.implementation!==S.implementation?(y=yu(S,g.mode,x),y.return=g,y):(y=i(y,S.children||[]),y.return=g,y)}function c(g,y,S,x,M){return y===null||y.tag!==7?(y=ir(S,g.mode,x,M),y.return=g,y):(y=i(y,S),y.return=g,y)}function f(g,y,S){if(typeof y=="string"&&y!==""||typeof y=="number")return y=gu(""+y,g.mode,S),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ws:return S=hl(y.type,y.key,y.props,null,g.mode,S),S.ref=Mi(g,null,y),S.return=g,S;case Tr:return y=yu(y,g.mode,S),y.return=g,y;case on:var x=y._init;return f(g,x(y._payload),S)}if(Xi(y)||ki(y))return y=ir(y,g.mode,S,null),y.return=g,y;Rs(g,y)}return null}function d(g,y,S,x){var M=y!==null?y.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return M!==null?null:l(g,y,""+S,x);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ws:return S.key===M?a(g,y,S,x):null;case Tr:return S.key===M?u(g,y,S,x):null;case on:return M=S._init,d(g,y,M(S._payload),x)}if(Xi(S)||ki(S))return M!==null?null:c(g,y,S,x,null);Rs(g,S)}return null}function p(g,y,S,x,M){if(typeof x=="string"&&x!==""||typeof x=="number")return g=g.get(S)||null,l(y,g,""+x,M);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ws:return g=g.get(x.key===null?S:x.key)||null,a(y,g,x,M);case Tr:return g=g.get(x.key===null?S:x.key)||null,u(y,g,x,M);case on:var N=x._init;return p(g,y,S,N(x._payload),M)}if(Xi(x)||ki(x))return g=g.get(S)||null,c(y,g,x,M,null);Rs(y,x)}return null}function h(g,y,S,x){for(var M=null,N=null,O=y,T=y=0,b=null;O!==null&&T<S.length;T++){O.index>T?(b=O,O=null):b=O.sibling;var z=d(g,O,S[T],x);if(z===null){O===null&&(O=b);break}n&&O&&z.alternate===null&&e(g,O),y=o(z,y,T),N===null?M=z:N.sibling=z,N=z,O=b}if(T===S.length)return t(g,O),q&&Hn(g,T),M;if(O===null){for(;T<S.length;T++)O=f(g,S[T],x),O!==null&&(y=o(O,y,T),N===null?M=O:N.sibling=O,N=O);return q&&Hn(g,T),M}for(O=r(g,O);T<S.length;T++)b=p(O,g,T,S[T],x),b!==null&&(n&&b.alternate!==null&&O.delete(b.key===null?T:b.key),y=o(b,y,T),N===null?M=b:N.sibling=b,N=b);return n&&O.forEach(function(ae){return e(g,ae)}),q&&Hn(g,T),M}function m(g,y,S,x){var M=ki(S);if(typeof M!="function")throw Error(E(150));if(S=M.call(S),S==null)throw Error(E(151));for(var N=M=null,O=y,T=y=0,b=null,z=S.next();O!==null&&!z.done;T++,z=S.next()){O.index>T?(b=O,O=null):b=O.sibling;var ae=d(g,O,z.value,x);if(ae===null){O===null&&(O=b);break}n&&O&&ae.alternate===null&&e(g,O),y=o(ae,y,T),N===null?M=ae:N.sibling=ae,N=ae,O=b}if(z.done)return t(g,O),q&&Hn(g,T),M;if(O===null){for(;!z.done;T++,z=S.next())z=f(g,z.value,x),z!==null&&(y=o(z,y,T),N===null?M=z:N.sibling=z,N=z);return q&&Hn(g,T),M}for(O=r(g,O);!z.done;T++,z=S.next())z=p(O,g,T,z.value,x),z!==null&&(n&&z.alternate!==null&&O.delete(z.key===null?T:z.key),y=o(z,y,T),N===null?M=z:N.sibling=z,N=z);return n&&O.forEach(function(Mt){return e(g,Mt)}),q&&Hn(g,T),M}function w(g,y,S,x){if(typeof S=="object"&&S!==null&&S.type===Dr&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case ws:e:{for(var M=S.key,N=y;N!==null;){if(N.key===M){if(M=S.type,M===Dr){if(N.tag===7){t(g,N.sibling),y=i(N,S.props.children),y.return=g,g=y;break e}}else if(N.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===on&&Dp(M)===N.type){t(g,N.sibling),y=i(N,S.props),y.ref=Mi(g,N,S),y.return=g,g=y;break e}t(g,N);break}else e(g,N);N=N.sibling}S.type===Dr?(y=ir(S.props.children,g.mode,x,S.key),y.return=g,g=y):(x=hl(S.type,S.key,S.props,null,g.mode,x),x.ref=Mi(g,y,S),x.return=g,g=x)}return s(g);case Tr:e:{for(N=S.key;y!==null;){if(y.key===N)if(y.tag===4&&y.stateNode.containerInfo===S.containerInfo&&y.stateNode.implementation===S.implementation){t(g,y.sibling),y=i(y,S.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=yu(S,g.mode,x),y.return=g,g=y}return s(g);case on:return N=S._init,w(g,y,N(S._payload),x)}if(Xi(S))return h(g,y,S,x);if(ki(S))return m(g,y,S,x);Rs(g,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,y!==null&&y.tag===6?(t(g,y.sibling),y=i(y,S),y.return=g,g=y):(t(g,y),y=gu(S,g.mode,x),y.return=g,g=y),s(g)):t(g,y)}return w}var ui=J0(!0),_0=J0(!1),ss={},It=zn(ss),Lo=zn(ss),$o=zn(ss);function Xn(n){if(n===ss)throw Error(E(174));return n}function Xf(n,e){switch(H($o,e),H(Lo,n),H(It,ss),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:cc(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=cc(e,n)}K(It),H(It,e)}function ci(){K(It),K(Lo),K($o)}function W0(n){Xn($o.current);var e=Xn(It.current),t=cc(e,n.type);e!==t&&(H(Lo,n),H(It,t))}function Zf(n){Lo.current===n&&(K(It),K(Lo))}var Q=zn(0);function _l(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cu=[];function ed(){for(var n=0;n<cu.length;n++)cu[n]._workInProgressVersionPrimary=null;cu.length=0}var al=en.ReactCurrentDispatcher,fu=en.ReactCurrentBatchConfig,ur=0,Y=null,se=null,ce=null,Wl=!1,fo=!1,Vo=0,KN=0;function ve(){throw Error(E(321))}function td(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Nt(n[t],e[t]))return!1;return!0}function nd(n,e,t,r,i,o){if(ur=o,Y=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,al.current=n===null||n.memoizedState===null?GN:XN,n=t(r,i),fo){o=0;do{if(fo=!1,Vo=0,25<=o)throw Error(E(301));o+=1,ce=se=null,e.updateQueue=null,al.current=ZN,n=t(r,i)}while(fo)}if(al.current=Ul,e=se!==null&&se.next!==null,ur=0,ce=se=Y=null,Wl=!1,e)throw Error(E(300));return n}function rd(){var n=Vo!==0;return Vo=0,n}function Ot(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ce===null?Y.memoizedState=ce=n:ce=ce.next=n,ce}function pt(){if(se===null){var n=Y.alternate;n=n!==null?n.memoizedState:null}else n=se.next;var e=ce===null?Y.memoizedState:ce.next;if(e!==null)ce=e,se=n;else{if(n===null)throw Error(E(310));se=n,n={memoizedState:se.memoizedState,baseState:se.baseState,baseQueue:se.baseQueue,queue:se.queue,next:null},ce===null?Y.memoizedState=ce=n:ce=ce.next=n}return ce}function Bo(n,e){return typeof e=="function"?e(n):e}function du(n){var e=pt(),t=e.queue;if(t===null)throw Error(E(311));t.lastRenderedReducer=n;var r=se,i=r.baseQueue,o=t.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,t.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,a=null,u=o;do{var c=u.lane;if((ur&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,s=r):a=a.next=f,Y.lanes|=c,cr|=c}u=u.next}while(u!==null&&u!==o);a===null?s=r:a.next=l,Nt(r,e.memoizedState)||(_e=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do o=i.lane,Y.lanes|=o,cr|=o,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function hu(n){var e=pt(),t=e.queue;if(t===null)throw Error(E(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,o=e.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do o=n(o,s.action),s=s.next;while(s!==i);Nt(o,e.memoizedState)||(_e=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function U0(){}function H0(n,e){var t=Y,r=pt(),i=e(),o=!Nt(r.memoizedState,i);if(o&&(r.memoizedState=i,_e=!0),r=r.queue,id(q0.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||ce!==null&&ce.memoizedState.tag&1){if(t.flags|=2048,Jo(9,K0.bind(null,t,r,i,e),void 0,null),de===null)throw Error(E(349));ur&30||j0(t,e,i)}return i}function j0(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Y.updateQueue,e===null?(e={lastEffect:null,stores:null},Y.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function K0(n,e,t,r){e.value=t,e.getSnapshot=r,Q0(e)&&Y0(n)}function q0(n,e,t){return t(function(){Q0(e)&&Y0(n)})}function Q0(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Nt(n,t)}catch{return!0}}function Y0(n){var e=Xt(n,1);e!==null&&xt(e,n,1,-1)}function Rp(n){var e=Ot();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:n},e.queue=n,n=n.dispatch=YN.bind(null,Y,n),[e.memoizedState,n]}function Jo(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Y.updateQueue,e===null?(e={lastEffect:null,stores:null},Y.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function G0(){return pt().memoizedState}function ul(n,e,t,r){var i=Ot();Y.flags|=n,i.memoizedState=Jo(1|e,t,void 0,r===void 0?null:r)}function ca(n,e,t,r){var i=pt();r=r===void 0?null:r;var o=void 0;if(se!==null){var s=se.memoizedState;if(o=s.destroy,r!==null&&td(r,s.deps)){i.memoizedState=Jo(e,t,o,r);return}}Y.flags|=n,i.memoizedState=Jo(1|e,t,o,r)}function Ap(n,e){return ul(8390656,8,n,e)}function id(n,e){return ca(2048,8,n,e)}function X0(n,e){return ca(4,2,n,e)}function Z0(n,e){return ca(4,4,n,e)}function e1(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function t1(n,e,t){return t=t!=null?t.concat([n]):null,ca(4,4,e1.bind(null,e,n),t)}function od(){}function n1(n,e){var t=pt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&td(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function r1(n,e){var t=pt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&td(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function i1(n,e,t){return ur&21?(Nt(t,e)||(t=l0(),Y.lanes|=t,cr|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,_e=!0),n.memoizedState=t)}function qN(n,e){var t=U;U=t!==0&&4>t?t:4,n(!0);var r=fu.transition;fu.transition={};try{n(!1),e()}finally{U=t,fu.transition=r}}function o1(){return pt().memoizedState}function QN(n,e,t){var r=En(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},s1(n))l1(e,t);else if(t=L0(n,e,t,r),t!==null){var i=Ae();xt(t,n,r,i),a1(t,e,r)}}function YN(n,e,t){var r=En(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(s1(n))l1(e,i);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,l=o(s,t);if(i.hasEagerState=!0,i.eagerState=l,Nt(l,s)){var a=e.interleaved;a===null?(i.next=i,Yf(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}t=L0(n,e,i,r),t!==null&&(i=Ae(),xt(t,n,r,i),a1(t,e,r))}}function s1(n){var e=n.alternate;return n===Y||e!==null&&e===Y}function l1(n,e){fo=Wl=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function a1(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Ff(n,t)}}var Ul={readContext:ht,useCallback:ve,useContext:ve,useEffect:ve,useImperativeHandle:ve,useInsertionEffect:ve,useLayoutEffect:ve,useMemo:ve,useReducer:ve,useRef:ve,useState:ve,useDebugValue:ve,useDeferredValue:ve,useTransition:ve,useMutableSource:ve,useSyncExternalStore:ve,useId:ve,unstable_isNewReconciler:!1},GN={readContext:ht,useCallback:function(n,e){return Ot().memoizedState=[n,e===void 0?null:e],n},useContext:ht,useEffect:Ap,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,ul(4194308,4,e1.bind(null,e,n),t)},useLayoutEffect:function(n,e){return ul(4194308,4,n,e)},useInsertionEffect:function(n,e){return ul(4,2,n,e)},useMemo:function(n,e){var t=Ot();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Ot();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=QN.bind(null,Y,n),[r.memoizedState,n]},useRef:function(n){var e=Ot();return n={current:n},e.memoizedState=n},useState:Rp,useDebugValue:od,useDeferredValue:function(n){return Ot().memoizedState=n},useTransition:function(){var n=Rp(!1),e=n[0];return n=qN.bind(null,n[1]),Ot().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Y,i=Ot();if(q){if(t===void 0)throw Error(E(407));t=t()}else{if(t=e(),de===null)throw Error(E(349));ur&30||j0(r,e,t)}i.memoizedState=t;var o={value:t,getSnapshot:e};return i.queue=o,Ap(q0.bind(null,r,o,n),[n]),r.flags|=2048,Jo(9,K0.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=Ot(),e=de.identifierPrefix;if(q){var t=Kt,r=jt;t=(r&~(1<<32-vt(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Vo++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=KN++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},XN={readContext:ht,useCallback:n1,useContext:ht,useEffect:id,useImperativeHandle:t1,useInsertionEffect:X0,useLayoutEffect:Z0,useMemo:r1,useReducer:du,useRef:G0,useState:function(){return du(Bo)},useDebugValue:od,useDeferredValue:function(n){var e=pt();return i1(e,se.memoizedState,n)},useTransition:function(){var n=du(Bo)[0],e=pt().memoizedState;return[n,e]},useMutableSource:U0,useSyncExternalStore:H0,useId:o1,unstable_isNewReconciler:!1},ZN={readContext:ht,useCallback:n1,useContext:ht,useEffect:id,useImperativeHandle:t1,useInsertionEffect:X0,useLayoutEffect:Z0,useMemo:r1,useReducer:hu,useRef:G0,useState:function(){return hu(Bo)},useDebugValue:od,useDeferredValue:function(n){var e=pt();return se===null?e.memoizedState=n:i1(e,se.memoizedState,n)},useTransition:function(){var n=hu(Bo)[0],e=pt().memoizedState;return[n,e]},useMutableSource:U0,useSyncExternalStore:H0,useId:o1,unstable_isNewReconciler:!1};function fi(n,e){try{var t="",r=e;do t+=OC(r),r=r.return;while(r);var i=t}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:i,digest:null}}function pu(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Ic(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var eM=typeof WeakMap=="function"?WeakMap:Map;function u1(n,e,t){t=Qt(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){jl||(jl=!0,Wc=r),Ic(n,e)},t}function c1(n,e,t){t=Qt(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Ic(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){Ic(n,e),typeof r!="function"&&(Mn===null?Mn=new Set([this]):Mn.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function bp(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new eM;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=pM.bind(null,n,e,t),e.then(n,n))}function Ip(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function zp(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Qt(-1,1),e.tag=2,Nn(t,e,1))),t.lanes|=1),n)}var tM=en.ReactCurrentOwner,_e=!1;function De(n,e,t,r){e.child=n===null?_0(e,null,t,r):ui(e,n.child,t,r)}function Pp(n,e,t,r,i){t=t.render;var o=e.ref;return Kr(e,i),r=nd(n,e,t,r,o,i),t=rd(),n!==null&&!_e?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Zt(n,e,i)):(q&&t&&Uf(e),e.flags|=1,De(n,e,r,i),e.child)}function Fp(n,e,t,r,i){if(n===null){var o=t.type;return typeof o=="function"&&!hd(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,f1(n,e,o,r,i)):(n=hl(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&i)){var s=o.memoizedProps;if(t=t.compare,t=t!==null?t:Io,t(s,r)&&n.ref===e.ref)return Zt(n,e,i)}return e.flags|=1,n=On(o,r),n.ref=e.ref,n.return=e,e.child=n}function f1(n,e,t,r,i){if(n!==null){var o=n.memoizedProps;if(Io(o,r)&&n.ref===e.ref)if(_e=!1,e.pendingProps=r=o,(n.lanes&i)!==0)n.flags&131072&&(_e=!0);else return e.lanes=n.lanes,Zt(n,e,i)}return zc(n,e,t,r,i)}function d1(n,e,t){var r=e.pendingProps,i=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},H(Vr,Ge),Ge|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,H(Vr,Ge),Ge|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,H(Vr,Ge),Ge|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,H(Vr,Ge),Ge|=r;return De(n,e,i,t),e.child}function h1(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function zc(n,e,t,r,i){var o=He(t)?lr:Oe.current;return o=li(e,o),Kr(e,i),t=nd(n,e,t,r,o,i),r=rd(),n!==null&&!_e?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Zt(n,e,i)):(q&&r&&Uf(e),e.flags|=1,De(n,e,t,i),e.child)}function Lp(n,e,t,r,i){if(He(t)){var o=!0;Fl(e)}else o=!1;if(Kr(e,i),e.stateNode===null)cl(n,e),B0(e,t,r),bc(e,t,r,i),r=!0;else if(n===null){var s=e.stateNode,l=e.memoizedProps;s.props=l;var a=s.context,u=t.contextType;typeof u=="object"&&u!==null?u=ht(u):(u=He(t)?lr:Oe.current,u=li(e,u));var c=t.getDerivedStateFromProps,f=typeof c=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||a!==u)&&Tp(e,s,r,u),sn=!1;var d=e.memoizedState;s.state=d,Jl(e,r,s,i),a=e.memoizedState,l!==r||d!==a||Ue.current||sn?(typeof c=="function"&&(Ac(e,t,c,r),a=e.memoizedState),(l=sn||Op(e,t,l,r,d,a,u))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),s.props=r,s.state=a,s.context=u,r=l):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,$0(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:yt(e.type,l),s.props=u,f=e.pendingProps,d=s.context,a=t.contextType,typeof a=="object"&&a!==null?a=ht(a):(a=He(t)?lr:Oe.current,a=li(e,a));var p=t.getDerivedStateFromProps;(c=typeof p=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==f||d!==a)&&Tp(e,s,r,a),sn=!1,d=e.memoizedState,s.state=d,Jl(e,r,s,i);var h=e.memoizedState;l!==f||d!==h||Ue.current||sn?(typeof p=="function"&&(Ac(e,t,p,r),h=e.memoizedState),(u=sn||Op(e,t,u,r,d,h,a)||!1)?(c||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,h,a),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,h,a)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=h),s.props=r,s.state=h,s.context=a,r=u):(typeof s.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return Pc(n,e,t,r,o,i)}function Pc(n,e,t,r,i,o){h1(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&xp(e,t,!1),Zt(n,e,o);r=e.stateNode,tM.current=e;var l=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=ui(e,n.child,null,o),e.child=ui(e,null,l,o)):De(n,e,l,o),e.memoizedState=r.state,i&&xp(e,t,!0),e.child}function p1(n){var e=n.stateNode;e.pendingContext?vp(n,e.pendingContext,e.pendingContext!==e.context):e.context&&vp(n,e.context,!1),Xf(n,e.containerInfo)}function $p(n,e,t,r,i){return ai(),jf(i),e.flags|=256,De(n,e,t,r),e.child}var Fc={dehydrated:null,treeContext:null,retryLane:0};function Lc(n){return{baseLanes:n,cachePool:null,transitions:null}}function m1(n,e,t){var r=e.pendingProps,i=Q.current,o=!1,s=(e.flags&128)!==0,l;if((l=s)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),H(Q,i&1),n===null)return Dc(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ha(s,r,0,null),n=ir(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=Lc(t),e.memoizedState=Fc,n):sd(e,s));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return nM(n,e,s,r,l,i,t);if(o){o=r.fallback,s=e.mode,i=n.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=On(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=On(l,o):(o=ir(o,s,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=n.child.memoizedState,s=s===null?Lc(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=n.childLanes&~t,e.memoizedState=Fc,r}return o=n.child,n=o.sibling,r=On(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function sd(n,e){return e=ha({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function As(n,e,t,r){return r!==null&&jf(r),ui(e,n.child,null,t),n=sd(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function nM(n,e,t,r,i,o,s){if(t)return e.flags&256?(e.flags&=-257,r=pu(Error(E(422))),As(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=ha({mode:"visible",children:r.children},i,0,null),o=ir(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ui(e,n.child,null,s),e.child.memoizedState=Lc(s),e.memoizedState=Fc,o);if(!(e.mode&1))return As(n,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(E(419)),r=pu(o,r,void 0),As(n,e,s,r)}if(l=(s&n.childLanes)!==0,_e||l){if(r=de,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Xt(n,i),xt(r,n,i,-1))}return dd(),r=pu(Error(E(421))),As(n,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=mM.bind(null,n),i._reactRetry=e,null):(n=o.treeContext,Ze=Cn(i.nextSibling),tt=e,q=!0,kt=null,n!==null&&(st[lt++]=jt,st[lt++]=Kt,st[lt++]=ar,jt=n.id,Kt=n.overflow,ar=e),e=sd(e,r.children),e.flags|=4096,e)}function Vp(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Rc(n.return,e,t)}function mu(n,e,t,r,i){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=i)}function g1(n,e,t){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(De(n,e,r.children,t),r=Q.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Vp(n,t,e);else if(n.tag===19)Vp(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(H(Q,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&_l(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),mu(e,!1,i,t,o);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&_l(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}mu(e,!0,t,null,o);break;case"together":mu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cl(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Zt(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),cr|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(E(153));if(e.child!==null){for(n=e.child,t=On(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=On(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function rM(n,e,t){switch(e.tag){case 3:p1(e),ai();break;case 5:W0(e);break;case 1:He(e.type)&&Fl(e);break;case 4:Xf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;H(Vl,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(H(Q,Q.current&1),e.flags|=128,null):t&e.child.childLanes?m1(n,e,t):(H(Q,Q.current&1),n=Zt(n,e,t),n!==null?n.sibling:null);H(Q,Q.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return g1(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),H(Q,Q.current),r)break;return null;case 22:case 23:return e.lanes=0,d1(n,e,t)}return Zt(n,e,t)}var y1,$c,S1,w1;y1=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};$c=function(){};S1=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Xn(It.current);var o=null;switch(t){case"input":i=sc(n,i),r=sc(n,r),o=[];break;case"select":i=G({},i,{value:void 0}),r=G({},r,{value:void 0}),o=[];break;case"textarea":i=uc(n,i),r=uc(n,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=zl)}fc(t,r);var s;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Eo.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(s in l)!l.hasOwnProperty(s)||a&&a.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in a)a.hasOwnProperty(s)&&l[s]!==a[s]&&(t||(t={}),t[s]=a[s])}else t||(o||(o=[]),o.push(u,t)),t=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(o=o||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(o=o||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Eo.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&j("scroll",n),o||l===a||(o=[])):(o=o||[]).push(u,a))}t&&(o=o||[]).push("style",t);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};w1=function(n,e,t,r){t!==r&&(e.flags|=4)};function Ei(n,e){if(!q)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function xe(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function iM(n,e,t){var r=e.pendingProps;switch(Hf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xe(e),null;case 1:return He(e.type)&&Pl(),xe(e),null;case 3:return r=e.stateNode,ci(),K(Ue),K(Oe),ed(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Ds(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kt!==null&&(jc(kt),kt=null))),$c(n,e),xe(e),null;case 5:Zf(e);var i=Xn($o.current);if(t=e.type,n!==null&&e.stateNode!=null)S1(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(E(166));return xe(e),null}if(n=Xn(It.current),Ds(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[Tt]=e,r[Fo]=o,n=(e.mode&1)!==0,t){case"dialog":j("cancel",r),j("close",r);break;case"iframe":case"object":case"embed":j("load",r);break;case"video":case"audio":for(i=0;i<eo.length;i++)j(eo[i],r);break;case"source":j("error",r);break;case"img":case"image":case"link":j("error",r),j("load",r);break;case"details":j("toggle",r);break;case"input":qh(r,o),j("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},j("invalid",r);break;case"textarea":Yh(r,o),j("invalid",r)}fc(t,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Ts(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Ts(r.textContent,l,n),i=["children",""+l]):Eo.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&j("scroll",r)}switch(t){case"input":ks(r),Qh(r,o,!0);break;case"textarea":ks(r),Gh(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=zl)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=jy(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[Tt]=e,n[Fo]=r,y1(n,e,!1,!1),e.stateNode=n;e:{switch(s=dc(t,r),t){case"dialog":j("cancel",n),j("close",n),i=r;break;case"iframe":case"object":case"embed":j("load",n),i=r;break;case"video":case"audio":for(i=0;i<eo.length;i++)j(eo[i],n);i=r;break;case"source":j("error",n),i=r;break;case"img":case"image":case"link":j("error",n),j("load",n),i=r;break;case"details":j("toggle",n),i=r;break;case"input":qh(n,r),i=sc(n,r),j("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=G({},r,{value:void 0}),j("invalid",n);break;case"textarea":Yh(n,r),i=uc(n,r),j("invalid",n);break;default:i=r}fc(t,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var a=l[o];o==="style"?Qy(n,a):o==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&Ky(n,a)):o==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&Oo(n,a):typeof a=="number"&&Oo(n,""+a):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Eo.hasOwnProperty(o)?a!=null&&o==="onScroll"&&j("scroll",n):a!=null&&Rf(n,o,a,s))}switch(t){case"input":ks(n),Qh(n,r,!1);break;case"textarea":ks(n),Gh(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Dn(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?Wr(n,!!r.multiple,o,!1):r.defaultValue!=null&&Wr(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=zl)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xe(e),null;case 6:if(n&&e.stateNode!=null)w1(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(E(166));if(t=Xn($o.current),Xn(It.current),Ds(e)){if(r=e.stateNode,t=e.memoizedProps,r[Tt]=e,(o=r.nodeValue!==t)&&(n=tt,n!==null))switch(n.tag){case 3:Ts(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ts(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Tt]=e,e.stateNode=r}return xe(e),null;case 13:if(K(Q),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(q&&Ze!==null&&e.mode&1&&!(e.flags&128))F0(),ai(),e.flags|=98560,o=!1;else if(o=Ds(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(E(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(E(317));o[Tt]=e}else ai(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xe(e),o=!1}else kt!==null&&(jc(kt),kt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Q.current&1?le===0&&(le=3):dd())),e.updateQueue!==null&&(e.flags|=4),xe(e),null);case 4:return ci(),$c(n,e),n===null&&zo(e.stateNode.containerInfo),xe(e),null;case 10:return Qf(e.type._context),xe(e),null;case 17:return He(e.type)&&Pl(),xe(e),null;case 19:if(K(Q),o=e.memoizedState,o===null)return xe(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Ei(o,!1);else{if(le!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=_l(n),s!==null){for(e.flags|=128,Ei(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return H(Q,Q.current&1|2),e.child}n=n.sibling}o.tail!==null&&te()>di&&(e.flags|=128,r=!0,Ei(o,!1),e.lanes=4194304)}else{if(!r)if(n=_l(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ei(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!q)return xe(e),null}else 2*te()-o.renderingStartTime>di&&t!==1073741824&&(e.flags|=128,r=!0,Ei(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(t=o.last,t!==null?t.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=te(),e.sibling=null,t=Q.current,H(Q,r?t&1|2:t&1),e):(xe(e),null);case 22:case 23:return fd(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ge&1073741824&&(xe(e),e.subtreeFlags&6&&(e.flags|=8192)):xe(e),null;case 24:return null;case 25:return null}throw Error(E(156,e.tag))}function oM(n,e){switch(Hf(e),e.tag){case 1:return He(e.type)&&Pl(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ci(),K(Ue),K(Oe),ed(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Zf(e),null;case 13:if(K(Q),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(E(340));ai()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return K(Q),null;case 4:return ci(),null;case 10:return Qf(e.type._context),null;case 22:case 23:return fd(),null;case 24:return null;default:return null}}var bs=!1,Ne=!1,sM=typeof WeakSet=="function"?WeakSet:Set,A=null;function $r(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){X(n,e,r)}else t.current=null}function Vc(n,e,t){try{t()}catch(r){X(n,e,r)}}var Bp=!1;function lM(n,e){if(xc=Al,n=C0(),Wf(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var s=0,l=-1,a=-1,u=0,c=0,f=n,d=null;t:for(;;){for(var p;f!==t||i!==0&&f.nodeType!==3||(l=s+i),f!==o||r!==0&&f.nodeType!==3||(a=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===n)break t;if(d===t&&++u===i&&(l=s),d===o&&++c===r&&(a=s),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}t=l===-1||a===-1?null:{start:l,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(Cc={focusedElem:n,selectionRange:t},Al=!1,A=e;A!==null;)if(e=A,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,A=n;else for(;A!==null;){e=A;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var m=h.memoizedProps,w=h.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:yt(e.type,m),w);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(E(163))}}catch(x){X(e,e.return,x)}if(n=e.sibling,n!==null){n.return=e.return,A=n;break}A=e.return}return h=Bp,Bp=!1,h}function ho(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var o=i.destroy;i.destroy=void 0,o!==void 0&&Vc(e,t,o)}i=i.next}while(i!==r)}}function fa(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Bc(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function k1(n){var e=n.alternate;e!==null&&(n.alternate=null,k1(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Tt],delete e[Fo],delete e[Ec],delete e[WN],delete e[UN])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function v1(n){return n.tag===5||n.tag===3||n.tag===4}function Jp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||v1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Jc(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=zl));else if(r!==4&&(n=n.child,n!==null))for(Jc(n,e,t),n=n.sibling;n!==null;)Jc(n,e,t),n=n.sibling}function _c(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(_c(n,e,t),n=n.sibling;n!==null;)_c(n,e,t),n=n.sibling}var me=null,St=!1;function tn(n,e,t){for(t=t.child;t!==null;)x1(n,e,t),t=t.sibling}function x1(n,e,t){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(ra,t)}catch{}switch(t.tag){case 5:Ne||$r(t,e);case 6:var r=me,i=St;me=null,tn(n,e,t),me=r,St=i,me!==null&&(St?(n=me,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):me.removeChild(t.stateNode));break;case 18:me!==null&&(St?(n=me,t=t.stateNode,n.nodeType===8?au(n.parentNode,t):n.nodeType===1&&au(n,t),Ao(n)):au(me,t.stateNode));break;case 4:r=me,i=St,me=t.stateNode.containerInfo,St=!0,tn(n,e,t),me=r,St=i;break;case 0:case 11:case 14:case 15:if(!Ne&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Vc(t,e,s),i=i.next}while(i!==r)}tn(n,e,t);break;case 1:if(!Ne&&($r(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){X(t,e,l)}tn(n,e,t);break;case 21:tn(n,e,t);break;case 22:t.mode&1?(Ne=(r=Ne)||t.memoizedState!==null,tn(n,e,t),Ne=r):tn(n,e,t);break;default:tn(n,e,t)}}function _p(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new sM),e.forEach(function(r){var i=gM.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function gt(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var o=n,s=e,l=s;e:for(;l!==null;){switch(l.tag){case 5:me=l.stateNode,St=!1;break e;case 3:me=l.stateNode.containerInfo,St=!0;break e;case 4:me=l.stateNode.containerInfo,St=!0;break e}l=l.return}if(me===null)throw Error(E(160));x1(o,s,i),me=null,St=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){X(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)C1(e,n),e=e.sibling}function C1(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(gt(e,n),Et(n),r&4){try{ho(3,n,n.return),fa(3,n)}catch(m){X(n,n.return,m)}try{ho(5,n,n.return)}catch(m){X(n,n.return,m)}}break;case 1:gt(e,n),Et(n),r&512&&t!==null&&$r(t,t.return);break;case 5:if(gt(e,n),Et(n),r&512&&t!==null&&$r(t,t.return),n.flags&32){var i=n.stateNode;try{Oo(i,"")}catch(m){X(n,n.return,m)}}if(r&4&&(i=n.stateNode,i!=null)){var o=n.memoizedProps,s=t!==null?t.memoizedProps:o,l=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Uy(i,o),dc(l,s);var u=dc(l,o);for(s=0;s<a.length;s+=2){var c=a[s],f=a[s+1];c==="style"?Qy(i,f):c==="dangerouslySetInnerHTML"?Ky(i,f):c==="children"?Oo(i,f):Rf(i,c,f,u)}switch(l){case"input":lc(i,o);break;case"textarea":Hy(i,o);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Wr(i,!!o.multiple,p,!1):d!==!!o.multiple&&(o.defaultValue!=null?Wr(i,!!o.multiple,o.defaultValue,!0):Wr(i,!!o.multiple,o.multiple?[]:"",!1))}i[Fo]=o}catch(m){X(n,n.return,m)}}break;case 6:if(gt(e,n),Et(n),r&4){if(n.stateNode===null)throw Error(E(162));i=n.stateNode,o=n.memoizedProps;try{i.nodeValue=o}catch(m){X(n,n.return,m)}}break;case 3:if(gt(e,n),Et(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Ao(e.containerInfo)}catch(m){X(n,n.return,m)}break;case 4:gt(e,n),Et(n);break;case 13:gt(e,n),Et(n),i=n.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(ud=te())),r&4&&_p(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ne=(u=Ne)||c,gt(e,n),Ne=u):gt(e,n),Et(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(A=n,c=n.child;c!==null;){for(f=A=c;A!==null;){switch(d=A,p=d.child,d.tag){case 0:case 11:case 14:case 15:ho(4,d,d.return);break;case 1:$r(d,d.return);var h=d.stateNode;if(typeof h.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(m){X(r,t,m)}}break;case 5:$r(d,d.return);break;case 22:if(d.memoizedState!==null){Up(f);continue}}p!==null?(p.return=d,A=p):Up(f)}c=c.sibling}e:for(c=null,f=n;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,a=f.memoizedProps.style,s=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=qy("display",s))}catch(m){X(n,n.return,m)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(m){X(n,n.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gt(e,n),Et(n),r&4&&_p(n);break;case 21:break;default:gt(e,n),Et(n)}}function Et(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(v1(t)){var r=t;break e}t=t.return}throw Error(E(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Oo(i,""),r.flags&=-33);var o=Jp(n);_c(n,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=Jp(n);Jc(n,l,s);break;default:throw Error(E(161))}}catch(a){X(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function aM(n,e,t){A=n,N1(n)}function N1(n,e,t){for(var r=(n.mode&1)!==0;A!==null;){var i=A,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||bs;if(!s){var l=i.alternate,a=l!==null&&l.memoizedState!==null||Ne;l=bs;var u=Ne;if(bs=s,(Ne=a)&&!u)for(A=i;A!==null;)s=A,a=s.child,s.tag===22&&s.memoizedState!==null?Hp(i):a!==null?(a.return=s,A=a):Hp(i);for(;o!==null;)A=o,N1(o),o=o.sibling;A=i,bs=l,Ne=u}Wp(n)}else i.subtreeFlags&8772&&o!==null?(o.return=i,A=o):Wp(n)}}function Wp(n){for(;A!==null;){var e=A;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ne||fa(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ne)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:yt(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Ep(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Ep(e,s,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Ao(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(E(163))}Ne||e.flags&512&&Bc(e)}catch(d){X(e,e.return,d)}}if(e===n){A=null;break}if(t=e.sibling,t!==null){t.return=e.return,A=t;break}A=e.return}}function Up(n){for(;A!==null;){var e=A;if(e===n){A=null;break}var t=e.sibling;if(t!==null){t.return=e.return,A=t;break}A=e.return}}function Hp(n){for(;A!==null;){var e=A;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{fa(4,e)}catch(a){X(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){X(e,i,a)}}var o=e.return;try{Bc(e)}catch(a){X(e,o,a)}break;case 5:var s=e.return;try{Bc(e)}catch(a){X(e,s,a)}}}catch(a){X(e,e.return,a)}if(e===n){A=null;break}var l=e.sibling;if(l!==null){l.return=e.return,A=l;break}A=e.return}}var uM=Math.ceil,Hl=en.ReactCurrentDispatcher,ld=en.ReactCurrentOwner,dt=en.ReactCurrentBatchConfig,B=0,de=null,ie=null,we=0,Ge=0,Vr=zn(0),le=0,_o=null,cr=0,da=0,ad=0,po=null,Le=null,ud=0,di=1/0,Wt=null,jl=!1,Wc=null,Mn=null,Is=!1,yn=null,Kl=0,mo=0,Uc=null,fl=-1,dl=0;function Ae(){return B&6?te():fl!==-1?fl:fl=te()}function En(n){return n.mode&1?B&2&&we!==0?we&-we:jN.transition!==null?(dl===0&&(dl=l0()),dl):(n=U,n!==0||(n=window.event,n=n===void 0?16:p0(n.type)),n):1}function xt(n,e,t,r){if(50<mo)throw mo=0,Uc=null,Error(E(185));ns(n,t,r),(!(B&2)||n!==de)&&(n===de&&(!(B&2)&&(da|=t),le===4&&cn(n,we)),je(n,r),t===1&&B===0&&!(e.mode&1)&&(di=te()+500,aa&&Pn()))}function je(n,e){var t=n.callbackNode;jC(n,e);var r=Rl(n,n===de?we:0);if(r===0)t!==null&&ep(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&ep(t),e===1)n.tag===0?HN(jp.bind(null,n)):I0(jp.bind(null,n)),JN(function(){!(B&6)&&Pn()}),t=null;else{switch(a0(r)){case 1:t=Pf;break;case 4:t=o0;break;case 16:t=Dl;break;case 536870912:t=s0;break;default:t=Dl}t=b1(t,M1.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function M1(n,e){if(fl=-1,dl=0,B&6)throw Error(E(327));var t=n.callbackNode;if(qr()&&n.callbackNode!==t)return null;var r=Rl(n,n===de?we:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=ql(n,r);else{e=r;var i=B;B|=2;var o=O1();(de!==n||we!==e)&&(Wt=null,di=te()+500,rr(n,e));do try{dM();break}catch(l){E1(n,l)}while(!0);qf(),Hl.current=o,B=i,ie!==null?e=0:(de=null,we=0,e=le)}if(e!==0){if(e===2&&(i=yc(n),i!==0&&(r=i,e=Hc(n,i))),e===1)throw t=_o,rr(n,0),cn(n,r),je(n,te()),t;if(e===6)cn(n,r);else{if(i=n.current.alternate,!(r&30)&&!cM(i)&&(e=ql(n,r),e===2&&(o=yc(n),o!==0&&(r=o,e=Hc(n,o))),e===1))throw t=_o,rr(n,0),cn(n,r),je(n,te()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(E(345));case 2:jn(n,Le,Wt);break;case 3:if(cn(n,r),(r&130023424)===r&&(e=ud+500-te(),10<e)){if(Rl(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Ae(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Mc(jn.bind(null,n,Le,Wt),e);break}jn(n,Le,Wt);break;case 4:if(cn(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var s=31-vt(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=te()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*uM(r/1960))-r,10<r){n.timeoutHandle=Mc(jn.bind(null,n,Le,Wt),r);break}jn(n,Le,Wt);break;case 5:jn(n,Le,Wt);break;default:throw Error(E(329))}}}return je(n,te()),n.callbackNode===t?M1.bind(null,n):null}function Hc(n,e){var t=po;return n.current.memoizedState.isDehydrated&&(rr(n,e).flags|=256),n=ql(n,e),n!==2&&(e=Le,Le=t,e!==null&&jc(e)),n}function jc(n){Le===null?Le=n:Le.push.apply(Le,n)}function cM(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],o=i.getSnapshot;i=i.value;try{if(!Nt(o(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function cn(n,e){for(e&=~ad,e&=~da,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-vt(e),r=1<<t;n[t]=-1,e&=~r}}function jp(n){if(B&6)throw Error(E(327));qr();var e=Rl(n,0);if(!(e&1))return je(n,te()),null;var t=ql(n,e);if(n.tag!==0&&t===2){var r=yc(n);r!==0&&(e=r,t=Hc(n,r))}if(t===1)throw t=_o,rr(n,0),cn(n,e),je(n,te()),t;if(t===6)throw Error(E(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,jn(n,Le,Wt),je(n,te()),null}function cd(n,e){var t=B;B|=1;try{return n(e)}finally{B=t,B===0&&(di=te()+500,aa&&Pn())}}function fr(n){yn!==null&&yn.tag===0&&!(B&6)&&qr();var e=B;B|=1;var t=dt.transition,r=U;try{if(dt.transition=null,U=1,n)return n()}finally{U=r,dt.transition=t,B=e,!(B&6)&&Pn()}}function fd(){Ge=Vr.current,K(Vr)}function rr(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,BN(t)),ie!==null)for(t=ie.return;t!==null;){var r=t;switch(Hf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pl();break;case 3:ci(),K(Ue),K(Oe),ed();break;case 5:Zf(r);break;case 4:ci();break;case 13:K(Q);break;case 19:K(Q);break;case 10:Qf(r.type._context);break;case 22:case 23:fd()}t=t.return}if(de=n,ie=n=On(n.current,null),we=Ge=e,le=0,_o=null,ad=da=cr=0,Le=po=null,Gn!==null){for(e=0;e<Gn.length;e++)if(t=Gn[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,o=t.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}t.pending=r}Gn=null}return n}function E1(n,e){do{var t=ie;try{if(qf(),al.current=Ul,Wl){for(var r=Y.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wl=!1}if(ur=0,ce=se=Y=null,fo=!1,Vo=0,ld.current=null,t===null||t.return===null){le=1,_o=e,ie=null;break}e:{var o=n,s=t.return,l=t,a=e;if(e=we,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=Ip(s);if(p!==null){p.flags&=-257,zp(p,s,l,o,e),p.mode&1&&bp(o,u,e),e=p,a=u;var h=e.updateQueue;if(h===null){var m=new Set;m.add(a),e.updateQueue=m}else h.add(a);break e}else{if(!(e&1)){bp(o,u,e),dd();break e}a=Error(E(426))}}else if(q&&l.mode&1){var w=Ip(s);if(w!==null){!(w.flags&65536)&&(w.flags|=256),zp(w,s,l,o,e),jf(fi(a,l));break e}}o=a=fi(a,l),le!==4&&(le=2),po===null?po=[o]:po.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=u1(o,a,e);Mp(o,g);break e;case 1:l=a;var y=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Mn===null||!Mn.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=c1(o,l,e);Mp(o,x);break e}}o=o.return}while(o!==null)}D1(t)}catch(M){e=M,ie===t&&t!==null&&(ie=t=t.return);continue}break}while(!0)}function O1(){var n=Hl.current;return Hl.current=Ul,n===null?Ul:n}function dd(){(le===0||le===3||le===2)&&(le=4),de===null||!(cr&268435455)&&!(da&268435455)||cn(de,we)}function ql(n,e){var t=B;B|=2;var r=O1();(de!==n||we!==e)&&(Wt=null,rr(n,e));do try{fM();break}catch(i){E1(n,i)}while(!0);if(qf(),B=t,Hl.current=r,ie!==null)throw Error(E(261));return de=null,we=0,le}function fM(){for(;ie!==null;)T1(ie)}function dM(){for(;ie!==null&&!LC();)T1(ie)}function T1(n){var e=A1(n.alternate,n,Ge);n.memoizedProps=n.pendingProps,e===null?D1(n):ie=e,ld.current=null}function D1(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=oM(t,e),t!==null){t.flags&=32767,ie=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{le=6,ie=null;return}}else if(t=iM(t,e,Ge),t!==null){ie=t;return}if(e=e.sibling,e!==null){ie=e;return}ie=e=n}while(e!==null);le===0&&(le=5)}function jn(n,e,t){var r=U,i=dt.transition;try{dt.transition=null,U=1,hM(n,e,t,r)}finally{dt.transition=i,U=r}return null}function hM(n,e,t,r){do qr();while(yn!==null);if(B&6)throw Error(E(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(E(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(KC(n,o),n===de&&(ie=de=null,we=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Is||(Is=!0,b1(Dl,function(){return qr(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=dt.transition,dt.transition=null;var s=U;U=1;var l=B;B|=4,ld.current=null,lM(n,t),C1(t,n),IN(Cc),Al=!!xc,Cc=xc=null,n.current=t,aM(t),$C(),B=l,U=s,dt.transition=o}else n.current=t;if(Is&&(Is=!1,yn=n,Kl=i),o=n.pendingLanes,o===0&&(Mn=null),JC(t.stateNode),je(n,te()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(jl)throw jl=!1,n=Wc,Wc=null,n;return Kl&1&&n.tag!==0&&qr(),o=n.pendingLanes,o&1?n===Uc?mo++:(mo=0,Uc=n):mo=0,Pn(),null}function qr(){if(yn!==null){var n=a0(Kl),e=dt.transition,t=U;try{if(dt.transition=null,U=16>n?16:n,yn===null)var r=!1;else{if(n=yn,yn=null,Kl=0,B&6)throw Error(E(331));var i=B;for(B|=4,A=n.current;A!==null;){var o=A,s=o.child;if(A.flags&16){var l=o.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(A=u;A!==null;){var c=A;switch(c.tag){case 0:case 11:case 15:ho(8,c,o)}var f=c.child;if(f!==null)f.return=c,A=f;else for(;A!==null;){c=A;var d=c.sibling,p=c.return;if(k1(c),c===u){A=null;break}if(d!==null){d.return=p,A=d;break}A=p}}}var h=o.alternate;if(h!==null){var m=h.child;if(m!==null){h.child=null;do{var w=m.sibling;m.sibling=null,m=w}while(m!==null)}}A=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,A=s;else e:for(;A!==null;){if(o=A,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ho(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,A=g;break e}A=o.return}}var y=n.current;for(A=y;A!==null;){s=A;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,A=S;else e:for(s=y;A!==null;){if(l=A,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:fa(9,l)}}catch(M){X(l,l.return,M)}if(l===s){A=null;break e}var x=l.sibling;if(x!==null){x.return=l.return,A=x;break e}A=l.return}}if(B=i,Pn(),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(ra,n)}catch{}r=!0}return r}finally{U=t,dt.transition=e}}return!1}function Kp(n,e,t){e=fi(t,e),e=u1(n,e,1),n=Nn(n,e,1),e=Ae(),n!==null&&(ns(n,1,e),je(n,e))}function X(n,e,t){if(n.tag===3)Kp(n,n,t);else for(;e!==null;){if(e.tag===3){Kp(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Mn===null||!Mn.has(r))){n=fi(t,n),n=c1(e,n,1),e=Nn(e,n,1),n=Ae(),e!==null&&(ns(e,1,n),je(e,n));break}}e=e.return}}function pM(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Ae(),n.pingedLanes|=n.suspendedLanes&t,de===n&&(we&t)===t&&(le===4||le===3&&(we&130023424)===we&&500>te()-ud?rr(n,0):ad|=t),je(n,e)}function R1(n,e){e===0&&(n.mode&1?(e=Cs,Cs<<=1,!(Cs&130023424)&&(Cs=4194304)):e=1);var t=Ae();n=Xt(n,e),n!==null&&(ns(n,e,t),je(n,t))}function mM(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),R1(n,t)}function gM(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(E(314))}r!==null&&r.delete(e),R1(n,t)}var A1;A1=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ue.current)_e=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return _e=!1,rM(n,e,t);_e=!!(n.flags&131072)}else _e=!1,q&&e.flags&1048576&&z0(e,$l,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;cl(n,e),n=e.pendingProps;var i=li(e,Oe.current);Kr(e,t),i=nd(null,e,r,n,i,t);var o=rd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,He(r)?(o=!0,Fl(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Gf(e),i.updater=ua,e.stateNode=i,i._reactInternals=e,bc(e,r,n,t),e=Pc(null,e,r,!0,o,t)):(e.tag=0,q&&o&&Uf(e),De(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(cl(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=SM(r),n=yt(r,n),i){case 0:e=zc(null,e,r,n,t);break e;case 1:e=Lp(null,e,r,n,t);break e;case 11:e=Pp(null,e,r,n,t);break e;case 14:e=Fp(null,e,r,yt(r.type,n),t);break e}throw Error(E(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yt(r,i),zc(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yt(r,i),Lp(n,e,r,i,t);case 3:e:{if(p1(e),n===null)throw Error(E(387));r=e.pendingProps,o=e.memoizedState,i=o.element,$0(n,e),Jl(e,r,null,t);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=fi(Error(E(423)),e),e=$p(n,e,r,t,i);break e}else if(r!==i){i=fi(Error(E(424)),e),e=$p(n,e,r,t,i);break e}else for(Ze=Cn(e.stateNode.containerInfo.firstChild),tt=e,q=!0,kt=null,t=_0(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(ai(),r===i){e=Zt(n,e,t);break e}De(n,e,r,t)}e=e.child}return e;case 5:return W0(e),n===null&&Dc(e),r=e.type,i=e.pendingProps,o=n!==null?n.memoizedProps:null,s=i.children,Nc(r,i)?s=null:o!==null&&Nc(r,o)&&(e.flags|=32),h1(n,e),De(n,e,s,t),e.child;case 6:return n===null&&Dc(e),null;case 13:return m1(n,e,t);case 4:return Xf(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ui(e,null,r,t):De(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yt(r,i),Pp(n,e,r,i,t);case 7:return De(n,e,e.pendingProps,t),e.child;case 8:return De(n,e,e.pendingProps.children,t),e.child;case 12:return De(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,H(Vl,r._currentValue),r._currentValue=s,o!==null)if(Nt(o.value,s)){if(o.children===i.children&&!Ue.current){e=Zt(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(o.tag===1){a=Qt(-1,t&-t),a.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),Rc(o.return,t,e),l.lanes|=t;break}a=a.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(E(341));s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Rc(s,t,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}De(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Kr(e,t),i=ht(i),r=r(i),e.flags|=1,De(n,e,r,t),e.child;case 14:return r=e.type,i=yt(r,e.pendingProps),i=yt(r.type,i),Fp(n,e,r,i,t);case 15:return f1(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yt(r,i),cl(n,e),e.tag=1,He(r)?(n=!0,Fl(e)):n=!1,Kr(e,t),B0(e,r,i),bc(e,r,i,t),Pc(null,e,r,!0,n,t);case 19:return g1(n,e,t);case 22:return d1(n,e,t)}throw Error(E(156,e.tag))};function b1(n,e){return i0(n,e)}function yM(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ct(n,e,t,r){return new yM(n,e,t,r)}function hd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function SM(n){if(typeof n=="function")return hd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===bf)return 11;if(n===If)return 14}return 2}function On(n,e){var t=n.alternate;return t===null?(t=ct(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function hl(n,e,t,r,i,o){var s=2;if(r=n,typeof n=="function")hd(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case Dr:return ir(t.children,i,o,e);case Af:s=8,i|=8;break;case nc:return n=ct(12,t,e,i|2),n.elementType=nc,n.lanes=o,n;case rc:return n=ct(13,t,e,i),n.elementType=rc,n.lanes=o,n;case ic:return n=ct(19,t,e,i),n.elementType=ic,n.lanes=o,n;case Jy:return ha(t,i,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Vy:s=10;break e;case By:s=9;break e;case bf:s=11;break e;case If:s=14;break e;case on:s=16,r=null;break e}throw Error(E(130,n==null?n:typeof n,""))}return e=ct(s,t,e,i),e.elementType=n,e.type=r,e.lanes=o,e}function ir(n,e,t,r){return n=ct(7,n,r,e),n.lanes=t,n}function ha(n,e,t,r){return n=ct(22,n,r,e),n.elementType=Jy,n.lanes=t,n.stateNode={isHidden:!1},n}function gu(n,e,t){return n=ct(6,n,null,e),n.lanes=t,n}function yu(n,e,t){return e=ct(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function wM(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ga(0),this.expirationTimes=Ga(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ga(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function pd(n,e,t,r,i,o,s,l,a){return n=new wM(n,e,t,l,a),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ct(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gf(o),n}function kM(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tr,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function I1(n){if(!n)return Rn;n=n._reactInternals;e:{if(mr(n)!==n||n.tag!==1)throw Error(E(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(He(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(E(171))}if(n.tag===1){var t=n.type;if(He(t))return b0(n,t,e)}return e}function z1(n,e,t,r,i,o,s,l,a){return n=pd(t,r,!0,n,i,o,s,l,a),n.context=I1(null),t=n.current,r=Ae(),i=En(t),o=Qt(r,i),o.callback=e??null,Nn(t,o,i),n.current.lanes=i,ns(n,i,r),je(n,r),n}function pa(n,e,t,r){var i=e.current,o=Ae(),s=En(i);return t=I1(t),e.context===null?e.context=t:e.pendingContext=t,e=Qt(o,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Nn(i,e,s),n!==null&&(xt(n,i,s,o),ll(n,i,s)),s}function Ql(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function qp(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function md(n,e){qp(n,e),(n=n.alternate)&&qp(n,e)}function vM(){return null}var P1=typeof reportError=="function"?reportError:function(n){console.error(n)};function gd(n){this._internalRoot=n}ma.prototype.render=gd.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(E(409));pa(n,e,null,null)};ma.prototype.unmount=gd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;fr(function(){pa(null,n,null,null)}),e[Gt]=null}};function ma(n){this._internalRoot=n}ma.prototype.unstable_scheduleHydration=function(n){if(n){var e=f0();n={blockedOn:null,target:n,priority:e};for(var t=0;t<un.length&&e!==0&&e<un[t].priority;t++);un.splice(t,0,n),t===0&&h0(n)}};function yd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ga(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Qp(){}function xM(n,e,t,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var u=Ql(s);o.call(u)}}var s=z1(e,r,n,0,null,!1,!1,"",Qp);return n._reactRootContainer=s,n[Gt]=s.current,zo(n.nodeType===8?n.parentNode:n),fr(),s}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=Ql(a);l.call(u)}}var a=pd(n,0,!1,null,null,!1,!1,"",Qp);return n._reactRootContainer=a,n[Gt]=a.current,zo(n.nodeType===8?n.parentNode:n),fr(function(){pa(e,a,t,r)}),a}function ya(n,e,t,r,i){var o=t._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var a=Ql(s);l.call(a)}}pa(e,s,n,i)}else s=xM(t,e,n,i,r);return Ql(s)}u0=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Zi(e.pendingLanes);t!==0&&(Ff(e,t|1),je(e,te()),!(B&6)&&(di=te()+500,Pn()))}break;case 13:fr(function(){var r=Xt(n,1);if(r!==null){var i=Ae();xt(r,n,1,i)}}),md(n,1)}};Lf=function(n){if(n.tag===13){var e=Xt(n,134217728);if(e!==null){var t=Ae();xt(e,n,134217728,t)}md(n,134217728)}};c0=function(n){if(n.tag===13){var e=En(n),t=Xt(n,e);if(t!==null){var r=Ae();xt(t,n,e,r)}md(n,e)}};f0=function(){return U};d0=function(n,e){var t=U;try{return U=n,e()}finally{U=t}};pc=function(n,e,t){switch(e){case"input":if(lc(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=la(r);if(!i)throw Error(E(90));Wy(r),lc(r,i)}}}break;case"textarea":Hy(n,t);break;case"select":e=t.value,e!=null&&Wr(n,!!t.multiple,e,!1)}};Xy=cd;Zy=fr;var CM={usingClientEntryPoint:!1,Events:[is,Ir,la,Yy,Gy,cd]},Oi={findFiberByHostInstance:Yn,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},NM={bundleType:Oi.bundleType,version:Oi.version,rendererPackageName:Oi.rendererPackageName,rendererConfig:Oi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:en.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=n0(n),n===null?null:n.stateNode},findFiberByHostInstance:Oi.findFiberByHostInstance||vM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zs.isDisabled&&zs.supportsFiber)try{ra=zs.inject(NM),bt=zs}catch{}}rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CM;rt.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yd(e))throw Error(E(200));return kM(n,e,null,t)};rt.createRoot=function(n,e){if(!yd(n))throw Error(E(299));var t=!1,r="",i=P1;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=pd(n,1,!1,null,null,t,!1,r,i),n[Gt]=e.current,zo(n.nodeType===8?n.parentNode:n),new gd(e)};rt.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(E(188)):(n=Object.keys(n).join(","),Error(E(268,n)));return n=n0(e),n=n===null?null:n.stateNode,n};rt.flushSync=function(n){return fr(n)};rt.hydrate=function(n,e,t){if(!ga(e))throw Error(E(200));return ya(null,n,e,!0,t)};rt.hydrateRoot=function(n,e,t){if(!yd(n))throw Error(E(405));var r=t!=null&&t.hydratedSources||null,i=!1,o="",s=P1;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=z1(e,null,n,1,t??null,i,!1,o,s),n[Gt]=e.current,zo(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new ma(e)};rt.render=function(n,e,t){if(!ga(e))throw Error(E(200));return ya(null,n,e,!1,t)};rt.unmountComponentAtNode=function(n){if(!ga(n))throw Error(E(40));return n._reactRootContainer?(fr(function(){ya(null,null,n,!1,function(){n._reactRootContainer=null,n[Gt]=null})}),!0):!1};rt.unstable_batchedUpdates=cd;rt.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!ga(t))throw Error(E(200));if(n==null||n._reactInternals===void 0)throw Error(E(38));return ya(n,e,t,!1,r)};rt.version="18.2.0-next-9e3b772b8-20220608";function F1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F1)}catch(n){console.error(n)}}F1(),zy.exports=rt;var hi=zy.exports,L1,Yp=hi;L1=Yp.createRoot,Yp.hydrateRoot;const gr=k.createContext(null),MM=k.createContext(null),$1=k.createContext(null),Ps=new WeakMap;function EM(n){const e=Object.create(null);e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",i=>{if(typeof i=="function"&&(i=i(n.state)),i)for(const o in i)o=="class"?e.class+=" "+i[o]:o=="style"?e.style=(e.style?e.style+";":"")+i[o]:!e[o]&&o!="contenteditable"&&o!="nodeName"&&(e[o]=String(i[o]))}),e.translate||(e.translate="no");const t=[Se.node(0,n.state.doc.content.size,e)],r=Ps.get(n);return!r||r[0].to!==n.state.doc.content.size||!r[0].type.eq(t[0].type)?(Ps.set(n,t),t):r}const OM=[],TM={},Kc=_.empty;class fn{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,TM));return fn.from(r)}forChild(e,t){if(t.isLeaf)return _.empty;let r=[];for(let i=0;i<this.members.length;i++){const o=this.members[i].forChild(e,t);o!=Kc&&(o instanceof fn?r=r.concat(o.members):r.push(o))}return fn.from(r)}eq(e){if(!(e instanceof fn)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){const o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?DM(r?t:t.sort(V1)):OM}static from(e){switch(e.length){case 0:return Kc;case 1:return e[0];default:return new fn(e.every(t=>t instanceof _)?e:e.reduce((t,r)=>t.concat(r instanceof _?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function V1(n,e){return n.from-e.from||n.to-e.to}function DM(n){let e=n;for(let t=0;t<e.length-1;t++){const r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){const o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),Gp(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),Gp(e,i,r.copy(o.from,r.to)));break}}}return e}function Gp(n,e,t){for(;e<n.length&&V1(t,n[e])>0;)e++;n.splice(e,0,t)}const Su=new WeakMap;function RM(n,e){const t=[];n.someProp("decorations",s=>{const l=s(n.state);l&&l!=Kc&&t.push(l)}),e&&t.push(_.create(n.state.doc,[e]));const r=Su.get(n);if(!r){const s=fn.from(t);return Su.set(n,s),s}let i=0,o=!0;if(r.forEachSet(s=>{t[i++]!==s&&(o=!1)}),i!==t.length&&(o=!1),!o){const s=fn.from(t);return Su.set(n,s),s}return r}const Sd=function(n){for(let e=0;;e++)if(n=n.previousSibling,!n)return e},Xp=function(n){const e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e},AM=function(n,e,t,r){return t&&(Zp(n,e,t,r,-1)||Zp(n,e,t,r,1))},bM=/^(img|br|input|textarea|hr)$/i;function Zp(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Yl(n))){const o=n.parentNode;if(!o||o.nodeType!=1||zM(n)||bM.test(n.nodeName)||n.contentEditable=="false")return!1;e=Sd(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Yl(n):0}else return!1}}function Yl(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function IM(n,e,t){for(let r=e==0,i=e==Yl(n);r||i;){if(n==t)return!0;const o=Sd(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==Yl(n)}return!1}function zM(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const B1=function(n){return n.focusNode&&AM(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)},J1=k.createContext(null);function PM(n,e){const t=k.useContext(J1);k.useLayoutEffect(()=>t(n),e)}function _1(n,e){const{view:t}=k.useContext(gr);PM(()=>{if(t)return n(t)},e&&[t,...e])}const FM=k.forwardRef(function({widget:e,getPos:t,...r},i){const[o,s]=k.useState(!0),l=k.useRef(null);return k.useImperativeHandle(i,()=>l.current,[]),_1(a=>{if(!a||!l.current)return;a.domObserver.disconnectSelection();const u=a.domSelection(),c=document.createRange(),f=l.current;f.nodeName=="IMG"&&f.parentNode?c.setEnd(f.parentNode,Sd(f)+1):c.setEnd(f,0),c.collapse(!1),u.removeAllRanges(),u.addRange(c),s(!1),a.domObserver.connectSelection()},[]),o?D.jsx("img",{ref:l,className:"ProseMirror-separator","mark-placeholder":"true",alt:"",...r}):null});function LM(n,e){if(n==e)return!0;for(const t in n)if(n[t]!==e[t])return!1;for(const t in e)if(!(t in n))return!1;return!0}const $M={side:0};class Wo{constructor(e,t){this.Component=e,this.spec=t??$M,this.side=this.spec.side??0}map(e,t,r,i){const{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new Se(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Wo&&(this.spec.key&&this.spec.key==e.spec.key||this.Component==e.Component&&LM(this.spec,e.spec))}destroy(){}}function W1(n,e,t){return new Se(n,n,new Wo(e,t))}function wu(){return Math.floor(Math.random()*0xffffffffffff).toString(16)}const Uo=new Go("@nytimes/react-prosemirror/reactKeys");function VM(){let n=!1;return new Vt({key:Uo,state:{init(e,t){const r={posToKey:new Map,keyToPos:new Map};return t.doc.descendants((i,o)=>{const s=wu();return r.posToKey.set(o,s),r.keyToPos.set(s,o),!0}),r},apply(e,t,r,i){if(!e.docChanged||n)return t;const o=e.getMeta(Uo),s=(o==null?void 0:o.type)==="bustKey"&&o.payload.key,l={posToKey:new Map,keyToPos:new Map},a=Array.from(t.posToKey.entries()).sort(([u],[c])=>u-c);for(const[u,c]of a){const{pos:f,deleted:d}=e.mapping.mapResult(u);if(d)continue;let p=c;s===c&&(p=wu()),l.posToKey.set(f,p),l.keyToPos.set(p,f)}return i.doc.descendants((u,c)=>{if(l.posToKey.has(c))return!0;const f=wu();return l.posToKey.set(c,f),l.keyToPos.set(f,c),!0}),l}},props:{handleDOMEvents:{compositionstart:()=>{n=!0},compositionend:()=>{n=!1}}}})}function ku(n,e,t={}){var s;if(e===null)return!1;const r=t.from??n.state.selection.from,i=t.to??n.state.selection.to;if(n.someProp("handleTextInput",l=>l(n,r,i,e)))return!0;const{tr:o}=n.state;if(t.marks&&o.ensureMarks(t.marks),o.insertText(e,r,i),t.bust){const l=n.state.doc.resolve(r),a=l.sharedDepth(i),u=l.start(a),c=(s=Uo.getState(n.state))==null?void 0:s.posToKey.get(u-1);o.setMeta(Uo,{type:"bustKey",payload:{key:c}})}return n.dispatch(o),!0}function BM(n){let e=null,t=null;return new Vt({props:{handleDOMEvents:{compositionstart(r){var s;const{state:i}=r;r.dispatch(i.tr.deleteSelection());const o=i.selection.$from;return i.selection.empty&&(i.storedMarks||!o.textOffset&&o.parentOffset&&((s=o.nodeBefore)!=null&&s.marks.some(l=>l.type.spec.inclusive===!1)))&&n(W1(i.selection.from,FM,{key:"cursor-wrapper",marks:i.storedMarks??o.marks()})),t=i.storedMarks??o.marks(),r.input.composing=!0,!0},compositionupdate(){return!0},compositionend(r){if(r.input.composing=!1,e!==null)return ku(r,e,{bust:!0,marks:t}),e=null,t=null,n(null),!0},beforeinput(r,i){var o,s;switch(i.preventDefault(),i.inputType){case"insertCompositionText":{if(i.data===null)break;e=i.data;break}case"insertReplacementText":{const l=i.getTargetRanges();(s=(o=i.dataTransfer)==null?void 0:o.items[0])==null||s.getAsString(a=>{for(const u of l){const c=r.posAtDOM(u.startContainer,u.startOffset,1),f=r.posAtDOM(u.endContainer,u.endOffset,1);ku(r,a,{from:c,to:f})}});break}case"insertText":{ku(r,i.data);break}case"deleteWordBackward":case"deleteContentBackward":case"deleteWordForward":case"deleteContentForward":case"deleteContent":{const l=i.getTargetRanges(),{tr:a}=r.state;for(const u of l){const c=r.posAtDOM(u.startContainer,u.startOffset),f=r.posAtDOM(u.endContainer,u.endOffset),{doc:d}=r.state,p=d.resolve(c).marksAcross(d.resolve(f));a.delete(c,f).setStoredMarks(p)}r.dispatch(a);break}}return!0}}}})}const $t=typeof navigator<"u"?navigator:null,em=typeof document<"u"?document:null,Fn=$t&&$t.userAgent||"",qc=/Edge\/(\d+)/.exec(Fn),U1=/MSIE \d/.exec(Fn),Qc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Fn),Sa=!!(U1||Qc||qc),JM=U1?document.documentMode:Qc?+Qc[1]:qc?+qc[1]:0,H1=!Sa&&/gecko\/(\d+)/i.test(Fn),_M=H1&&+(/Firefox\/(\d+)/.exec(Fn)||[0,0])[1],Yc=!Sa&&/Chrome\/(\d+)/.exec(Fn),WM=!!Yc,UM=Yc?+Yc[1]:0,j1=!Sa&&!!$t&&/Apple Computer/.test($t.vendor),K1=j1&&(/Mobile\/\w+/.test(Fn)||!!$t&&$t.maxTouchPoints>2),HM=K1||($t?/Mac/.test($t.platform):!1),jM=$t?/Win/.test($t.platform):!1,KM=/Android \d/.test(Fn),q1=!!em&&"webkitFontSmoothing"in em.documentElement.style,qM=q1?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,Ee={ie:Sa,ie_version:JM,gecko:H1,gecko_version:_M,chrome:WM,chrome_version:UM,safari:j1,ios:K1,mac:HM,windows:jM,android:KM,webkit:q1,webkit_version:qM};function vu(n){return n.editable&&!n.hasFocus()?!1:QM(n)}function QM(n){var t,r;const e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(((t=e.focusNode)==null?void 0:t.nodeType)==3?(r=e.focusNode)==null?void 0:r.parentNode:e.focusNode))}catch{return!1}}function YM(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||$.between(e,t,r)}function tm(n,e=null){const t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode);const o=i&&i.size==0;let s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let l=r.resolve(s),a,u;if(B1(t)){for(a=s;i&&!i.node;)i=i.parent;const f=i.node;if(i&&f.isAtom&&I.isSelectable(f)&&i.parent&&!(f.isInline&&IM(t.focusNode,t.focusOffset,i.dom))){const d=i.posBefore;u=new I(s==d?l:r.resolve(d))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let f=s,d=s;for(let p=0;p<t.rangeCount;p++){const h=t.getRangeAt(p);f=Math.min(f,n.docView.posFromDOM(h.startContainer,h.startOffset,1)),d=Math.max(d,n.docView.posFromDOM(h.endContainer,h.endOffset,-1))}if(f<0)return null;[a,s]=d==n.state.selection.anchor?[d,f]:[f,d],l=r.resolve(s)}else a=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(a<0)return null}const c=r.resolve(a);if(!u){const f=e=="pointer"||n.state.selection.head<l.pos&&!o?1:-1;u=YM(n,c,l,f)}return u}const Gl=function(n,e,t,r){return t&&(nm(n,e,t,r,-1)||nm(n,e,t,r,1))};function GM(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const XM=/^(img|br|input|textarea|hr)$/i;function nm(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:rm(n))){const o=n.parentNode;if(!o||o.nodeType!=1||GM(n)||XM.test(n.nodeName)||n.contentEditable=="false")return!1;e=ln(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?rm(n):0}else return!1}}const ln=function(n){let e=n;for(let t=0;;t++)if(e=e.previousSibling,!e)return t};function rm(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ZM(n,e){const t=n;if(e instanceof I){const r=t.docView.descAt(e.from);r!=t.lastSelectedViewDesc&&(im(t),r&&r.selectNode(),t.lastSelectedViewDesc=r)}else im(t)}function im(n){const e=n;e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function eE(n){const e=n,t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function Q1(n){return n.editable?n.hasFocus():eE(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function tE(n){const e=n,t=e.domSelection(),r=document.createRange();if(!t)return;const i=e.cursorWrapper.dom,o=i.nodeName=="IMG";o?r.setStart(i.parentNode,ln(i)+1):r.setStart(i,0),r.collapse(!0),t.removeAllRanges(),t.addRange(r),!o&&!e.state.selection.visible&&Ee.ie&&Ee.ie_version<=11&&(i.disabled=!0,i.disabled=!1)}function om(n,e){const t=n,{node:r,offset:i}=t.docView.domFromPos(e,0),o=i<r.childNodes.length?r.childNodes[i]:null,s=i?r.childNodes[i-1]:null;if(Ee.safari&&o&&o.contentEditable=="false")return xu(o);if((!o||o.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(o)return xu(o);if(s)return xu(s)}}function xu(n){return n.contentEditable="true",Ee.safari&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function sm(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function nE(n){const e=n,t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);const r=e.domSelectionRange(),i=r.anchorNode,o=r.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{(r.anchorNode!=i||r.anchorOffset!=o)&&(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{(!Q1(e)||e.state.selection.visible)&&e.dom.classList.remove("ProseMirror-hideselection")},20))})}const lm=Ee.safari||Ee.chrome&&Ee.chrome_version<63;function Fs(n,e=!1){const t=n,r=t.state.selection;if(ZM(t,r),!!Q1(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&Ee.chrome){const i=t.domSelectionRange(),o=t.domObserver.currentSelection;if(i.anchorNode&&o.anchorNode&&Gl(i.anchorNode,i.anchorOffset,o.anchorNode,o.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)tE(t);else{const{anchor:i,head:o}=r;let s,l;lm&&!(r instanceof $)&&(r.$from.parent.inlineContent||(s=om(t,r.from)),!r.empty&&!r.$from.parent.inlineContent&&(l=om(t,r.to))),t.docView.setSelection(i,o,t.root,e),lm&&(s&&sm(s),l&&sm(l)),r.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&nE(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}class rE{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class iE{constructor(e){this.view=e,this.flushingSoon=-1,this.currentSelection=new rE,this.suppressingSelectionUpdates=!1,this.view=e,this.onSelectionChange=this.onSelectionChange.bind(this)}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}stop(){this.disconnectSelection()}start(){this.connectSelection()}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;const t=new Set;let r;for(let o=e.focusNode;o;o=Xp(o))t.add(o);for(let o=e.anchorNode;o;o=Xp(o))if(t.has(o)){r=o;break}const i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:(r==null?void 0:r.nodeType)==3?r==null?void 0:r.parentNode:r}))return this.setCurSelection(),!0}registerMutation(){}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}updateSelection(){const{view:e}=this,t=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);e.input.compositionPendingChanges=0;const r=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,i=tm(e,r);if(i&&!e.state.selection.eq(i)){const o=e.state.tr.setSelection(i);r=="pointer"?o.setMeta("pointer",!0):r=="key"&&o.scrollIntoView(),t&&o.setMeta("composition",t),e.dispatch(o)}}selectionToDOM(){const{view:e}=this;Fs(e);const t=e.domSelectionRange();this.currentSelection.set(t)}flush(){const{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;const t=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&vu(e)&&!this.ignoreSelectionChange(t);let i=null;r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&B1(t)&&(i=tm(e))&&i.eq(P.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Fs(e),this.currentSelection.set(t),e.scrollToSelection()):r&&(this.updateSelection(),this.currentSelection.eq(t)||Fs(e),this.currentSelection.set(t))}selectionChanged(e){return!this.suppressingSelectionUpdates&&!this.currentSelection.eq(e)&&vu(this.view)&&!this.ignoreSelectionChange(e)}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}onSelectionChange(){if(vu(this.view)&&!this.view.composing){if(this.suppressingSelectionUpdates)return Fs(this.view);if(Ee.ie&&Ee.ie_version<=11&&!this.view.state.selection.empty){const e=this.view.domSelectionRange();if(e.focusNode&&Gl(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}}class oE{add(){}remove(){}}class Qr{constructor(){this.nodeName="div",this.style={}}get parent(){return new Qr}get parentNode(){return new Qr}appendChild(){return new Qr}setAttribute(){}hasAttribute(){return!1}insertBefore(){}get classList(){return new oE}get ownerDocument(){return new Y1}addEventListener(){}removeEventListener(){}replaceChildren(){}}class Y1{createElement(){return new Qr}addEventListener(){}removeEventListener(){}get documentElement(){return new Qr}}function G1(){const n=globalThis.window;globalThis.window??(globalThis.window={visualViewport:null});const e=globalThis.document;return globalThis.document??(globalThis.document=new Y1),function(){globalThis.window!==n&&(globalThis.window=n),globalThis.document!==e&&(globalThis.document=e)}}function yr(n,e){return n instanceof jo?1:e instanceof jo?-1:n.getPos()-e.getPos()}const pi=0,am=1,Ls=2,Ho=3;class ls{constructor(e,t,r,i,o){this.parent=e,this.children=t,this.getPos=r,this.dom=i,this.contentDOM=o,this.dirty=pi,i.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){const i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>ln(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){const o=this.getDesc(i);let s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){const t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){const o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t];const o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){const s=this.children[r],l=o+s.size;if(l>e||s instanceof jo){i=e-o;break}o=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof wd&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?ln(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?ln(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,l=0;;l++){const a=this.children[l],u=s+a.size;if(i==-1&&e<=u){const c=s+a.border;if(e>=c&&t<=u-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,c);e=s;for(let f=l;f>0;f--){const d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){i=ln(d.dom)+1;break}e-=d.size}i==-1&&(i=0)}if(i>-1&&(u>t||l==this.children.length-1)){t=u;for(let c=l+1;c<this.children.length;c++){const f=this.children[c];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){o=ln(f.dom);break}t+=f.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=u}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;const t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){const{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){var d;const o=Math.min(e,t),s=Math.max(e,t);for(let p=0,h=0;p<this.children.length;p++){const m=this.children[p],w=h+m.size;if(o>h&&s<w)return m.setSelection(e-h-m.border,t-h-m.border,r,i);h=w}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1);const u=r.getSelection();let c=!1;if((Ee.gecko||Ee.safari)&&e==t){const{node:p,offset:h}=l;if(p.nodeType==3){if(c=!!(h&&((d=p.nodeValue)==null?void 0:d[h-1])==`
`),c&&h==p.nodeValue.length)for(let m=p,w;m;m=m.parentNode){if(w=m.nextSibling){w.nodeName=="BR"&&(l=a={node:w.parentNode,offset:ln(w)+1});break}const g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{const m=p.childNodes[h-1];c=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Ee.gecko&&u.focusNode&&u.focusNode!=a.node&&u.focusNode.nodeType==1){const p=u.focusNode.childNodes[u.focusOffset];p&&p.contentEditable=="false"&&(i=!0)}if(!(i||c&&Ee.safari)&&Gl(l.node,l.offset,u.anchorNode,u.anchorOffset)&&Gl(a.node,a.offset,u.focusNode,u.focusOffset))return;let f=!1;if((u.extend||e==t)&&!c){u.collapse(l.node,l.offset);try{e!=t&&u.extend(a.node,a.offset),f=!0}catch{}}if(!f){if(e>t){const h=l;l=a,a=h}const p=document.createRange();p.setEnd(a.node,a.offset),p.setStart(l.node,l.offset),u.removeAllRanges(),u.addRange(p)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){const o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){const l=r+o.border,a=s-o.border;if(e>=l&&t<=a){this.dirty=e==r||t==s?Ls:am,e==l&&t==a&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=Ho:o.markDirty(e-l,t-l);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Ls:Ho}r=s}this.dirty=Ls}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){const r=e==1?Ls:am;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class wd extends ls{constructor(e,t,r,i){super(e,[],t,i,null),this.widget=r,this.widget=r}matchesWidget(e){return this.dirty==pi&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){const t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}get domAtom(){return!0}get side(){return this.widget.type.side}}class Xl extends ls{constructor(e,t,r,i,o){super(e,[],t,r,null),this.textDOM=i,this.text=o}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class sE extends ls{constructor(e,t,r,i,o,s){super(e,t,r,o,s),this.mark=i}parseRule(){return this.dirty&Ho||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Ho&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=pi){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=pi}}}class kd extends ls{constructor(e,t,r,i,o,s,l,a,u,c,f,d){super(e,t,r,l,a),this.node=i,this.outerDeco=o,this.innerDeco=s,this.nodeDOM=u,this.stopEvent=c,this.selectNode=f,this.deselectNode=d}updateOuterDeco(){}parseRule(){if(this.node.type.spec.reparseInView)return null;const e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){const r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>C.empty)}return e}matchesNode(e,t,r){return this.dirty==pi&&e.eq(this.node)&&aE(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}update(e,t,r,i){return!0}get domAtom(){return this.node.isAtom}}class lE extends kd{constructor(e,t,r,i,o,s,l,a){super(e,t,r,i,o,s,l,null,a,()=>!1,()=>{},()=>{})}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return!0}inParent(){const e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Ho)}get domAtom(){return!1}}class jo extends ls{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==pi&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}function aE(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function uE(n){const e={};for(const[r,i]of n.entries()){let o=function(s,l){for(const a of i){let u=!1;if(hi.unstable_batchedUpdates(()=>{u=!!a.call(this,s,l)}),u||l.defaultPrevented)return!0}return!1};e[r]=o}return new Vt({key:new Go("@nytimes/react-prosemirror/componentEventListeners"),props:{handleDOMEvents:e}})}function cE(){const[n,e]=k.useState(new Map),t=k.useCallback((o,s)=>{const l=n.get(o)??[];l.unshift(s),n.has(o)||(n.set(o,l),e(new Map(n)))},[n]),r=k.useCallback((o,s)=>{const l=n.get(o);l==null||l.splice(l.indexOf(s),1)},[n]),i=k.useMemo(()=>uE(n),[n]);return{registerEventListener:t,unregisterEventListener:r,componentEventListenersPlugin:i}}function X1(){const[,n]=k.useReducer(e=>e+1,0);return n}function fE(n){const e=Object.create(null);function t(r){for(const i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function dE(n,e){let t=0,r=0;for(const i in n){if(n[i]!=e[i])return!0;t++}for(const i in e)r++;return t!=r}function hE(n,e){for(const t of Object.keys(n))if(n[t]!==e[t])return!0;return!1}function um(n){return!n.someProp("editable",e=>e(n.state)===!1)}class cm extends Bv{constructor(e,t){const r=G1();super(e,{state:dn.create({schema:t.state.schema,plugins:t.state.plugins}),plugins:t.plugins}),this.shouldUpdatePluginViews=!1,r(),this.shouldUpdatePluginViews=!0,this._props=t,this.oldProps={state:t.state},this.state=t.state,this.domObserver.stop(),this.domObserver=new iE(this),this.domObserver.start(),this.editable=um(this),this.docView.dom.replaceChildren(),this.docView=t.docView}get needsRedraw(){if(this.oldProps.state.plugins===this._props.state.plugins&&this._props.plugins===this.oldProps.plugins)return!1;const e=fE(this);return dE(this.nodeViews,e)}pureSetProps(e){this._props={...this._props,...e},this.state=this._props.state,this.editable=um(this)}runPendingEffects(){if(hE(this.props,this.oldProps)){const e=this.props;this._props=this.oldProps,this.state=this._props.state,this.update(e)}}update(e){super.update(e),this.oldProps=e}updatePluginViews(e){this.shouldUpdatePluginViews&&super.updatePluginViews(e)}destroy(){this.dom=document.createElement("div"),super.destroy()}}const pE=new Fm({nodes:{doc:{content:"text*"},text:{inline:!0}}}),mE=dn.create({schema:pE});function gE(n,e){const[t,r]=k.useState(null),i=X1(),o=e.defaultState??mE,[s,l]=k.useState(o),a=e.state??s,{componentEventListenersPlugin:u,registerEventListener:c,unregisterEventListener:f}=cE(),d=k.useCallback(N=>{hi.flushSync(()=>{r(N)})},[]),p=k.useMemo(()=>[...e.plugins??[],u,BM(d)],[e.plugins,u,d]),h=k.useCallback(function(O){hi.flushSync(()=>{e.state||l(T=>T.apply(O)),e.dispatchTransaction&&e.dispatchTransaction.call(this,O)})},[e.dispatchTransaction,e.state]),m=G1(),w=document.createElement("div");m();const g=k.useRef(new kd(void 0,[],()=>-1,a.doc,[],_.empty,w,null,w,()=>!1,()=>{},()=>{})),y={...e,state:a,plugins:p,dispatchTransaction:h,docView:g.current},[S,x]=k.useState(()=>new cm(null,y));return k.useLayoutEffect(()=>()=>{S==null||S.destroy()},[S]),k.useLayoutEffect(()=>{if(!n){x(null);return}if(!S||S.dom!==n){const N=new cm({mount:n},y);x(N),N.dom.addEventListener("compositionend",i);return}if(S.needsRedraw){x(null);return}S==null||S.domObserver.selectionToDOM(),S==null||S.runPendingEffects()}),S==null||S.pureSetProps(y),{editor:k.useMemo(()=>({view:S,registerEventListener:c,unregisterEventListener:f,cursorWrapper:t,docViewDescRef:g}),[S,c,f,t]),state:a}}function yE({children:n}){const e=k.useRef(new Set).current,t=k.useRef(new Set).current,r=k.useRef(!1),i=X1(),o=k.useRef(!0),s=k.useCallback(()=>{o.current||(i(),o.current=!0)},[i]),l=k.useCallback(a=>{let u;const c=()=>{u=a()};return e.add(c),s(),()=>{e.delete(c),u&&(r.current?(t.add(u),s()):u())}},[e,t,s]);return k.useLayoutEffect(()=>(o.current=!1,e.forEach(a=>a()),e.clear(),()=>{t.forEach(a=>a()),t.clear()})),k.useLayoutEffect(()=>(r.current=!0,()=>{r.current=!1}),[]),D.jsx(J1.Provider,{value:l,children:n})}const mt=k.createContext({parentRef:{current:void 0},siblingsRef:{current:[]}});function Z1(n,e,t,r,i,o,s,l){const{view:a}=k.useContext(gr),[u,c]=k.useState(!0),f=k.useRef(s),d=k.useRef(()=>!1),p=k.useCallback(x=>{d.current=x},[]),h=k.useRef(()=>{!r.current||!n||(r.current.nodeType==1&&r.current.classList.add("ProseMirror-selectednode"),(l!=null&&l.current||!n.type.spec.draggable)&&(((t==null?void 0:t.current)??r.current).draggable=!0))}),m=k.useRef(()=>{!r.current||!n||r.current.nodeType==1&&(r.current.classList.remove("ProseMirror-selectednode"),(l!=null&&l.current||!n.type.spec.draggable)&&((t==null?void 0:t.current)??r.current).removeAttribute("draggable"))}),w=k.useCallback((x,M)=>{h.current=x,m.current=M},[]),{siblingsRef:g,parentRef:y}=k.useContext(mt),S=k.useRef([]);return k.useLayoutEffect(()=>{const x=g.current;return()=>{if(f.current&&x.includes(f.current)){const M=x.indexOf(f.current);x.splice(M,1)}}},[g]),k.useLayoutEffect(()=>{var M;if(!n||!r.current)return;const x=S.current[0];f.current?(f.current.parent=y.current,f.current.children=S.current,f.current.node=n,f.current.getPos=e,f.current.outerDeco=o,f.current.innerDeco=i,f.current.dom=(t==null?void 0:t.current)??r.current,f.current.dom.pmViewDesc=f.current,f.current.contentDOM=(l==null?void 0:l.current)??f.current.contentDOM??(x==null?void 0:x.dom.parentElement)??null,f.current.nodeDOM=r.current):f.current=new kd(y.current,S.current,e,n,o,i,(t==null?void 0:t.current)??r.current,(x==null?void 0:x.dom.parentElement)??null,r.current,N=>!!d.current(N),()=>h.current(),()=>m.current()),c(f.current.contentDOM!==null),g.current.includes(f.current)||g.current.push(f.current),g.current.sort(yr);for(const N of S.current)if(N.parent=f.current,N instanceof Xl){const O=(M=f.current.contentDOM)==null?void 0:M.firstChild;if(!O)throw new Error("Started a composition but couldn't find the text node it belongs to.");let T=O;for(;T.firstChild;)T=T.firstChild;if(!T||!(T instanceof Text))throw new Error("Started a composition but couldn't find the text node it belongs to.");N.dom=O,N.textDOM=T,N.text=T.data,N.textDOM.pmViewDesc=N,a==null||a.input.compositionNodes.push(N)}return()=>{var N,O,T,b;((N=f.current)==null?void 0:N.children[0])instanceof Xl&&!(a!=null&&a.composing)&&((b=(O=f.current)==null?void 0:O.children[0].dom.parentNode)==null||b.removeChild((T=f.current)==null?void 0:T.children[0].dom))}}),{hasContentDOM:u,childDescriptors:S,nodeViewDescRef:f,setStopEvent:p,setSelectNode:w}}function SE(n,e){return n.type.side-e.type.side}function wE(n,e,t,r){const i=e.locals(n);let o=0;if(i.length==0){for(let u=0;u<n.childCount;u++){const c=n.child(u);r(c,i,e.forChild(o,c),o,u),o+=c.nodeSize}return}let s=0;const l=[];let a=null;for(let u=0;;){if(s<i.length&&i[s].to==o){const h=i[s++];let m;for(;s<i.length&&i[s].to==o;)(m||(m=[h])).push(i[s++]);if(m){m.sort(SE);for(let w=0;w<m.length;w++)t(m[w],!(m[w].type instanceof Wo),o,u+w,!!a)}else t(h,!(h.type instanceof Wo),o,u,!!a)}let c,f;if(a)f=-1,c=a,a=null;else if(u<n.childCount)f=u,c=n.child(u++);else break;for(let h=0;h<l.length;h++)l[h].to<=o&&l.splice(h--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)l.push(i[s++]);let d=o+c.nodeSize;if(c.isText){let h=d;s<i.length&&i[s].from<h&&(h=i[s].from);for(let m=0;m<l.length;m++)l[m].to<h&&(h=l[m].to);h<d&&(a=c.cut(h-o),c=c.cut(0,h-o),d=h,f=-1)}const p=c.isInline&&!c.isLeaf?l.filter(h=>!h.inline):l.slice();r(c,p,e.forChild(o,c),o,f),o=d}}function kE(){const{view:n}=k.useContext(gr);return n&&Uo.getState(n.state)}var eS={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var r=[],i=0;i<arguments.length;i++){var o=arguments[i];if(o){var s=typeof o;if(s==="string"||s==="number")r.push(o);else if(Array.isArray(o)){if(o.length){var l=t.apply(null,o);l&&r.push(l)}}else if(s==="object"){if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]")){r.push(o.toString());continue}for(var a in o)e.call(o,a)&&o[a]&&r.push(a)}}}return r.join(" ")}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(eS);var vE=eS.exports;const xE=sS(vE);function CE(n){return n.replaceAll(/-[a-z]/g,e=>{var t;return((t=e[1])==null?void 0:t.toUpperCase())??""})}function NE(n){const e=new CSSStyleSheet;e.insertRule(`* { ${n} }`);const r=e.cssRules[0].style,i={};for(let o=0;o<r.length;o++){const s=r.item(o),l=r.getPropertyValue(s),a=s.startsWith("--")?s:CE(s);i[a]=l}return i}function tS(n,e){return{...n,...e,className:xE(n.className,e.className),style:{...n.style,...e.style}}}function nS(n){const e={};for(const[t,r]of Object.entries(n))switch(t.toLowerCase()){case"class":{e.className=r;break}case"style":{e.style=NE(r);break}case"autocapitalize":{e.autoCapitalize=r;break}case"contenteditable":{if(r===""||r==="true"){e.contentEditable=!0;break}if(r==="false"){e.contentEditable=!1;break}if(r==="plaintext-only"){e.contentEditable="plaintext-only";break}e.contentEditable=null;break}case"draggable":{e.draggable=r!=null;break}case"enterkeyhint":{e.enterKeyHint=r;break}case"for":{e.htmlFor=r;break}case"hidden":{e.hidden=r;break}case"inputmode":{e.inputMode=r;break}case"itemprop":{e.itemProp=r;break}case"spellcheck":{if(r===""||r==="true"){e.spellCheck=!0;break}if(r==="false"){e.spellCheck=!1;break}e.spellCheck=null;break}case"tabindex":{const i=parseInt(r,10);Number.isNaN(i)||(e.tabIndex=i);break}case"autocomplete":{e.autoComplete=r;break}case"autofocus":{e.autoFocus=r!=null;break}case"formaction":{e.formAction=r;break}case"formenctype":{e.formEnctype=r;break}case"formmethod":{e.formMethod=r;break}case"formnovalidate":{e.formNoValidate=r;break}case"formtarget":{e.formTarget=r;break}case"maxlength":{const i=parseInt(r,10);Number.isNaN(i)||(e.maxLength=r);break}case"minlength":{const i=parseInt(r,10);Number.isNaN(i)||(e.minLength=r);break}case"max":{const i=parseInt(r,10);Number.isNaN(i)||(e.max=r);break}case"min":{const i=parseInt(r,10);Number.isNaN(i)||(e.min=r);break}case"multiple":{e.multiple=r!=null;break}case"readonly":{e.readOnly=r!=null;break}case"required":{e.required=r!=null;break}case"size":{const i=parseInt(r,10);Number.isNaN(i)||(e.size=r);break}case"step":{if(r==="any"){e.step=r;break}const i=parseInt(r,10);!Number.isNaN(i)&&i>0&&(e.step=r);break}case"disabled":{e.disabled=r!=null;break}case"rows":{const i=parseInt(r,10);Number.isNaN(i)||(e.rows=r);break}default:{e[t]=r;break}}return e}const vd=k.memo(k.forwardRef(function({outputSpec:e,children:t,...r},i){if(typeof e=="string")return D.jsx(D.Fragment,{children:e});if(!Array.isArray(e))throw new Error("@nytimes/react-prosemirror only supports strings and arrays in toDOM");const s=e[0].replace(" ",":"),l=e[1];let a={ref:i,...r},u=1;l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)&&(u=2,a=tS(nS(l),a));const c=[];for(let f=u;f<e.length;f++){const d=e[f];if(d===0){if(f<e.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return k.createElement(s,a,t)}c.push(D.jsx(vd,{outputSpec:d,children:t}))}return k.createElement(s,a,...c)})),rS=k.memo(k.forwardRef(function({mark:e,getPos:t,children:r},i){const{siblingsRef:o,parentRef:s}=k.useContext(mt),l=k.useRef(void 0),a=k.useRef([]),u=k.useRef(null);k.useImperativeHandle(i,()=>u.current,[]);const c=k.useMemo(()=>{var d,p;return(p=(d=e.type.spec).toDOM)==null?void 0:p.call(d,e,!0)},[e]);if(!c)throw new Error(`Mark spec for ${e.type.name} is missing toDOM`);k.useLayoutEffect(()=>{const d=o.current;return()=>{if(l.current&&d.includes(l.current)){const p=d.indexOf(l.current);d.splice(p,1)}}},[o]),k.useLayoutEffect(()=>{if(!u.current)return;const d=a.current[0];l.current?(l.current.parent=s.current,l.current.dom=u.current,l.current.contentDOM=(d==null?void 0:d.dom.parentElement)??u.current,l.current.mark=e,l.current.getPos=()=>t.current()):l.current=new sE(s.current,a.current,()=>t.current(),e,u.current,(d==null?void 0:d.dom.parentElement)??u.current),o.current.includes(l.current)||o.current.push(l.current),o.current.sort(yr);for(const p of a.current)p.parent=l.current});const f=k.useMemo(()=>({parentRef:l,siblingsRef:a}),[a,l]);return D.jsx(vd,{ref:u,outputSpec:c,children:D.jsx(mt.Provider,{value:f,children:r})})}));function ME({widget:n,getPos:e}){const{siblingsRef:t,parentRef:r}=k.useContext(mt),i=k.useRef(null),o=k.useRef(null);return k.useLayoutEffect(()=>{const s=t.current;return()=>{if(i.current&&s.includes(i.current)){const l=s.indexOf(i.current);s.splice(l,1)}}},[t]),_1(s=>{if(!o.current)return;const l=n.type.toDOM;let a=typeof l=="function"?l(s,()=>e.current()):l;if(!n.type.spec.raw){if(a.nodeType!=1){const u=document.createElement("span");u.appendChild(a),a=u}a.contentEditable="false",a.classList.add("ProseMirror-widget")}o.current.firstElementChild!==a&&o.current.replaceChildren(a)}),k.useLayoutEffect(()=>{o.current&&(i.current?(i.current.parent=r.current,i.current.widget=n,i.current.getPos=()=>e.current(),i.current.dom=o.current):i.current=new wd(r.current,()=>e.current(),n,o.current),t.current.includes(i.current)||t.current.push(i.current),t.current.sort(yr))}),D.jsx("span",{ref:o})}const EE=k.createContext(null),OE=k.createContext(null);function TE(){const[n,e]=k.useState(!1);return k.useEffect(()=>{e(!0)},[]),n}function DE({contentDomRef:n,customNodeViewRef:e,customNodeViewRootRef:t,customNodeView:r,initialNode:i,node:o,getPos:s,initialOuterDeco:l,initialInnerDeco:a,innerDeco:u}){const{view:c}=k.useContext(gr);if(!TE())return null;e.current||(e.current=r(i.current,c,()=>s.current(),l.current,a.current));const{contentDOM:d}=e.current;return n.current=d??null,k.createElement(o.isInline?"span":"div",{ref:t,contentEditable:!!d,suppressContentEditableWarning:!0},d&&hi.createPortal(D.jsx(Ko,{getPos:s,node:o,innerDecorations:u}),d))}const iS=k.memo(function({outerDeco:e,getPos:t,node:r,innerDeco:i,...o}){const s=k.useRef(null),l=k.useRef(null),a=k.useRef(null),u=k.useRef(()=>t.current()).current,c=k.useRef(r),f=k.useRef(e),d=k.useRef(i),p=k.useRef(null),h=k.useRef(null),{nodeViews:m}=k.useContext($1),{view:w}=k.useContext(gr);let g=null;const y=m[r.type.name],S=k.useMemo(()=>{var ne,he;return(he=(ne=r.type.spec).toDOM)==null?void 0:he.call(ne,r)},[r]),x=w==null?void 0:w.someProp("nodeViews",ne=>ne==null?void 0:ne[r.type.name]);k.useLayoutEffect(()=>{if(!h.current||!p.current)return;const{dom:ne}=h.current;return l.current=p.current,p.current.appendChild(ne),()=>{var he,$n;($n=(he=h.current)==null?void 0:he.destroy)==null||$n.call(he)}},[]),k.useLayoutEffect(()=>{if(!x||!h.current)return;const{destroy:ne,update:he}=h.current;if(((he==null?void 0:he.call(h.current,r,e,i))??!0)||(ne==null||ne.call(h.current),!p.current))return;c.current=r,f.current=e,d.current=i,h.current=x(c.current,w,()=>t.current(),f.current,d.current);const{dom:R}=h.current;l.current=p.current,p.current.appendChild(R)},[x,w,i,r,e,t]);const{hasContentDOM:M,childDescriptors:N,setStopEvent:O,setSelectNode:T,nodeViewDescRef:b}=Z1(r,()=>t.current(),s,l,i,e,void 0,a),z={...o,...!M&&{contentEditable:!1}},ae=k.useMemo(()=>({node:r,getPos:u,decorations:e,innerDecorations:i}),[u,i,r,e]);if(y?g=D.jsx(y,{...z,ref:l,nodeProps:ae,children:D.jsx(Ko,{getPos:t,node:r,innerDecorations:i})}):x?g=D.jsx(DE,{contentDomRef:a,customNodeView:x,customNodeViewRef:h,customNodeViewRootRef:p,initialInnerDeco:d,initialNode:c,initialOuterDeco:f,node:r,getPos:t,innerDeco:i}):S&&(g=D.jsx(vd,{...z,ref:l,outputSpec:S,children:D.jsx(Ko,{getPos:t,node:r,innerDecorations:i})})),!g)throw new Error(`Node spec for ${r.type.name} is missing toDOM`);const Mt=k.cloneElement(e.reduce(xd,g),e.some(ne=>ne.type.attrs.nodeName)?{ref:s}:void 0),Ln=r.isInline?Mt:r.marks.reduce((ne,he)=>D.jsx(rS,{getPos:t,mark:he,children:ne}),Mt),as=k.useMemo(()=>({parentRef:b,siblingsRef:N}),[N,b]);return D.jsx(EE.Provider,{value:T,children:D.jsx(OE.Provider,{value:O,children:D.jsx(mt.Provider,{value:as,children:k.cloneElement(Ln,r.marks.length&&!r.isInline||e.some(ne=>ne.type.attrs.nodeName)?{ref:s}:void 0)})})})});function RE({getPos:n}){const{siblingsRef:e,parentRef:t}=k.useContext(mt),r=k.useRef(null),i=k.useRef(null),[o,s]=k.useState(!1);return k.useLayoutEffect(()=>{const l=e.current;return()=>{if(r.current&&l.includes(r.current)){const a=l.indexOf(r.current);l.splice(a,1)}}},[e]),k.useLayoutEffect(()=>{var a;const l=e.current[e.current.length-1];if((Ee.safari||Ee.chrome)&&((a=l==null?void 0:l.dom)==null?void 0:a.contentEditable)=="false"){s(!0);return}i.current&&(r.current?(r.current.parent=t.current,r.current.dom=i.current,r.current.getPos=()=>n.current()):r.current=new jo(t.current,[],()=>n.current(),i.current,null),e.current.includes(r.current)||e.current.push(r.current),e.current.sort(yr))}),o?D.jsx("img",{ref:i,className:"ProseMirror-separator"}):null}function AE(n,e){if(n===e)return!0;if(!n||!e)return!1;const t=Object.keys(n),r=Object.keys(e),i=t.length;if(r.length!==i)return!1;for(let o=0;o<i;o++){const s=t[o];if(n[s]!==e[s]||!Object.prototype.hasOwnProperty.call(e,s))return!1}return!0}class bE extends k.Component{constructor(){super(...arguments),this.viewDescRef=null,this.renderRef=null}updateEffect(){const{view:e,decorations:t,siblingsRef:r,parentRef:i,getPos:o,node:s}=this.props,l=hi.findDOMNode(this);if(!l){if(!(e!=null&&e.composing))return;this.viewDescRef=new Xl(i.current,()=>o.current(),document.createElement("div"),document.createTextNode(s.text??""),s.text??"");return}let a=l;for(;a.firstChild;)a=a.firstChild;!this.viewDescRef||this.viewDescRef instanceof Xl?this.viewDescRef=new lE(void 0,[],()=>o.current(),s,t,_.empty,l,a):(this.viewDescRef.parent=i.current,this.viewDescRef.children=[],this.viewDescRef.node=s,this.viewDescRef.getPos=()=>o.current(),this.viewDescRef.outerDeco=t,this.viewDescRef.innerDeco=_.empty,this.viewDescRef.dom=l,this.viewDescRef.dom.pmViewDesc=this.viewDescRef,this.viewDescRef.nodeDOM=a),r.current.includes(this.viewDescRef)||r.current.push(this.viewDescRef),r.current.sort(yr)}shouldComponentUpdate(e){return!AE(this.props,e)}componentDidMount(){this.updateEffect()}componentDidUpdate(){this.updateEffect()}componentWillUnmount(){const{siblingsRef:e}=this.props;if(this.viewDescRef&&e.current.includes(this.viewDescRef)){const t=e.current.indexOf(this.viewDescRef);e.current.splice(t,1)}}render(){const{view:e,getPos:t,node:r,decorations:i}=this.props;return e!=null&&e.composing&&e.state.selection.from>=t.current()&&e.state.selection.from<=t.current()+r.nodeSize?this.renderRef:(this.renderRef=i.reduce(xd,r.text),this.renderRef)}}function IE({getPos:n}){const{siblingsRef:e,parentRef:t}=k.useContext(mt),r=k.useRef(null),i=k.useRef(null);return k.useLayoutEffect(()=>{const o=e.current;return()=>{if(r.current&&o.includes(r.current)){const s=o.indexOf(r.current);o.splice(s,1)}}},[e]),k.useLayoutEffect(()=>{i.current&&(r.current?(r.current.parent=t.current,r.current.dom=i.current,r.current.getPos=()=>n.current()):r.current=new jo(t.current,[],()=>n.current(),i.current,null),e.current.includes(r.current)||e.current.push(r.current),e.current.sort(yr))}),D.jsx("br",{ref:i,className:"ProseMirror-trailingBreak"})}function zE({widget:n,getPos:e}){const{siblingsRef:t,parentRef:r}=k.useContext(mt),i=k.useRef(null),o=k.useRef(()=>e.current()).current,s=k.useRef(null);k.useLayoutEffect(()=>{const a=t.current;return()=>{if(i.current&&a.includes(i.current)){const u=a.indexOf(i.current);a.splice(u,1)}}},[t]),k.useLayoutEffect(()=>{s.current&&(i.current?(i.current.parent=r.current,i.current.widget=n,i.current.getPos=()=>e.current(),i.current.dom=s.current):i.current=new wd(r.current,()=>e.current(),n,s.current),t.current.includes(i.current)||t.current.push(i.current),t.current.sort(yr))});const{Component:l}=n.type;return l&&D.jsx(l,{ref:s,widget:n,getPos:o,contentEditable:!1})}function xd(n,e){const{nodeName:t,...r}=e.type.attrs,i=nS(r);return t||typeof n=="string"?k.createElement(t??"span",i,n):k.cloneElement(n,tS(n.props,i))}function Cu(n,e){var t,r,i;return n.type===e.type&&n.marks.every(o=>o.isInSet(e.marks))&&e.marks.every(o=>o.isInSet(n.marks))&&n.key===e.key&&(n.type==="node"?((t=n.outerDeco)==null?void 0:t.length)===((r=e.outerDeco)==null?void 0:r.length)&&((i=n.outerDeco)==null?void 0:i.every(o=>{var s;return(s=e.outerDeco)==null?void 0:s.some(l=>o.from===l.from&&o.to&&l.to&&o.type.eq(l.type))}))&&n.innerDeco.eq(e.innerDeco):!0)&&n.node===e.node&&n.widget===e.widget}const PE=k.memo(function({child:e,getInnerPos:t}){const{view:r}=k.useContext(gr),i=k.useRef(()=>t.current()+e.offset);return i.current=()=>t.current()+e.offset,e.type==="widget"?D.jsx(zE,{widget:e.widget,getPos:i},e.key):e.type==="native-widget"?D.jsx(ME,{widget:e.widget,getPos:i},e.key):e.node.isText?D.jsx(mt.Consumer,{children:({siblingsRef:o,parentRef:s})=>D.jsx(bE,{view:r,node:e.node,getPos:i,siblingsRef:o,parentRef:s,decorations:e.outerDeco})},e.key):D.jsx(iS,{node:e.node,getPos:i,outerDeco:e.outerDeco,innerDeco:e.innerDeco},e.key)}),FE=k.memo(function({childViews:e,getInnerPos:t}){const r=e[0],i=k.useRef(()=>t.current()+r.offset);i.current=()=>t.current()+r.offset;const o=r.marks[0];return o?D.jsx(rS,{getPos:i,mark:o,children:D.jsx(Cd,{getInnerPos:t,childViews:e.map(s=>({...s,marks:s.marks.slice(1)}))},r.key)},r.key):D.jsx(D.Fragment,{children:e.map(s=>D.jsx(PE,{child:s,getInnerPos:t},s.key))})}),Cd=k.memo(function({getInnerPos:e,childViews:t}){const r=t.reduce((i,o)=>{var a;const s=i[i.length-1];if(!s)return[[o]];const l=s[s.length-1];return l?!o.marks.length&&!l.marks.length||o.marks.length&&l.marks.length&&((a=o.marks[0])!=null&&a.eq(l.marks[0]))?[...i.slice(0,i.length-1),[...s.slice(0,s.length),o]]:[...i,[o]]:[...i.slice(0,i.length),[o]]},[]);return D.jsx(D.Fragment,{children:r.map(i=>{const o=i[0];return o?D.jsx(FE,{childViews:i,getInnerPos:e},o.key):null})})});function Nu(n,e,t,r,i,o){const s=n+e,l=r==null?void 0:r.get(s);if(t==="widget"||t==="native-widget")return i.type.spec.key?i.type.spec.key:(console.warn(`Widget at position ${s} doesn't have a key specified. This may cause issues.`),`${l}-${o}`);if(l)return l;const a=n-1,u=r==null?void 0:r.get(a);return u?`${u}-${e}`:s}function LE(n,e){if(!e||e.widget.type.side>=0||!n||!n.node.isInline)return;const t=n.marks;e.marks=e.marks.reduce((r,i)=>i.addToSet(r),t)}function $E(n,e){if(!e.node.isInline)return;const t=e.marks;for(let r=n.length-1;r>=0;r--){const i=n[r];i.widget.type.side<0||(i.marks=i.marks.reduce((o,s)=>s.addToSet(o),t))}}const VE=k.memo(function({child:e,getInnerPos:t}){const r=k.useRef(()=>t.current()+e.offset);return r.current=()=>t.current()+e.offset,e.type==="node"?D.jsx(iS,{outerDeco:e.outerDeco,node:e.node,innerDeco:e.innerDeco,getPos:r},e.key):D.jsx(Cd,{childViews:[e],getInnerPos:t},e.key)});function BE(n,e){return n.length?n.every(t=>t.type!=="node"||t.node.isInline)?[D.jsx(Cd,{childViews:n,getInnerPos:e},n[0].key)]:n.map(t=>D.jsx(VE,{child:t,getInnerPos:e},t.key)):[]}const Ko=k.memo(function({getPos:e,node:t,innerDecorations:r}){const i=kE(),o=k.useRef(()=>e.current()+1),s=k.useRef(new Map).current;if(!t)return null;const l=new Set;let a=[],u=null;wE(t,r,(p,h,m,w)=>{const g=p.type.spec.marks??[];let y;if(h){y=Nu(o.current(),m,"native-widget",i==null?void 0:i.posToKey,p,w);const x={type:"native-widget",widget:p,marks:g,offset:m,index:w,key:y},M=s.get(y);M&&Cu(M,x)?M.offset=m:s.set(y,x),l.add(y)}else{y=Nu(o.current(),m,"widget",i==null?void 0:i.posToKey,p,w);const x={type:"widget",widget:p,marks:g,offset:m,index:w,key:y},M=s.get(y);M&&Cu(M,x)?M.offset=m:s.set(y,x),l.add(y)}const S=s.get(y);a.push(S),LE(u,s.get(y))},(p,h,m,w)=>{const g=Nu(o.current(),w,"node",i==null?void 0:i.posToKey),y={type:"node",node:p,marks:p.marks,innerDeco:m,outerDeco:h,offset:w,key:g},S=s.get(g);S&&Cu(S,y)?(S.offset=w,u=S):(s.set(g,y),u=y),l.add(g),$E(a,u),a=[]});for(const p of s.keys())l.has(p)||s.delete(p);const c=Array.from(s.values()).sort((p,h)=>p.offset-h.offset),f=BE(c,o),d=c[c.length-1];return(!d||d.type!=="node"||d.node.isInline&&!d.node.isText||/\n$/.test(d.node.text))&&f.push(D.jsx(RE,{getPos:o},"trailing-hack-img"),D.jsx(IE,{getPos:o},"trailing-hack-br")),D.jsx(D.Fragment,{children:f})}),Mu={current(){return-1}},JE=k.memo(k.forwardRef(function({className:e,node:t,innerDeco:r,outerDeco:i,as:o,viewDesc:s,...l},a){const u=k.useRef(null);k.useImperativeHandle(a,()=>u.current,[]);const{childDescriptors:c,nodeViewDescRef:f}=Z1(t,()=>Mu.current(),u,u,r,i,s),d=k.useMemo(()=>({parentRef:f,siblingsRef:c}),[c,f]),p={...l,ref:u,className:e,suppressContentEditableWarning:!0},h=o?k.cloneElement(o,p,D.jsx(mt.Provider,{value:d,children:D.jsx(Ko,{getPos:Mu,node:t,innerDecorations:r})})):k.createElement("div",p,D.jsx(mt.Provider,{value:d,children:D.jsx(Ko,{getPos:Mu,node:t,innerDecorations:r})}));if(!t)return h;const m=i.filter(g=>!g.inline);return m.length?m.reduce(xd,h):h})),oS=k.createContext(null);function _E({as:n,...e},t){const r=k.useRef([]),i=k.useRef(null),{setMount:o,...s}=k.useContext(oS),l=k.useRef(void 0);k.useImperativeHandle(t,()=>i.current,[]);const a=k.useMemo(()=>({parentRef:l,siblingsRef:r}),[r,l]);return D.jsx(mt.Provider,{value:a,children:D.jsx(JE,{ref:u=>{i.current=u,o(u)},...e,...s,as:n})})}const WE=k.forwardRef(_E),UE=[];function HE({className:n,children:e,nodeViews:t,customNodeViews:r,...i}){var p;const[o,s]=k.useState(null),{editor:l,state:a}=gE(o,{...i,nodeViews:r}),u=l.view?RM(l.view,l.cursorWrapper):_.empty,c=l.view?EM(l.view):UE,f=k.useMemo(()=>({nodeViews:t??{}}),[t]),d=k.useMemo(()=>{var h;return{className:n,setMount:s,node:(h=l.view)==null?void 0:h.state.doc,innerDeco:u,outerDeco:c,viewDesc:l.docViewDescRef.current}},[n,l.docViewDescRef,(p=l.view)==null?void 0:p.state.doc,u,c]);return D.jsx(gr.Provider,{value:l,children:D.jsx(MM.Provider,{value:a,children:D.jsx($1.Provider,{value:f,children:D.jsx(oS.Provider,{value:d,children:e})})})})}function jE(n){return D.jsx(yE,{children:D.jsx(HE,{...n})})}const J=new Fm({nodes:{doc:{content:"block+"},paragraph:{group:"block",content:"inline*",toDOM(){return["p",0]}},...Ux({cellContent:"inline*",cellAttributes:{},tableGroup:"block"}),footnote:{group:"inline",content:"text*",inline:!0,atom:!0,attrs:{number:{default:0}}},list:{group:"block",content:"list_item+",toDOM(){return["ul",0]}},list_item:{content:"paragraph+",toDOM(){return["li",0]}},image:{group:"block",toDOM(){return["div",["img",{src:"https://smoores.gitlab.io/storyteller/img/Storyteller_Logo.png",height:150,width:150}]]}},text:{group:"inline"}},marks:{em:{toDOM(){return["em",0]}},strong:{toDOM(){return["strong",0]}}}}),KE=dn.create({schema:J,doc:J.nodes.doc.create({},[J.nodes.paragraph.create({},[J.text("This ",[J.marks.em.create()]),J.text("is",[J.marks.em.create(),J.marks.strong.create()]),J.text(" the first paragraph")]),J.nodes.paragraph.create({},[J.text("This is the second paragraph"),J.nodes.footnote.create({number:1},J.text("Footnote"))]),J.nodes.paragraph.create(),J.nodes.image.create(),J.nodes.image.create(),J.nodes.paragraph.create({},J.text("This is the third paragraph ")),J.nodes.table.create({},[J.nodes.table_row.create({},[J.nodes.table_header.create({},J.text("h1")),J.nodes.table_header.create({},J.text("h2"))]),J.nodes.table_row.create({},[J.nodes.table_cell.create({},J.text("c1")),J.nodes.table_cell.create({},J.text("c2"))])])]),plugins:[VM(),ax({rules:[ux(/^\s*([-+*])\s$/,J.nodes.list)]}),uC(),vC()]}),qE=k.forwardRef(function({children:e,nodeProps:t,...r},i){return D.jsx("p",{ref:i,...r,children:e})}),QE=k.forwardRef(function({children:e,nodeProps:t,...r},i){return D.jsx("ul",{ref:i,...r,children:e})}),YE=k.forwardRef(function({children:e,nodeProps:t,...r},i){return D.jsx("li",{ref:i,...r,children:e})}),GE=k.forwardRef(function({nodeProps:e,...t},r){return D.jsx("span",{ref:r,...t,suppressContentEditableWarning:!0,contentEditable:"false",children:D.jsx("button",{children:e.node.attrs.number})})}),XE=k.forwardRef(function({widget:e,getPos:t,...r},i){return D.jsx("span",{...r,ref:i,style:{display:"block",backgroundColor:"blue",width:"4px",height:"4px",position:"absolute",transform:"translateX(-2px)"},children:"Widget"})}),ZE=new Vt({view(n){const e=n.coordsAtPos(n.state.selection.from),t=document.createElement("div");return t.style.width="4px",t.style.height="4px",t.style.position="absolute",t.style.top=`${e.top-2}px`,t.style.left=`${e.left-2}px`,t.style.backgroundColor="blue",document.body.appendChild(t),{update(r){const i=r.coordsAtPos(r.state.selection.from);t.style.top=`${i.top-2}px`,t.style.left=`${i.left-2}px`},destroy(){document.body.removeChild(t)}}}});new Vt({props:{decorations(n){return _.create(n.doc,[W1(n.selection.from,XE,{side:0,key:"widget-plugin-widget"})])}},view(n){const e=n.coordsAtPos(n.state.selection.from),t=document.createElement("div");return t.style.width="4px",t.style.height="4px",t.style.position="absolute",t.style.top=`${e.top-2}px`,t.style.left=`${e.left-2}px`,t.style.backgroundColor="blue",document.body.appendChild(t),{update(r){const i=r.coordsAtPos(r.state.selection.from);t.style.top=`${i.top-2}px`,t.style.left=`${i.left-2}px`},destroy(){document.body.removeChild(t)}}}});const eO=[hx({...Qw,"Mod-i":Kd(J.marks.em),"Mod-b":Kd(J.marks.strong)}),ZE,Hv()],tO={paragraph:()=>{const n=document.createElement("p");return{dom:n,contentDOM:n}}};function nO(){const[n,e]=k.useState(KE),[t,r]=k.useState(!0),i=k.useMemo(()=>t?{paragraph:qE,list:QE,list_item:YE,footnote:GE}:void 0,[t]),o=k.useCallback(function(s){e(l=>l.apply(s))},[]);return D.jsxs("main",{children:[D.jsx("h1",{children:"React ProseMirror Demo"}),D.jsxs("button",{onClick:()=>{t?r(s=>!s):window.location.reload()},children:["Switch to"," ",t?"ProseMirror node views":"React node views (requires reload)"]}),D.jsx(jE,{className:"ProseMirror",state:n,dispatchTransaction:o,plugins:eO,nodeViews:i,customNodeViews:t?void 0:tO,children:D.jsx(WE,{})},`${t}`)]})}const rO=L1(document.getElementById("root"));rO.render(D.jsx(k.StrictMode,{children:D.jsx(nO,{})}));
